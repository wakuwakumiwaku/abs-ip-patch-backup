(window.webpackJsonp=window.webpackJsonp||[]).push([[138,157],{691:function(t,e,n){"use strict";n.r(e);var r={props:{value:Boolean},data:function(){return{}},computed:{},methods:{},mounted:function(){}},o=n(4),component=Object(o.a)(r,(function(){var t=this._self._c;return t("div",{staticClass:"w-3 h-3"},[this.value?t("div",{staticClass:"w-full h-full text-sm mr-2 text-success animate-pulse"},[t("svg",{attrs:{viewBox:"0 0 24 24"}},[t("path",{attrs:{fill:"currentColor",d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}})])]):t("svg",{staticClass:"w-full h-full mr-2 text-white/20",attrs:{viewBox:"0 0 24 24"}},[t("path",{attrs:{fill:"currentColor",d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}})])])}),[],!1,null,null,null);e.default=component.exports},715:function(t,e,n){var content=n(764);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(19).default)("5654b2a7",content,!0,{sourceMap:!1})},763:function(t,e,n){"use strict";n(715)},764:function(t,e,n){var r=n(18)((function(i){return i[1]}));r.push([t.i,"\n#accounts {\n  table-layout: fixed;\n  border-collapse: collapse;\n  border: 1px solid #474747;\n  width: 100%;\n}\n#accounts td,\n#accounts th {\n  /* border: 1px solid #2e2e2e; */\n  padding: 8px 8px;\n  text-align: left;\n}\n#accounts td.py-0 {\n  padding: 0px 8px;\n}\n#accounts tr:nth-child(even) {\n  background-color: #373838;\n}\n#accounts tr:nth-child(odd) {\n  background-color: #2f2f2f;\n}\n#accounts tr:hover {\n  background-color: #444;\n}\n#accounts th {\n  font-size: 0.8rem;\n  font-weight: 600;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  background-color: #272727;\n}\n",""]),r.locals={},t.exports=r},850:function(t,e,n){"use strict";n.r(e);n(17),n(26),n(85),n(150),n(108),n(8),n(28),n(40);var r={data:function(){return{users:[],isDeletingUser:!1}},computed:{currentUserId:function(){return this.$store.state.user.user.id},userIsRoot:function(){return this.$store.getters["user/getIsRoot"]},usersOnline:function(){var t={};return this.$store.state.users.usersOnline.forEach((function(u){return t[u.id]=u})),t},dateFormat:function(){return this.$store.getters.getServerSetting("dateFormat")},timeFormat:function(){return this.$store.getters.getServerSetting("timeFormat")}},methods:{getDeviceInfoString:function(t){return t?t.manufacturer&&t.model?"".concat(t.manufacturer," ").concat(t.model):"".concat(t.osName||"Unknown"," ").concat(t.osVersion||""," ").concat(t.browserName||""):""},deleteUserClick:function(t){var e=this;if(!this.isDeletingUser){var n={message:this.$getString("MessageRemoveUserWarning",[t.username]),callback:function(n){n&&e.deleteUser(t)},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",n)}},deleteUser:function(t){var e=this;this.isDeletingUser=!0,this.$axios.$delete("/api/users/".concat(t.id)).then((function(data){data.error?e.$toast.error(data.error):e.$toast.success(e.$strings.ToastUserDeleteSuccess)})).catch((function(t){console.error("Failed to delete user",t),e.$toast.error(e.$strings.ToastUserDeleteFailed)})).finally((function(){e.isDeletingUser=!1}))},editUser:function(t){this.$emit("edit",t)},loadUsers:function(){var t=this;this.$axios.$get("/api/users?include=latestSession").then((function(e){t.users=e.users.sort((function(a,b){return a.createdAt-b.createdAt})),t.$emit("numUsers",t.users.length)})).catch((function(t){console.error("Failed",t)}))},addUpdateUser:function(t){if(this.users){var e=this.users.findIndex((function(u){return u.id===t.id}));e>=0?this.users.splice(e,1,t):this.users.push(t)}},userRemoved:function(t){this.users=this.users.filter((function(u){return u.id!==t.id}))},init:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.$root.socket)return e>10?console.error("Failed to setup socket listeners"):void setTimeout((function(){t.init(++e)}),250);this.$root.socket.on("user_added",this.addUpdateUser),this.$root.socket.on("user_updated",this.addUpdateUser),this.$root.socket.on("user_removed",this.userRemoved)}},mounted:function(){this.loadUsers(),this.init()},beforeDestroy:function(){this.$root.socket&&(this.$root.socket.off("user_added",this.addUpdateUser),this.$root.socket.off("user_updated",this.addUpdateUser),this.$root.socket.off("user_removed",this.userRemoved))}},o=r,c=(n(763),n(4)),component=Object(c.a)(o,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"text-center"},[e("table",{attrs:{id:"accounts"}},[e("tr",[e("th",[t._v(t._s(t.$strings.LabelUsername))]),t._v(" "),e("th",{staticClass:"w-20"},[t._v(t._s(t.$strings.LabelAccountType))]),t._v(" "),e("th",{staticClass:"hidden lg:table-cell"},[t._v(t._s(t.$strings.LabelActivity))]),t._v(" "),e("th",{staticClass:"w-32 hidden sm:table-cell"},[t._v(t._s(t.$strings.LabelLastSeen))]),t._v(" "),e("th",{staticClass:"w-32 hidden sm:table-cell"},[t._v(t._s(t.$strings.LabelCreatedAt))]),t._v(" "),e("th",{staticClass:"w-32"})]),t._v(" "),t._l(t.users,(function(n){var r,o;return e("tr",{key:n.id,staticClass:"cursor-pointer",class:n.isActive?"":"bg-error/10!",on:{click:function(e){return t.$router.push("/config/users/".concat(n.id))}}},[e("td",[e("div",{staticClass:"flex items-center"},[e("widgets-online-indicator",{attrs:{value:!!t.usersOnline[n.id]}}),t._v(" "),e("p",{staticClass:"pl-2 truncate"},[t._v(t._s(n.username))])],1)]),t._v(" "),e("td",{staticClass:"text-sm"},[t._v(t._s(n.type))]),t._v(" "),e("td",{staticClass:"hidden lg:table-cell"},[null!==(r=t.usersOnline[n.id])&&void 0!==r&&null!==(r=r.session)&&void 0!==r&&r.displayTitle?e("div",[e("p",{staticClass:"truncate text-xs"},[t._v("Listening: "+t._s(t.usersOnline[n.id].session.displayTitle||""))]),t._v(" "),e("p",{staticClass:"truncate text-xs text-gray-300"},[t._v(t._s(t.getDeviceInfoString(t.usersOnline[n.id].session.deviceInfo)))])]):null!==(o=n.latestSession)&&void 0!==o&&o.displayTitle?e("div",[e("p",{staticClass:"truncate text-xs"},[t._v("Last: "+t._s(n.latestSession.displayTitle||""))]),t._v(" "),e("p",{staticClass:"truncate text-xs text-gray-300"},[t._v(t._s(t.getDeviceInfoString(n.latestSession.deviceInfo)))])]):t._e()]),t._v(" "),e("td",{staticClass:"text-xs font-mono hidden sm:table-cell"},[n.lastSeen?e("ui-tooltip",{attrs:{direction:"top",text:t.$formatDatetime(n.lastSeen,t.dateFormat,t.timeFormat)}},[t._v("\n            "+t._s(t.$dateDistanceFromNow(n.lastSeen))+"\n          ")]):t._e()],1),t._v(" "),e("td",{staticClass:"text-xs font-mono hidden sm:table-cell"},[e("ui-tooltip",{attrs:{direction:"top",text:t.$formatDatetime(n.createdAt,t.dateFormat,t.timeFormat)}},[t._v("\n            "+t._s(t.$formatDate(n.createdAt,t.dateFormat))+"\n          ")])],1),t._v(" "),e("td",{staticClass:"py-0"},[e("div",{staticClass:"w-full flex justify-left"},["root"!==n.type||t.userIsRoot?e("div",{staticClass:"h-8 w-8 flex items-center justify-center text-white/50 hover:text-white/100 cursor-pointer",on:{click:function(e){return e.stopPropagation(),t.editUser(n)}}},[e("button",{staticClass:"material-symbols text-base",attrs:{type:"button","aria-label":t.$getString("ButtonUserEdit",[n.username])}},[t._v("edit")])]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"root"!==n.type&&n.id!==t.currentUserId,expression:"user.type !== 'root' && user.id !== currentUserId"}],staticClass:"h-8 w-8 flex items-center justify-center text-white/50 hover:text-error cursor-pointer",on:{click:function(e){return e.stopPropagation(),t.deleteUserClick(n)}}},[e("button",{staticClass:"material-symbols text-base",attrs:{type:"button","aria-label":t.$getString("ButtonUserDelete",[n.username])}},[t._v("delete")])])])])])}))],2)])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{WidgetsOnlineIndicator:n(691).default,UiTooltip:n(76).default})}}]);