(window.webpackJsonp=window.webpackJsonp||[]).push([[105,149],{1100:function(e,t,r){"use strict";r.r(t);r(26),r(44),r(45),r(8),r(28);var o=r(16);r(22),r(43),r(17),r(27),r(38);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l={props:{processing:Boolean,libraryItem:{type:Object,default:function(){}},episode:{type:Object,default:function(){}}},data:function(){return{episodeTitle:"",searchedTitle:"",episodesFound:[]}},watch:{episode:{immediate:!0,handler:function(e){e&&this.init()}}},computed:{isProcessing:{get:function(){return this.processing},set:function(e){this.$emit("update:processing",e)}},episodeId:function(){return this.episode?this.episode.id:null},media:function(){return this.libraryItem&&this.libraryItem.media||{}},mediaMetadata:function(){return this.media.metadata||{}},podcastFeedUrl:function(){return this.mediaMetadata.feedUrl}},methods:{getUpdatePayload:function(e){var t={};for(var r in e)"enclosure"===r?this.episode.enclosure&&JSON.stringify(this.episode.enclosure)===JSON.stringify(e.enclosure)||(t[r]=c({},e.enclosure)):e[r]!=this.episode[r]&&(t[r]=e[r]);return t},selectEpisode:function(e){var t=this,r={title:e.title||"",subtitle:e.subtitle||"",description:e.description||"",enclosure:e.enclosure||null,episode:e.episode||"",episodeType:e.episodeType||"",season:e.season||"",pubDate:e.pubDate||"",publishedAt:e.publishedAt},o=this.getUpdatePayload(r);if(!Object.keys(o).length)return this.$toast.info(this.$strings.ToastNoUpdatesNecessary);console.log("Episode update payload",o),this.isProcessing=!0,this.$axios.$patch("/api/podcasts/".concat(this.libraryItem.id,"/episode/").concat(this.episodeId),o).then((function(){t.isProcessing=!1,t.$toast.success(t.$strings.ToastPodcastEpisodeUpdated),t.$emit("selectTab","details")})).catch((function(e){var r=e.response&&e.response.data?e.response.data:"Failed to update episode";console.error("Failed update episode",e),t.isProcessing=!1,t.$toast.error(r)}))},submitForm:function(){var e=this;this.episodeTitle&&this.episodeTitle.length?(this.searchedTitle=this.episodeTitle,this.isProcessing=!0,this.$axios.$get("/api/podcasts/".concat(this.libraryItem.id,"/search-episode?title=").concat(encodeURIComponent(this.episodeTitle))).then((function(t){e.episodesFound=t.episodes.map((function(e){return e.episode})),console.log("Episodes found",e.episodesFound),e.isProcessing=!1})).catch((function(t){console.error("Failed to search for episode",t);var r=t.response&&t.response.data||"";e.$toast.error(r||"Failed to search for episode"),e.isProcessing=!1}))):this.$toast.error(this.$strings.ToastTitleRequired)},init:function(){this.searchedTitle=null,this.episodesFound=[],this.episodeTitle=this.episode&&this.episode.title||""}},mounted:function(){}},d=r(4),component=Object(d.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"min-height":"200px"}},[e.podcastFeedUrl?[t("form",{on:{submit:function(t){return t.preventDefault(),e.submitForm.apply(null,arguments)}}},[t("div",{staticClass:"flex mb-2"},[t("ui-text-input-with-label",{staticClass:"pr-1",attrs:{disabled:e.isProcessing,label:e.$strings.LabelEpisodeTitle},model:{value:e.episodeTitle,callback:function(t){e.episodeTitle=t},expression:"episodeTitle"}}),e._v(" "),t("ui-btn",{staticClass:"mt-5 ml-1",attrs:{loading:e.isProcessing,type:"submit"}},[e._v(e._s(e.$strings.ButtonSearch))])],1)]),e._v(" "),e.isProcessing||!e.searchedTitle||e.episodesFound.length?e._e():t("div",{staticClass:"w-full py-8"},[t("p",{staticClass:"text-center text-lg"},[e._v(e._s(e.$strings.MessageNoEpisodeMatchesFound))])]),e._v(" "),e._l(e.episodesFound,(function(r,o){return t("div",{key:o,staticClass:"w-full py-4 border-b border-white/5 hover:bg-gray-300/10 cursor-pointer px-2",on:{click:function(t){return t.stopPropagation(),e.selectEpisode(r)}}},[r.episode?t("p",{staticClass:"font-semibold text-gray-200"},[e._v("#"+e._s(r.episode))]):e._e(),e._v(" "),t("p",{staticClass:"break-words mb-1"},[e._v(e._s(r.title))]),e._v(" "),r.subtitle?t("p",{staticClass:"mb-1 text-sm text-gray-300 line-clamp-2"},[e._v(e._s(r.subtitle))]):e._e(),e._v(" "),t("p",{staticClass:"text-xs text-gray-400"},[e._v("Published "+e._s(r.publishedAt?e.$dateDistanceFromNow(r.publishedAt):"Unknown"))])])}))]:[t("div",{staticClass:"py-8"},[t("widgets-alert",{attrs:{type:"error"}},[e._v(e._s(e.$strings.MessagePodcastHasNoRSSFeedForMatching))])],1)]],2)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{WidgetsAlert:r(657).default,UiTextInputWithLabel:r(121).default,UiBtn:r(42).default})},657:function(e,t,r){"use strict";r.r(t);var o={props:{type:{type:String,default:"error"}},data:function(){return{}},computed:{icon:function(){return"error"===this.type||"warning"===this.type?"report":"info"},wrapperClass:function(){switch(this.type){case"error":return"bg-error/5 border-error/60 text-error";case"warning":return"bg-warning/5 border-warning/60 text-warning";case"success":return"bg-success/5 border-success/60 text-success";case"info":return"bg-info/5 border-info/60 text-info";default:return"bg-primary/5 border-primary/60 text-primary"}}},methods:{},mounted:function(){}},n=r(4),component=Object(n.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-full border rounded-lg flex items-center relative py-4 pl-16",class:e.wrapperClass},[t("div",{staticClass:"absolute top-0 left-4 h-full flex items-center"},[t("span",{staticClass:"material-symbols text-2xl"},[e._v(e._s(e.icon))])]),e._v(" "),e._t("default")],2)}),[],!1,null,null,null);t.default=component.exports}}]);