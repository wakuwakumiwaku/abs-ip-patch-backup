(window.webpackJsonp=window.webpackJsonp||[]).push([[100,57,159],{642:function(e,t,o){"use strict";o.d(t,"a",(function(){return d}));var n=o(183);var l=o(237),r=o(149);function d(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||Object(l.a)(e)||Object(r.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},677:function(e,t,o){"use strict";o.r(t);var n={props:{type:{type:String,default:"full"}},data:function(){return{}},computed:{},methods:{},mounted:function(){}},l=o(4),component=Object(l.a)(n,(function(){var e=this,t=e._self._c;return t("div",["bonus"==e.type?[t("ui-tooltip",{attrs:{text:"Bonus",direction:"top"}},[t("span",{staticClass:"material-symbols ml-1",staticStyle:{"font-size":"0.8rem"}},[e._v("local_play")])])]:e._e(),e._v(" "),"trailer"==e.type?[t("ui-tooltip",{attrs:{text:"Trailer",direction:"top"}},[t("span",{staticClass:"material-symbols ml-1",staticStyle:{"font-size":"0.8rem"}},[e._v("local_movies")])])]:e._e()],2)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiTooltip:o(76).default})},718:function(e,t,o){var content=o(770);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(19).default)("7cd0c07d",content,!0,{sourceMap:!1})},769:function(e,t,o){"use strict";o(718)},770:function(e,t,o){var n=o(18)((function(i){return i[1]}));n.push([e.i,"\n#podcast-wrapper[data-v-045496eb] {\n  min-height: 400px;\n  max-height: 80vh;\n}\n#episodes-scroll[data-v-045496eb] {\n  max-height: calc(80vh - 200px);\n}\n",""]),n.locals={},e.exports=n},862:function(e,t,o){"use strict";o.r(t);o(14),o(35),o(122);var n=o(16),l=o(642);o(22),o(43),o(84),o(17),o(26),o(33),o(83),o(41),o(27),o(57),o(150),o(189),o(15),o(44),o(45),o(38),o(8),o(59),o(52),o(62),o(147),o(28),o(58),o(40),o(350);function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function d(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){Object(n.a)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function c(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,a){if(e){if("string"==typeof e)return h(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,l=function(){};return{s:l,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==o.return||o.return()}finally{if(u)throw r}}}}function h(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,o=Array(a);t<a;t++)o[t]=e[t];return o}var f={props:{value:Boolean,libraryItem:{type:Object,default:function(){}},episodes:{type:Array,default:function(){return[]}},downloadQueue:{type:Array,default:function(){return[]}},episodesDownloading:{type:Array,default:function(){return[]}}},data:function(){return{processing:!1,episodesCleaned:[],selectedEpisodes:{},selectAll:!1,search:null,searchTimeout:null,searchText:null,downloadedEpisodeGuidMap:{},downloadedEpisodeUrlMap:{},sortDescending:!0}},watch:{show:{immediate:!0,handler:function(e){e&&this.init()}},episodes:{handler:function(e){e&&this.updateEpisodeDownloadStatuses()}},episodesDownloading:{handler:function(e){e&&this.updateEpisodeDownloadStatuses()}},downloadQueue:{handler:function(e){e&&this.updateEpisodeDownloadStatuses()}}},computed:{show:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},title:function(){return this.libraryItem?this.libraryItem.media.metadata.title||"Unknown":""},allDownloaded:function(){var e=this;return!this.episodesCleaned.some((function(t){return!e.getIsEpisodeDownloaded(t)}))},episodesSelected:function(){var e=this;return Object.keys(this.selectedEpisodes).filter((function(t){return!!e.selectedEpisodes[t]}))},buttonText:function(){return this.episodesSelected.length?1===this.episodesSelected.length?"".concat(this.$strings.LabelDownload," ").concat(this.$strings.LabelEpisode.toLowerCase()):this.$getString("LabelDownloadNEpisodes",[this.episodesSelected.length]):this.$strings.LabelNoEpisodesSelected},itemEpisodes:function(){var e;return(null===(e=this.libraryItem)||void 0===e?void 0:e.media.episodes)||[]},episodesList:function(){var e=this;return this.episodesCleaned.filter((function(t){var o,n;return!e.searchText||((null===(o=t.title)||void 0===o?void 0:o.toLowerCase().includes(e.searchText))||(null===(n=t.subtitle)||void 0===n?void 0:n.toLowerCase().includes(e.searchText)))}))},selectAllLabel:function(){var e=this;if(this.episodesList.length===this.episodesCleaned.length)return this.$strings.LabelSelectAllEpisodes;var t=this.episodesList.filter((function(t){return!e.getIsEpisodeDownloaded(t)})).length;return this.$getString("LabelSelectEpisodesShowing",[t])}},methods:{toggleSort:function(){var e=this;this.sortDescending=!this.sortDescending,this.episodesCleaned=this.episodesCleaned.toSorted((function(a,b){return e.sortDescending?a.publishedAt<b.publishedAt?1:-1:a.publishedAt>b.publishedAt?1:-1})),this.selectedEpisodes={},this.selectAll=!1},getIsEpisodeDownloaded:function(e){return!(!e.guid||!this.downloadedEpisodeGuidMap[e.guid])||!!this.downloadedEpisodeUrlMap[e.cleanUrl]},getIsEpisodeDownloadingOrQueued:function(e){var t=this,o=[].concat(Object(l.a)(this.episodesDownloading),Object(l.a)(this.downloadQueue));return e.guid?o.some((function(t){return t.guid===e.guid})):o.some((function(o){return t.getCleanEpisodeUrl(o.url)===e.cleanUrl}))},getCleanEpisodeUrl:function(e){var t=e.split("?")[1];if(!t)return e;for(var o=new URLSearchParams(t),n=0,l=Array.from(o.keys());n<l.length;n++){var p=l[n];"id"!==p&&o.delete(p)}return o.toString()?"".concat(e,"?").concat(o.toString()):e},inputUpdate:function(){var e=this;clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){var t;if(null===(t=e.search)||void 0===t||!t.trim())return e.searchText="",void e.checkSetIsSelectedAll();e.searchText=e.search.toLowerCase().trim(),e.checkSetIsSelectedAll()}),500)},toggleSelectAll:function(e){var t,o=c(this.episodesList);try{for(o.s();!(t=o.n()).done;){var n=t.value;n.isDownloaded||n.isDownloading?this.selectedEpisodes[n.cleanUrl]=!1:this.$set(this.selectedEpisodes,n.cleanUrl,e)}}catch(e){o.e(e)}finally{o.f()}},checkSetIsSelectedAll:function(){var e,t=c(this.episodesList);try{for(t.s();!(e=t.n()).done;){var o=e.value;if(!o.isDownloaded&&!o.isDownloading&&!this.selectedEpisodes[o.cleanUrl])return void(this.selectAll=!1)}}catch(e){t.e(e)}finally{t.f()}this.selectAll=!0},toggleSelectEpisode:function(e){e.isDownloaded||e.isDownloading||(this.$set(this.selectedEpisodes,e.cleanUrl,!this.selectedEpisodes[e.cleanUrl]),this.checkSetIsSelectedAll())},submit:function(){var e=this,t=[];this.episodesSelected.length&&(t=this.episodesSelected.map((function(t){return e.episodesCleaned.find((function(e){return e.cleanUrl==t}))})));var o=JSON.stringify(t).length/1024/1024,n=o.toFixed(2)+"MB";if(console.log("Request size",o),o>9.99)return this.$toast.error("Request is too large (".concat(n,") should be < 10Mb"));this.processing=!0,this.$axios.$post("/api/podcasts/".concat(this.libraryItem.id,"/download-episodes"),t).then((function(){e.processing=!1,e.$toast.success("Started downloading episodes"),e.show=!1})).catch((function(t){var o;console.error("Failed to download episodes",t),e.processing=!1,e.$toast.error((null===(o=t.response)||void 0===o?void 0:o.data)||"Failed to download episodes"),e.selectedEpisodes={},e.selectAll=!1}))},init:function(){var e=this;this.updateDownloadedEpisodeMaps(),this.episodesCleaned=this.episodes.filter((function(e){var t;return null===(t=e.enclosure)||void 0===t?void 0:t.url})).map((function(t){return d(d({},t),{},{cleanUrl:e.getCleanEpisodeUrl(t.enclosure.url),isDownloading:e.getIsEpisodeDownloadingOrQueued(t),isDownloaded:e.getIsEpisodeDownloaded(t)})})),this.episodesCleaned.sort((function(a,b){return a.publishedAt<b.publishedAt?1:-1})),this.selectAll=!1,this.selectedEpisodes={}},updateDownloadedEpisodeMaps:function(){var e=this;this.downloadedEpisodeGuidMap={},this.downloadedEpisodeUrlMap={},this.itemEpisodes.forEach((function(t){var o;t.guid&&(e.downloadedEpisodeGuidMap[t.guid]=t.id),null!==(o=t.enclosure)&&void 0!==o&&o.url&&(e.downloadedEpisodeUrlMap[e.getCleanEpisodeUrl(t.enclosure.url)]=t.id)}))},updateEpisodeDownloadStatuses:function(){var e=this;this.updateDownloadedEpisodeMaps(),this.episodesCleaned=this.episodesCleaned.map((function(t){return d(d({},t),{},{isDownloading:e.getIsEpisodeDownloadingOrQueued(t),isDownloaded:e.getIsEpisodeDownloaded(t)})}))}},mounted:function(){}},v=(o(769),o(4)),component=Object(v.a)(f,(function(){var e=this,t=e._self._c;return t("modals-modal",{attrs:{name:"podcast-episodes-modal",width:1200,height:"unset",processing:e.processing},scopedSlots:e._u([{key:"outer",fn:function(){return[t("div",{staticClass:"absolute top-0 left-0 p-5 w-2/3 overflow-hidden"},[t("p",{staticClass:"text-3xl text-white truncate"},[e._v(e._s(e.title))])])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v(" "),t("div",{ref:"wrapper",staticClass:"p-4 w-full text-sm py-2 rounded-lg bg-bg shadow-lg border border-black-300 relative overflow-hidden",attrs:{id:"podcast-wrapper"}},[e.episodesCleaned.length?t("div",{staticClass:"w-full py-3 mx-auto flex"},[t("form",{staticClass:"flex grow",on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[t("ui-text-input",{staticClass:"grow mr-2 text-sm md:text-base",attrs:{type:"search",placeholder:e.$strings.PlaceholderSearchEpisode},on:{input:e.inputUpdate},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),t("ui-btn",{attrs:{"padding-x":4},on:{click:e.toggleSort}},[t("span",{staticClass:"pr-4"},[e._v(e._s(e.$strings.LabelSortPubDate))]),e._v(" "),t("span",{staticClass:"text-yellow-400 absolute inset-y-0 right-0 flex items-center pr-2"},[t("span",{staticClass:"material-symbols text-xl",attrs:{"aria-label":e.sortDescending?e.$strings.LabelSortDescending:e.$strings.LabelSortAscending}},[e._v(e._s(e.sortDescending?"expand_more":"expand_less"))])])])],1):e._e(),e._v(" "),t("div",{ref:"episodeContainer",staticClass:"w-full overflow-x-hidden overflow-y-auto",attrs:{id:"episodes-scroll"}},e._l(e.episodesList,(function(o,n){var l;return t("div",{key:n,staticClass:"relative",class:o.isDownloaded||o.isDownloading?"bg-primary/40":e.selectedEpisodes[o.cleanUrl]?"cursor-pointer bg-success/10":n%2==0?"cursor-pointer bg-primary/25 hover:bg-primary/40":"cursor-pointer bg-primary/5 hover:bg-primary/25",on:{click:function(t){return e.toggleSelectEpisode(o)}}},[t("div",{staticClass:"absolute top-0 left-0 h-full flex items-center p-2"},[o.isDownloaded?t("span",{staticClass:"material-symbols text-success text-xl"},[e._v("download_done")]):o.isDownloading?t("span",{staticClass:"material-symbols text-warning text-xl"},[e._v("download")]):t("ui-checkbox",{attrs:{small:"","checkbox-bg":"primary","border-color":"gray-600"},model:{value:e.selectedEpisodes[o.cleanUrl],callback:function(t){e.$set(e.selectedEpisodes,o.cleanUrl,t)},expression:"selectedEpisodes[episode.cleanUrl]"}})],1),e._v(" "),t("div",{staticClass:"px-8 py-2"},[t("div",{staticClass:"flex items-center font-semibold text-gray-200"},[o.season||o.episode?t("div",[e._v("#")]):e._e(),e._v(" "),o.season?t("div",[e._v(e._s(o.season)+"x")]):e._e(),e._v(" "),o.episode?t("div",[e._v(e._s(o.episode))]):e._e()]),e._v(" "),t("div",{staticClass:"flex items-center mb-1"},[t("div",{staticClass:"break-words"},[e._v(e._s(o.title))]),e._v(" "),t("widgets-podcast-type-indicator",{attrs:{type:o.episodeType}})],1),e._v(" "),o.subtitle?t("p",{staticClass:"mb-1 text-sm text-gray-300 line-clamp-2"},[e._v(e._s(o.subtitle))]):e._e(),e._v(" "),t("div",{staticClass:"flex items-center space-x-2"},[t("p",{staticClass:"text-xs text-gray-300 w-40"},[e._v("Published "+e._s(o.publishedAt?e.$dateDistanceFromNow(o.publishedAt):"Unknown"))]),e._v(" "),o.durationSeconds&&!isNaN(o.durationSeconds)?t("p",{staticClass:"text-xs text-gray-300 min-w-28"},[e._v(e._s(e.$strings.LabelDuration)+": "+e._s(e.$elapsedPretty(o.durationSeconds)))]):e._e(),e._v(" "),null!==(l=o.enclosure)&&void 0!==l&&l.length&&!isNaN(o.enclosure.length)&&Number(o.enclosure.length)>0?t("p",{staticClass:"text-xs text-gray-300"},[e._v(e._s(e.$strings.LabelSize)+": "+e._s(e.$bytesPretty(Number(o.enclosure.length))))]):e._e()])])])})),0),e._v(" "),t("div",{staticClass:"flex justify-end pt-4"},[e.allDownloaded?e._e():t("ui-checkbox",{staticClass:"mx-8",attrs:{label:e.selectAllLabel,small:"","checkbox-bg":"primary","border-color":"gray-600"},on:{input:e.toggleSelectAll},model:{value:e.selectAll,callback:function(t){e.selectAll=t},expression:"selectAll"}}),e._v(" "),e.allDownloaded?t("p",{staticClass:"text-success text-base px-2 py-4"},[e._v(e._s(e.$strings.LabelAllEpisodesDownloaded))]):t("ui-btn",{attrs:{disabled:!e.episodesSelected.length},on:{click:e.submit}},[e._v(e._s(e.buttonText))])],1)])])}),[],!1,null,"045496eb",null);t.default=component.exports;installComponents(component,{UiTextInput:o(68).default,UiBtn:o(42).default,UiCheckbox:o(184).default,WidgetsPodcastTypeIndicator:o(677).default,ModalsModal:o(39).default})}}]);