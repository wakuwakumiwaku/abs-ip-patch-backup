(window.webpackJsonp=window.webpackJsonp||[]).push([[182,59,98],{1054:function(e,t,n){"use strict";n.r(t);var r=n(16),o=n(7);n(29),n(22),n(17),n(26),n(33),n(41),n(56),n(27),n(150),n(15),n(44),n(45),n(38),n(8),n(59),n(52),n(62),n(28),n(58),n(350);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var n,r,o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.store,r=e.redirect,o=e.app,n.getters["user/getIsAdminOrUp"]){t.next=4;break}return r("/"),t.abrupt("return");case 4:return t.next=6,o.$axios.$get("/api/users").then((function(e){return e.users.sort((function(a,b){return a.createdAt-b.createdAt}))})).catch((function(e){return console.error("Failed",e),[]}));case 6:return l=t.sent,t.abrupt("return",{users:l});case 8:case"end":return t.stop()}}),t)})))()},data:function(){return{loading:!1,showSessionModal:!1,selectedSession:null,listeningSessions:[],openListeningSessions:[],openShareListeningSessions:[],numPages:0,total:0,currentPage:0,itemsPerPage:10,userFilter:null,selectedUser:"",sortBy:"updatedAt",sortDesc:!0,processingGoToTimestamp:!1,deletingSessions:!1,itemsPerPageOptions:[10,25,50,100]}},computed:{username:function(){return this.user.username},userOnline:function(){return this.$store.getters["users/getIsUserOnline"](this.user.id)},userItems:function(){var e=[{value:"",text:this.$strings.LabelAllUsers}];return e.concat(this.users.map((function(u){return{value:u.id,text:u.username}})))},filteredUserUsername:function(){var e=this;if(!this.userFilter)return null;var t=this.users.find((function(u){return u.id===e.userFilter}));return(null==t?void 0:t.username)||null},dateFormat:function(){return this.$store.getters.getServerSetting("dateFormat")},timeFormat:function(){return this.$store.getters.getServerSetting("timeFormat")},numSelected:function(){return this.listeningSessions.filter((function(s){return s.selected})).length},isAllSelected:{get:function(){return this.numSelected===this.listeningSessions.length},set:function(e){this.setSelectionForAll(e)}}},methods:{isSortSelected:function(e){return this.sortBy===e},sortColumn:function(e){this.sortBy===e?this.sortDesc=!this.sortDesc:this.sortBy=e,this.loadSessions(this.currentPage)},removeSelectedSessions:function(){var e=this;if(this.numSelected){this.deletingSessions=!0;var t=this.isAllSelected,n={sessions:this.listeningSessions.filter((function(s){return s.selected})).map((function(s){return s.id}))};this.$axios.$post("/api/sessions/batch/delete",n).then((function(){t?(e.currentPage>0&&e.currentPage--,e.loadSessions(e.currentPage)):e.listeningSessions=e.listeningSessions.filter((function(e){return!n.sessions.includes(e.id)}))})).catch((function(t){var n,r=(null===(n=t.response)||void 0===n?void 0:n.data)||e.$strings.ToastRemoveFailed;e.$toast.error(r)})).finally((function(){e.deletingSessions=!1}))}},removeSessionsClick:function(){var e=this;if(this.numSelected){var t={message:this.$getString("MessageConfirmRemoveListeningSessions",[this.numSelected]),callback:function(t){t&&e.removeSelectedSessions()},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",t)}},setSelectionForAll:function(e){this.listeningSessions=this.listeningSessions.map((function(s){return s.selected=e,s}))},updatedItemsPerPage:function(){this.currentPage=0,this.loadSessions(this.currentPage)},closedSession:function(){this.loadOpenSessions()},removedSession:function(){if(this.currentPage==this.numPages-1){var e=this.total-1;if(Math.ceil(e/this.itemsPerPage)<this.numPages)return void this.prevPage()}this.loadSessions(this.currentPage)},clickCurrentTime:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r,o,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.processingGoToTimestamp){n.next=2;break}return n.abrupt("return");case 2:return t.processingGoToTimestamp=!0,n.next=5,t.$axios.$get("/api/items/".concat(e.libraryItemId)).catch((function(e){return console.error("Failed to get library item",e),null}));case 5:if(r=n.sent){n.next=10;break}return t.$toast.error(t.$strings.ToastFailedToLoadData),t.processingGoToTimestamp=!1,n.abrupt("return");case 10:if(!e.episodeId||r.media.episodes.some((function(t){return t.id===e.episodeId}))){n.next=15;break}return console.error("Episode not found in library item",e.episodeId,r.media.episodes),t.$toast.error(t.$strings.ToastFailedToLoadData),t.processingGoToTimestamp=!1,n.abrupt("return");case 15:o={},e.episodeId?(l=r.media.episodes.find((function(t){return t.id===e.episodeId})),o={libraryItemId:r.id,libraryId:r.libraryId,episodeId:l.id,title:l.title,subtitle:r.media.metadata.title,caption:l.publishedAt?t.$getString("LabelPublishedDate",[t.$formatDate(l.publishedAt,t.dateFormat)]):t.$strings.LabelUnknownPublishDate,duration:l.audioFile.duration||null,coverPath:r.media.coverPath||null}):o={libraryItemId:r.id,libraryId:r.libraryId,episodeId:null,title:r.media.metadata.title,subtitle:r.media.metadata.authors.map((function(e){return e.name})).join(", "),caption:"",duration:r.media.duration||null,coverPath:r.media.coverPath||null},c={message:t.$getString("MessageStartPlaybackAtTime",[e.displayTitle,t.$secondsToTimestamp(e.currentTime)]),callback:function(n){n&&t.$eventBus.$emit("play-item",{libraryItemId:r.id,episodeId:e.episodeId||null,startTime:e.currentTime,queueItems:[o]}),t.processingGoToTimestamp=!1},type:"yesNo"},t.$store.commit("globals/setConfirmPrompt",c);case 19:case"end":return n.stop()}}),n)})))()},updateUserFilter:function(){this.loadSessions(0)},prevPage:function(){this.loadSessions(this.currentPage-1)},nextPage:function(){this.loadSessions(this.currentPage+1)},clickSessionRow:function(e){this.numSelected>0?e.selected=!e.selected:this.showSession(e)},showSession:function(e){this.selectedSession=e,this.showSessionModal=!0},getDeviceInfoString:function(e){if(!e)return"";var t=[];return e.clientName&&t.push("".concat(e.clientName," ").concat(e.clientVersion||"")),e.osName&&t.push("".concat(e.osName," ").concat(e.osVersion)),e.browserName&&t.push(e.browserName),e.manufacturer&&e.model&&t.push("".concat(e.manufacturer," ").concat(e.model)),e.sdkVersion&&t.push("SDK Version: ".concat(e.sdkVersion)),t.join("<br>")},getPlayMethodName:function(e){return e===this.$constants.PlayMethod.DIRECTPLAY?"Direct Play":e===this.$constants.PlayMethod.TRANSCODE?"Transcode":e===this.$constants.PlayMethod.DIRECTSTREAM?"Direct Stream":e===this.$constants.PlayMethod.LOCAL?"Local":"Unknown"},loadSessions:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,(r=new URLSearchParams).set("page",e),r.set("itemsPerPage",t.itemsPerPage),r.set("sort",t.sortBy),r.set("desc",t.sortDesc?"1":"0"),t.selectedUser&&r.set("user",t.selectedUser),n.next=9,t.$axios.$get("/api/sessions?".concat(r.toString())).catch((function(e){return console.error("Failed to load listening sessions",e),null}));case 9:if(data=n.sent,t.loading=!1,data){n.next=14;break}return t.$toast.error(t.$strings.ToastFailedToLoadData),n.abrupt("return");case 14:t.numPages=data.numPages,t.total=data.total,t.currentPage=data.page,t.listeningSessions=data.sessions.map((function(e){return c(c({},e),{},{selected:!1})})),t.userFilter=data.userId;case 19:case"end":return n.stop()}}),n)})))()},loadOpenSessions:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("/api/sessions/open").catch((function(e){return console.error("Failed to load open sessions",e),null}));case 2:if(data=t.sent){t.next=6;break}return e.$toast.error(e.$strings.ToastFailedToLoadData),t.abrupt("return");case 6:e.openListeningSessions=(data.sessions||[]).map((function(s){return s.open=!0,s})),e.openShareListeningSessions=data.shareSessions||[];case 8:case"end":return t.stop()}}),t)})))()},init:function(){this.loadSessions(0),this.loadOpenSessions()}},mounted:function(){this.init()}},m=(n(905),n(4)),component=Object(m.a)(d,(function(){var e=this,t=e._self._c;return t("div",[t("app-settings-content",{attrs:{"header-text":e.$strings.HeaderListeningSessions}},[t("div",{staticClass:"flex justify-end mb-2"},[t("ui-dropdown",{staticClass:"max-w-48",attrs:{items:e.userItems,label:e.$strings.LabelFilterByUser,small:""},on:{input:e.updateUserFilter},model:{value:e.selectedUser,callback:function(t){e.selectedUser=t},expression:"selectedUser"}})],1),e._v(" "),e.listeningSessions.length?t("div",{staticClass:"block max-w-full relative"},[t("div",{staticClass:"overflow-x-auto"},[t("table",{staticClass:"userSessionsTable"},[t("tr",{staticClass:"bg-primary/40"},[t("th",{staticClass:"w-6 min-w-6 text-left hidden md:table-cell h-11"},[t("ui-checkbox",{attrs:{partial:e.numSelected>0&&!e.isAllSelected,small:"","checkbox-bg":"bg"},model:{value:e.isAllSelected,callback:function(t){e.isAllSelected=t},expression:"isAllSelected"}})],1),e._v(" "),e.numSelected?t("th",{staticClass:"grow text-left",attrs:{colspan:7}},[t("div",{staticClass:"flex items-center"},[t("p",[e._v(e._s(e.$getString("MessageSelected",[e.numSelected])))]),e._v(" "),t("div",{staticClass:"grow"}),e._v(" "),t("ui-btn",{attrs:{small:"",color:"bg-error",loading:e.deletingSessions},on:{click:function(t){return t.stopPropagation(),e.removeSessionsClick.apply(null,arguments)}}},[e._v(e._s(e.$strings.ButtonRemove))])],1)]):e._e(),e._v(" "),e.numSelected?e._e():t("th",{staticClass:"grow sm:grow-0 sm:w-48 sm:max-w-48 text-left group cursor-pointer",on:{click:function(t){return t.stopPropagation(),e.sortColumn("displayTitle")}}},[t("div",{staticClass:"inline-flex items-center"},[e._v("\n                "+e._s(e.$strings.LabelItem)+" "),t("span",{staticClass:"material-symbols text-base pl-px",class:{"opacity-0 group-hover:opacity-30":!e.isSortSelected("displayTitle")}},[e._v(e._s(e.sortDesc?"arrow_drop_down":"arrow_drop_up"))])])]),e._v(" "),e.numSelected?e._e():t("th",{staticClass:"w-20 min-w-20 text-left hidden md:table-cell"},[e._v(e._s(e.$strings.LabelUser))]),e._v(" "),e.numSelected?e._e():t("th",{staticClass:"w-26 min-w-26 text-left hidden md:table-cell group cursor-pointer",on:{click:function(t){return t.stopPropagation(),e.sortColumn("playMethod")}}},[t("div",{staticClass:"inline-flex items-center"},[e._v("\n                "+e._s(e.$strings.LabelPlayMethod)+" "),t("span",{staticClass:"material-symbols text-base pl-px",class:{"opacity-0 group-hover:opacity-30":!e.isSortSelected("playMethod")}},[e._v(e._s(e.sortDesc?"arrow_drop_down":"arrow_drop_up"))])])]),e._v(" "),e.numSelected?e._e():t("th",{staticClass:"w-32 min-w-32 text-left hidden sm:table-cell"},[e._v(e._s(e.$strings.LabelDeviceInfo))]),e._v(" "),e.numSelected?e._e():t("th",{staticClass:"w-24 min-w-24 sm:w-32 sm:min-w-32 group cursor-pointer",on:{click:function(t){return t.stopPropagation(),e.sortColumn("timeListening")}}},[t("div",{staticClass:"inline-flex items-center"},[e._v("\n                "+e._s(e.$strings.LabelTimeListened)+" "),t("span",{staticClass:"material-symbols text-base pl-px hidden sm:inline-block",class:{"opacity-0 group-hover:opacity-30":!e.isSortSelected("timeListening")}},[e._v(e._s(e.sortDesc?"arrow_drop_down":"arrow_drop_up"))])])]),e._v(" "),e.numSelected?e._e():t("th",{staticClass:"w-24 min-w-24 group cursor-pointer",on:{click:function(t){return t.stopPropagation(),e.sortColumn("currentTime")}}},[t("div",{staticClass:"inline-flex items-center"},[e._v("\n                "+e._s(e.$strings.LabelLastTime)+" "),t("span",{staticClass:"material-symbols text-base pl-px hidden sm:inline-block",class:{"opacity-0 group-hover:opacity-30":!e.isSortSelected("currentTime")}},[e._v(e._s(e.sortDesc?"arrow_drop_down":"arrow_drop_up"))])])]),e._v(" "),e.numSelected?e._e():t("th",{staticClass:"grow hidden sm:table-cell cursor-pointer group",on:{click:function(t){return t.stopPropagation(),e.sortColumn("updatedAt")}}},[t("div",{staticClass:"inline-flex items-center"},[e._v("\n                "+e._s(e.$strings.LabelLastUpdate)+" "),t("span",{staticClass:"material-symbols text-base pl-px",class:{"opacity-0 group-hover:opacity-30":!e.isSortSelected("updatedAt")}},[e._v(e._s(e.sortDesc?"arrow_drop_down":"arrow_drop_up"))])])])]),e._v(" "),e._l(e.listeningSessions,(function(n){return t("tr",{key:n.id,staticClass:"cursor-pointer",class:{selected:n.selected},on:{click:function(t){return e.clickSessionRow(n)}}},[t("td",{staticClass:"hidden md:table-cell py-1 max-w-6 relative"},[t("ui-checkbox",{attrs:{small:"","checkbox-bg":"bg"},model:{value:n.selected,callback:function(t){e.$set(n,"selected",t)},expression:"session.selected"}}),e._v(" "),t("div",{staticClass:"absolute inset-0 w-full h-full",on:{click:function(e){e.stopPropagation(),n.selected=!n.selected}}})],1),e._v(" "),t("td",{staticClass:"py-1 grow sm:grow-0 sm:w-48 sm:max-w-48"},[t("p",{staticClass:"text-xs text-gray-200 truncate"},[e._v(e._s(n.displayTitle))]),e._v(" "),t("p",{staticClass:"text-xs text-gray-400 truncate"},[e._v(e._s(n.displayAuthor))])]),e._v(" "),t("td",{staticClass:"hidden md:table-cell w-20 min-w-20"},[e.filteredUserUsername?t("p",{staticClass:"text-xs"},[e._v(e._s(e.filteredUserUsername))]):t("p",{staticClass:"text-xs"},[e._v(e._s(n.user?n.user.username:"N/A"))])]),e._v(" "),t("td",{staticClass:"hidden md:table-cell w-26 min-w-26"},[t("p",{staticClass:"text-xs"},[e._v(e._s(e.getPlayMethodName(n.playMethod)))])]),e._v(" "),t("td",{staticClass:"hidden sm:table-cell max-w-32 min-w-32"},[t("p",{staticClass:"text-xs truncate",domProps:{innerHTML:e._s(e.getDeviceInfoString(n.deviceInfo))}})]),e._v(" "),t("td",{staticClass:"text-center w-24 min-w-24 sm:w-32 sm:min-w-32"},[t("p",{staticClass:"text-xs font-mono"},[e._v(e._s(e.$elapsedPrettyLocalized(n.timeListening)))])]),e._v(" "),t("td",{staticClass:"text-center hover:underline w-24 min-w-24",on:{click:function(t){return t.stopPropagation(),e.clickCurrentTime(n)}}},[t("p",{staticClass:"text-xs font-mono"},[e._v(e._s(e.$secondsToTimestamp(n.currentTime)))])]),e._v(" "),t("td",{staticClass:"text-center hidden sm:table-cell"},[n.updatedAt?t("ui-tooltip",{attrs:{direction:"top",text:e.$formatDatetime(n.updatedAt,e.dateFormat,e.timeFormat)}},[t("p",{staticClass:"text-xs text-gray-200"},[e._v(e._s(e.$dateDistanceFromNow(n.updatedAt)))])]):e._e()],1)])}))],2)]),e._v(" "),t("div",{staticClass:"flex items-center my-2"},[t("div",{staticClass:"grow"}),e._v(" "),t("div",{staticClass:"hidden sm:inline-flex items-center"},[t("p",{staticClass:"text-sm whitespace-nowrap"},[e._v(e._s(e.$strings.LabelRowsPerPage))]),e._v(" "),t("ui-dropdown",{staticClass:"w-24 mx-2",attrs:{items:e.itemsPerPageOptions,small:""},on:{input:e.updatedItemsPerPage},model:{value:e.itemsPerPage,callback:function(t){e.itemsPerPage=t},expression:"itemsPerPage"}})],1),e._v(" "),t("div",{staticClass:"inline-flex items-center"},[t("p",{staticClass:"text-sm mx-2"},[e._v(e._s(e.$getString("LabelPaginationPageXOfY",[e.currentPage+1,e.numPages])))]),e._v(" "),t("ui-icon-btn",{staticClass:"mx-1",attrs:{icon:"arrow_back_ios_new",size:9,"icon-font-size":"1rem",disabled:0===e.currentPage},on:{click:e.prevPage}}),e._v(" "),t("ui-icon-btn",{staticClass:"mx-1",attrs:{icon:"arrow_forward_ios",size:9,"icon-font-size":"1rem",disabled:e.currentPage>=e.numPages-1},on:{click:e.nextPage}})],1)]),e._v(" "),e.deletingSessions||e.loading?t("div",{staticClass:"absolute inset-0 w-full h-full flex items-center justify-center"},[t("ui-loading-indicator")],1):e._e()]):t("p",{staticClass:"text-white/50"},[e._v(e._s(e.$strings.MessageNoListeningSessions))]),e._v(" "),e.openListeningSessions.length?t("div",{staticClass:"w-full my-8 h-px bg-white/10"}):e._e(),e._v(" "),e.openListeningSessions.length?t("p",{staticClass:"text-lg my-4"},[e._v(e._s(e.$strings.HeaderOpenListeningSessions))]):e._e(),e._v(" "),e.openListeningSessions.length?t("div",{staticClass:"block max-w-full"},[t("table",{staticClass:"userSessionsTable"},[t("tr",{staticClass:"bg-primary/40"},[t("th",{staticClass:"w-48 min-w-48 text-left"},[e._v(e._s(e.$strings.LabelItem))]),e._v(" "),t("th",{staticClass:"w-20 min-w-20 text-left hidden md:table-cell"},[e._v(e._s(e.$strings.LabelUser))]),e._v(" "),t("th",{staticClass:"w-32 min-w-32 text-left hidden md:table-cell"},[e._v(e._s(e.$strings.LabelPlayMethod))]),e._v(" "),t("th",{staticClass:"w-32 min-w-32 text-left hidden sm:table-cell"},[e._v(e._s(e.$strings.LabelDeviceInfo))]),e._v(" "),t("th",{staticClass:"w-32 min-w-32"},[e._v(e._s(e.$strings.LabelTimeListened))]),e._v(" "),t("th",{staticClass:"w-16 min-w-16"},[e._v(e._s(e.$strings.LabelLastTime))]),e._v(" "),t("th",{staticClass:"grow hidden sm:table-cell"},[e._v(e._s(e.$strings.LabelLastUpdate))])]),e._v(" "),e._l(e.openListeningSessions,(function(n){return t("tr",{key:"open-".concat(n.id),staticClass:"cursor-pointer",on:{click:function(t){return e.showSession(n)}}},[t("td",{staticClass:"py-1 max-w-48"},[t("p",{staticClass:"text-xs text-gray-200 truncate"},[e._v(e._s(n.displayTitle))]),e._v(" "),t("p",{staticClass:"text-xs text-gray-400 truncate"},[e._v(e._s(n.displayAuthor))])]),e._v(" "),t("td",{staticClass:"hidden md:table-cell"},[t("p",{staticClass:"text-xs"},[e._v(e._s(n.user?n.user.username:"N/A"))])]),e._v(" "),t("td",{staticClass:"hidden md:table-cell"},[t("p",{staticClass:"text-xs"},[e._v(e._s(e.getPlayMethodName(n.playMethod)))])]),e._v(" "),t("td",{staticClass:"hidden sm:table-cell max-w-32 min-w-32"},[t("p",{staticClass:"text-xs truncate",domProps:{innerHTML:e._s(e.getDeviceInfoString(n.deviceInfo))}})]),e._v(" "),t("td",{staticClass:"text-center"},[t("p",{staticClass:"text-xs font-mono"},[e._v(e._s(e.$elapsedPretty(n.timeListening)))])]),e._v(" "),t("td",{staticClass:"text-center hover:underline",on:{click:function(t){return t.stopPropagation(),e.clickCurrentTime(n)}}},[t("p",{staticClass:"text-xs font-mono"},[e._v(e._s(e.$secondsToTimestamp(n.currentTime)))])]),e._v(" "),t("td",{staticClass:"text-center hidden sm:table-cell"},[n.updatedAt?t("ui-tooltip",{attrs:{direction:"top",text:e.$formatDatetime(n.updatedAt,e.dateFormat,e.timeFormat)}},[t("p",{staticClass:"text-xs text-gray-200"},[e._v(e._s(e.$dateDistanceFromNow(n.updatedAt)))])]):e._e()],1)])}))],2)]):e._e(),e._v(" "),e.openShareListeningSessions.length?t("div",{staticClass:"w-full my-8 h-px bg-white/10"}):e._e(),e._v(" "),e.openShareListeningSessions.length?t("p",{staticClass:"text-lg my-4"},[e._v("Open Share Listening Sessions")]):e._e(),e._v(" "),e.openShareListeningSessions.length?t("div",{staticClass:"block max-w-full"},[t("table",{staticClass:"userSessionsTable"},[t("tr",{staticClass:"bg-primary/40"},[t("th",{staticClass:"w-48 min-w-48 text-left"},[e._v(e._s(e.$strings.LabelItem))]),e._v(" "),t("th",{staticClass:"w-20 min-w-20 text-left hidden md:table-cell"},[e._v(e._s(e.$strings.LabelUser))]),e._v(" "),t("th",{staticClass:"w-32 min-w-32 text-left hidden md:table-cell"},[e._v(e._s(e.$strings.LabelPlayMethod))]),e._v(" "),t("th",{staticClass:"w-32 min-w-32 text-left hidden sm:table-cell"},[e._v(e._s(e.$strings.LabelDeviceInfo))]),e._v(" "),t("th",{staticClass:"w-16 min-w-16"},[e._v(e._s(e.$strings.LabelLastTime))]),e._v(" "),t("th",{staticClass:"grow hidden sm:table-cell"},[e._v(e._s(e.$strings.LabelLastUpdate))])]),e._v(" "),e._l(e.openShareListeningSessions,(function(n){return t("tr",{key:"open-".concat(n.id),staticClass:"cursor-pointer",on:{click:function(t){return e.showSession(n)}}},[t("td",{staticClass:"py-1 max-w-48"},[t("p",{staticClass:"text-xs text-gray-200 truncate"},[e._v(e._s(n.displayTitle))]),e._v(" "),t("p",{staticClass:"text-xs text-gray-400 truncate"},[e._v(e._s(n.displayAuthor))])]),e._v(" "),t("td",{staticClass:"hidden md:table-cell"}),e._v(" "),t("td",{staticClass:"hidden md:table-cell"},[t("p",{staticClass:"text-xs"},[e._v(e._s(e.getPlayMethodName(n.playMethod)))])]),e._v(" "),t("td",{staticClass:"hidden sm:table-cell max-w-32 min-w-32"},[t("p",{staticClass:"text-xs truncate",domProps:{innerHTML:e._s(e.getDeviceInfoString(n.deviceInfo))}})]),e._v(" "),t("td",{staticClass:"text-center hover:underline",on:{click:function(t){return t.stopPropagation(),e.clickCurrentTime(n)}}},[t("p",{staticClass:"text-xs font-mono"},[e._v(e._s(e.$secondsToTimestamp(n.currentTime)))])]),e._v(" "),t("td",{staticClass:"text-center hidden sm:table-cell"},[n.updatedAt?t("ui-tooltip",{attrs:{direction:"top",text:e.$formatDatetime(n.updatedAt,e.dateFormat,e.timeFormat)}},[t("p",{staticClass:"text-xs text-gray-200"},[e._v(e._s(e.$dateDistanceFromNow(n.updatedAt)))])]):e._e()],1)])}))],2)]):e._e()]),e._v(" "),t("modals-listening-session-modal",{attrs:{session:e.selectedSession},on:{removedSession:e.removedSession,closedSession:e.closedSession},model:{value:e.showSessionModal,callback:function(t){e.showSessionModal=t},expression:"showSessionModal"}})],1)}),[],!1,null,"8922a602",null);t.default=component.exports;installComponents(component,{UiDropdown:n(236).default,UiCheckbox:n(184).default,UiBtn:n(42).default,UiTooltip:n(76).default,UiIconBtn:n(148).default,UiLoadingIndicator:n(348).default,AppSettingsContent:n(652).default,ModalsListeningSessionModal:n(740).default})},646:function(e,t,n){var content=n(648);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(19).default)("6d988fa2",content,!0,{sourceMap:!1})},647:function(e,t,n){"use strict";n(646)},648:function(e,t,n){var r=n(18)((function(i){return i[1]}));r.push([e.i,"\n#settings-description a {\n  color: rgb(96 165 250);\n}\n#settings-description a:hover {\n  color: rgb(147 197 253);\n  text-decoration-line: underline;\n}\n#settings-description code {\n  font-size: 0.875rem;\n  border-radius: 6px;\n  background-color: rgb(82, 82, 82);\n  color: white;\n  padding: 2px 4px;\n}\n",""]),r.locals={},e.exports=r},652:function(e,t,n){"use strict";n.r(t);n(22),n(43);var r={props:{headerText:String,description:String,note:String},methods:{}},o=(n(647),n(4)),component=Object(o.a)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"bg-bg rounded-md shadow-lg border border-white/5 p-2 sm:p-4 mb-8"},[t("div",{staticClass:"flex items-center mb-2"},[e._t("header-prefix"),e._v(" "),t("h1",{staticClass:"text-xl"},[e._v(e._s(e.headerText))]),e._v(" "),e._t("header-items")],2),e._v(" "),e.description?t("p",{staticClass:"mb-6 text-gray-200",attrs:{id:"settings-description"},domProps:{innerHTML:e._s(e.description)}}):e._e(),e._v(" "),e._t("default")],2)}),[],!1,null,null,null);t.default=component.exports},740:function(e,t,n){"use strict";n.r(t);n(17),n(38),n(8);var r={props:{value:Boolean,session:{type:Object,default:function(){}}},data:function(){return{processing:!1}},computed:{show:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},_session:function(){return this.session||{}},username:function(){var e;return(null===(e=this._session.user)||void 0===e?void 0:e.username)||this._session.userId||""},deviceInfo:function(){return this._session.deviceInfo||{}},hasDeviceInfo:function(){return Object.keys(this.deviceInfo).length},osDisplayName:function(){return this.deviceInfo.osName?"".concat(this.deviceInfo.osName," ").concat(this.deviceInfo.osVersion):null},deviceDisplayName:function(){return this.deviceInfo.manufacturer&&this.deviceInfo.model?"".concat(this.deviceInfo.manufacturer," ").concat(this.deviceInfo.model):null},clientDisplayName:function(){return this.deviceInfo.clientName?"".concat(this.deviceInfo.clientName," ").concat(this.deviceInfo.clientVersion||""):null},playMethodName:function(){var e=this._session.playMethod;return e===this.$constants.PlayMethod.DIRECTPLAY?"Direct Play":e===this.$constants.PlayMethod.TRANSCODE?"Transcode":e===this.$constants.PlayMethod.DIRECTSTREAM?"Direct Stream":e===this.$constants.PlayMethod.LOCAL?"Local":"Unknown"},dateFormat:function(){return this.$store.getters.getServerSetting("dateFormat")},timeFormat:function(){return this.$store.getters.getServerSetting("timeFormat")},isOpenSession:function(){return!!this._session.open},isMediaItemShareSession:function(){return"web-share"===this._session.mediaPlayer}},methods:{deleteSessionClick:function(){var e=this,t={message:this.$strings.MessageConfirmDeleteSession,callback:function(t){t&&e.deleteSession()},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",t)},deleteSession:function(){var e=this;this.processing=!0,this.$axios.$delete("/api/sessions/".concat(this._session.id)).then((function(){e.processing=!1,e.$toast.success(e.$strings.ToastSessionDeleteSuccess),e.$emit("removedSession"),e.show=!1})).catch((function(t){e.processing=!1,console.error("Failed to delete session",t);var n=t.response&&t.response.data||"";e.$toast.error(n||e.$strings.ToastSessionDeleteFailed)}))},closeSessionClick:function(){var e=this;this.processing=!0,this.$axios.$post("/api/session/".concat(this._session.id,"/close")).then((function(){e.show=!1,e.$emit("closedSession")})).catch((function(t){var n;console.error("Failed to close session",t);var r=(null===(n=t.response)||void 0===n?void 0:n.data)||"";e.$toast.error(r||e.$strings.ToastSessionCloseFailed)})).finally((function(){e.processing=!1}))}},mounted:function(){}},o=n(4),component=Object(o.a)(r,(function(){var e=this,t=e._self._c;return t("modals-modal",{attrs:{name:"listening-session-modal",processing:e.processing,width:700,height:"unset"},scopedSlots:e._u([{key:"outer",fn:function(){return[t("div",{staticClass:"absolute top-0 left-0 p-5 w-2/3 overflow-hidden"},[t("p",{staticClass:"text-lg md:text-2xl text-white truncate"},[e._v(e._s(e.$strings.HeaderSession)+" "+e._s(e._session.id))])])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v(" "),t("div",{ref:"container",staticClass:"w-full rounded-lg bg-bg box-shadow-md overflow-y-auto overflow-x-hidden p-6",staticStyle:{"max-height":"80vh"}},[t("div",{staticClass:"flex items-center"},[t("p",{staticClass:"text-base text-gray-200"},[e._v(e._s(e._session.displayTitle))]),e._v(" "),e._session.displayAuthor?t("p",{staticClass:"text-xs text-gray-400 px-4"},[e._v(e._s(e.$getString("LabelByAuthor",[e._session.displayAuthor])))]):e._e()]),e._v(" "),t("div",{staticClass:"w-full h-px bg-white/10 my-4"}),e._v(" "),t("div",{staticClass:"flex flex-wrap mb-4"},[t("div",{staticClass:"w-full md:w-2/3"},[t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mb-2"},[e._v(e._s(e.$strings.HeaderDetails))]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelStartedAt))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$formatDatetime(e._session.startedAt,e.dateFormat,e.timeFormat))+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelUpdatedAt))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$formatDatetime(e._session.updatedAt,e.dateFormat,e.timeFormat))+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelTimeListened))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$elapsedPrettyExtended(e._session.timeListening))+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelStartTime))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$secondsToTimestamp(e._session.startTime))+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelLastTime))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$secondsToTimestamp(e._session.currentTime))+"\n          ")])]),e._v(" "),t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mt-6 mb-2"},[e._v(e._s(e.$strings.LabelItem))]),e._v(" "),e._session.libraryId?t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelLibrary)+" Id")]),e._v(" "),t("div",{staticClass:"px-1 text-xs"},[e._v("\n            "+e._s(e._session.libraryId)+"\n          ")])]):e._e(),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelLibraryItem)+" Id")]),e._v(" "),t("div",{staticClass:"px-1 text-xs"},[e._v("\n            "+e._s(e._session.libraryItemId)+"\n          ")])]),e._v(" "),e._session.episodeId?t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelEpisode)+" Id")]),e._v(" "),t("div",{staticClass:"px-1 text-xs"},[e._v("\n            "+e._s(e._session.episodeId)+"\n          ")])]):e._e(),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelMediaType))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e._session.mediaType)+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelDuration))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$elapsedPretty(e._session.duration))+"\n          ")])])]),e._v(" "),t("div",{staticClass:"w-full md:w-1/3"},[e.isMediaItemShareSession?e._e():t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mb-2 mt-6 md:mt-0"},[e._v(e._s(e.$strings.LabelUser))]),e._v(" "),e.isMediaItemShareSession?e._e():t("p",{staticClass:"mb-1 text-xs"},[e._v(e._s(e.username))]),e._v(" "),t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mt-6 mb-2"},[e._v(e._s(e.$strings.LabelMediaPlayer))]),e._v(" "),t("p",{staticClass:"mb-1"},[e._v(e._s(e.playMethodName))]),e._v(" "),t("p",{staticClass:"mb-1"},[e._v(e._s(e._session.mediaPlayer))]),e._v(" "),e.hasDeviceInfo?t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mt-6 mb-2"},[e._v(e._s(e.$strings.LabelDevice))]):e._e(),e._v(" "),e.clientDisplayName?t("p",{staticClass:"mb-1"},[e._v(e._s(e.clientDisplayName))]):e._e(),e._v(" "),e.deviceInfo.ipAddress?t("p",{staticClass:"mb-1"},[e._v(e._s(e.deviceInfo.ipAddress))]):e._e(),e._v(" "),e.osDisplayName?t("p",{staticClass:"mb-1"},[e._v(e._s(e.osDisplayName))]):e._e(),e._v(" "),e.deviceInfo.browserName?t("p",{staticClass:"mb-1"},[e._v(e._s(e.deviceInfo.browserName))]):e._e(),e._v(" "),e.deviceDisplayName?t("p",{staticClass:"mb-1"},[e._v(e._s(e.deviceDisplayName))]):e._e(),e._v(" "),e.deviceInfo.sdkVersion?t("p",{staticClass:"mb-1"},[e._v("SDK "+e._s(e.$strings.LabelVersion)+": "+e._s(e.deviceInfo.sdkVersion))]):e._e(),e._v(" "),e.deviceInfo.deviceType?t("p",{staticClass:"mb-1"},[e._v(e._s(e.$strings.LabelType)+": "+e._s(e.deviceInfo.deviceType))]):e._e()])]),e._v(" "),t("div",{staticClass:"flex items-center"},[e.isOpenSession||e.isMediaItemShareSession?e.isMediaItemShareSession?e._e():t("ui-btn",{attrs:{small:"",color:"bg-error"},on:{click:function(t){return t.stopPropagation(),e.closeSessionClick.apply(null,arguments)}}},[e._v(e._s(e.$strings.ButtonCloseSession))]):t("ui-btn",{attrs:{small:"",color:"bg-error"},on:{click:function(t){return t.stopPropagation(),e.deleteSessionClick.apply(null,arguments)}}},[e._v(e._s(e.$strings.ButtonDelete))])],1)])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiBtn:n(42).default,ModalsModal:n(39).default})},799:function(e,t,n){var content=n(906);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(19).default)("27d50ed4",content,!0,{sourceMap:!1})},905:function(e,t,n){"use strict";n(799)},906:function(e,t,n){var r=n(18)((function(i){return i[1]}));r.push([e.i,"\n.userSessionsTable[data-v-8922a602] {\n  border-collapse: collapse;\n  width: 100%;\n  max-width: 100%;\n  border: 1px solid #474747;\n}\n.userSessionsTable tr[data-v-8922a602]:first-child {\n  background-color: #272727;\n}\n.userSessionsTable tr[data-v-8922a602]:not(:first-child):not(.selected) {\n  background-color: #373838;\n}\n.userSessionsTable tr[data-v-8922a602]:not(:first-child):nth-child(odd):not(.selected):not(:hover) {\n  background-color: #2f2f2f;\n}\n.userSessionsTable tr[data-v-8922a602]:hover:not(:first-child) {\n  background-color: #474747;\n}\n.userSessionsTable tr.selected[data-v-8922a602] {\n  background-color: #474747;\n}\n.userSessionsTable td[data-v-8922a602] {\n  padding: 4px 8px;\n}\n.userSessionsTable th[data-v-8922a602] {\n  padding: 4px 8px;\n  font-size: 0.75rem;\n}\n",""]),r.locals={},e.exports=r}}]);