(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{842:function(t,n,e){"use strict";e.r(n);e(56),e(8),e(40);var o={props:{notification:{type:Object,default:function(){}}},data:function(){return{sendingTest:!1,enabling:!1,deleting:!1,testing:!1}},computed:{eventName:function(){return this.notification?this.notification.eventName:null},lastFiredAt:function(){return this.notification?this.notification.lastFiredAt:null},lastAttemptFailed:function(){return this.notification?this.notification.lastAttemptFailed:null},numConsecutiveFailedAttempts:function(){return this.notification?this.notification.numConsecutiveFailedAttempts:null}},methods:{fireTestEventAndFail:function(){this.fireTestEvent(!0)},fireTestEventAndSucceed:function(){this.fireTestEvent(!1)},fireTestEvent:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.testing=!0,this.$axios.$get("/api/notifications/test?fail=".concat(n?1:0)).then((function(){t.$toast.success(t.$strings.ToastNotificationTestTriggerSuccess)})).catch((function(n){console.error("Failed",n);var e=n.response?n.response.data:null;t.$toast.error("Failed: ".concat(e)||!1)})).finally((function(){t.testing=!1}))},rapidFireTestEvents:function(){var t=this;this.testing=!0;var n=0,e=setInterval((function(){t.fireTestEvent(),++n>25&&(t.testing=!1,clearInterval(e))}),100)},sendTestClick:function(){var t=this,n={message:this.$strings.MessageConfirmNotificationTestTrigger,callback:function(n){n&&t.sendTest()},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",n)},sendTest:function(){var t=this;this.sendingTest=!0,this.$axios.$get("/api/notifications/".concat(this.notification.id,"/test")).then((function(){t.$toast.success(t.$strings.ToastNotificationTestTriggerSuccess)})).catch((function(n){console.error("Failed",n);var e=n.response?n.response.data:null;t.$toast.error("Failed: ".concat(e)||!1)})).finally((function(){t.sendingTest=!1}))},enableNotification:function(){var t=this;this.enabling=!0;var n={id:this.notification.id,enabled:!0};this.$axios.$patch("/api/notifications/".concat(this.notification.id),n).then((function(n){t.$emit("update",n)})).catch((function(n){console.error("Failed to update notification",n),t.$toast.error(t.$strings.ToastFailedToUpdate)})).finally((function(){t.enabling=!1}))},deleteNotificationClick:function(){var t=this,n={message:this.$strings.MessageConfirmDeleteNotification,callback:function(n){n&&t.deleteNotification()},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",n)},deleteNotification:function(){var t=this;this.deleting=!0,this.$axios.$delete("/api/notifications/".concat(this.notification.id)).then((function(n){t.$emit("update",n)})).catch((function(n){console.error("Failed",n),t.$toast.error(t.$strings.ToastNotificationDeleteFailed)})).finally((function(){t.deleting=!1}))},editNotification:function(){this.$emit("edit",this.notification)}},mounted:function(){}},c=o,l=e(4),component=Object(l.a)(c,(function(){var t=this,n=t._self._c;return n("div",{staticClass:"w-full border border-white/10 rounded-xl p-4 my-2",class:t.notification.enabled?"bg-primary/25":"bg-error/5"},[n("div",{staticClass:"flex flex-wrap items-center"},[n("p",{staticClass:"text-base md:text-lg font-semibold pr-4"},[t._v(t._s(t.eventName))]),t._v(" "),n("div",{staticClass:"grow"}),t._v(" "),"onTest"===t.eventName&&t.notification.enabled?n("ui-btn",{staticClass:"mr-2",attrs:{loading:t.testing,small:""},on:{click:function(n){return n.stopPropagation(),t.fireTestEventAndSucceed.apply(null,arguments)}}},[t._v(t._s(this.$strings.ButtonFireOnTest))]):t._e(),t._v(" "),"onTest"===t.eventName&&t.notification.enabled?n("ui-btn",{staticClass:"mr-2",attrs:{loading:t.testing,small:"",color:"bg-red-600"},on:{click:function(n){return n.stopPropagation(),t.fireTestEventAndFail.apply(null,arguments)}}},[t._v(t._s(this.$strings.ButtonFireAndFail))]):t.notification.enabled?n("ui-btn",{staticClass:"mr-2",attrs:{loading:t.sendingTest,small:""},on:{click:function(n){return n.stopPropagation(),t.sendTestClick.apply(null,arguments)}}},[t._v(t._s(this.$strings.ButtonTest))]):n("ui-btn",{staticClass:"mr-2",attrs:{loading:t.enabling,small:"",color:"bg-success"},on:{click:t.enableNotification}},[t._v(t._s(this.$strings.ButtonEnable))]),t._v(" "),n("ui-icon-btn",{staticClass:"mr-2",attrs:{size:7,"icon-font-size":"1.1rem",icon:"edit"},on:{click:t.editNotification}}),t._v(" "),n("ui-icon-btn",{attrs:{"bg-color":"bg-error",size:7,"icon-font-size":"1.2rem",icon:"delete"},on:{click:t.deleteNotificationClick}})],1),t._v(" "),n("div",{staticClass:"pt-4"},[n("p",{staticClass:"text-gray-300 text-xs md:text-sm mb-2"},[t._v(t._s(t.notification.urls.join(", ")))]),t._v(" "),t.lastFiredAt&&t.lastAttemptFailed?n("p",{staticClass:"text-red-300 text-xs"},[t._v("Last attempt failed "+t._s(t.$dateDistanceFromNow(t.lastFiredAt))+" ("+t._s(t.numConsecutiveFailedAttempts)+" attempt"+t._s(1===t.numConsecutiveFailedAttempts?"":"s")+")")]):t.lastFiredAt?n("p",{staticClass:"text-gray-400 text-xs"},[t._v("Last fired "+t._s(t.$dateDistanceFromNow(t.lastFiredAt)))]):t._e()])])}),[],!1,null,null,null);n.default=component.exports;installComponents(component,{UiBtn:e(42).default,UiIconBtn:e(148).default})}}]);