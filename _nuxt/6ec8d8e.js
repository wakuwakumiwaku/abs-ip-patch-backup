(window.webpackJsonp=window.webpackJsonp||[]).push([[175],{1058:function(e,t,n){"use strict";n.r(t);n(26),n(33),n(27),n(150),n(8),n(147);var r={asyncData:function(e){var t=e.store,n=e.redirect;t.getters["user/getIsAdminOrUp"]||n("/")},data:function(){return{loading:!1,genres:[],editingGenre:null,newGenreName:""}},watch:{},computed:{},methods:{cancelEditClick:function(){this.newGenreName="",this.editingGenre=null},removeClick:function(e){var t=this,n={message:'Are you sure you want to remove genre "'.concat(e,'" from all items?'),callback:function(n){n&&t.removeGenre(e)},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",n)},editClick:function(e){this.newGenreName=e,this.editingGenre=e},saveClick:function(){var e=this;if(this.newGenreName=this.newGenreName.trim(),this.newGenreName)if(this.editingGenre!==this.newGenreName){var t=this.genres.find((function(g){return g!==e.editingGenre&&g===e.newGenreName})),n=t?null:this.genres.find((function(g){return g!==e.editingGenre&&g.toLowerCase()===e.newGenreName.toLowerCase()})),r=this.$getString("MessageConfirmRenameGenre",[this.editingGenre,this.newGenreName]);t?r+='<br><span class="text-sm">'.concat(this.$strings.MessageConfirmRenameGenreMergeNote,"</span>"):n&&(r+='<br><span class="text-warning text-sm">'.concat(this.$getString("MessageConfirmRenameGenreWarning",[n]),"</span>"));var o={message:r,callback:function(t){t&&e.renameGenre()},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",o)}else this.cancelEditClick()},renameGenre:function(){var e=this;this.loading=!0;var t=this.newGenreName,n=this.editingGenre,r={genre:n,newGenre:t};this.$axios.$post("/api/genres/rename",r).then((function(r){e.$toast.success(e.$getString("MessageItemsUpdated",[r.numItemsUpdated])),r.genreMerged&&(e.genres=e.genres.filter((function(g){return g!==t}))),e.genres=e.genres.map((function(g){return g===n?t:g})),e.cancelEditClick()})).catch((function(t){console.error("Failed to rename genre",t),e.$toast.error(e.$strings.ToastRenameFailed)})).finally((function(){e.loading=!1}))},removeGenre:function(e){var t=this;this.loading=!0,this.$axios.$delete("/api/genres/".concat(this.$encode(e))).then((function(n){t.$toast.success(t.$getString("MessageItemsUpdated",[n.numItemsUpdated])),t.genres=t.genres.filter((function(g){return g!==e}))})).catch((function(e){console.error("Failed to remove genre",e),t.$toast.error(t.$strings.ToastRemoveFailed)})).finally((function(){t.loading=!1}))},init:function(){var e=this;this.loading=!0,this.$axios.$get("/api/genres").then((function(data){e.genres=(data.genres||[]).sort((function(a,b){return a.localeCompare(b,void 0,{sensitivity:"base"})}))})).catch((function(e){console.error("Failed to load genres",e)})).finally((function(){e.loading=!1}))}},mounted:function(){this.init()},beforeDestroy:function(){}},o=n(4),component=Object(o.a)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"bg-bg rounded-md shadow-lg border border-white/5 p-4 mb-8 relative",staticStyle:{"min-height":"200px"}},[t("div",{staticClass:"flex items-center mb-4"},[t("nuxt-link",{staticClass:"w-8 h-8 flex items-center justify-center rounded-full cursor-pointer hover:bg-white/10 text-center",attrs:{to:"/config/item-metadata-utils"}},[t("span",{staticClass:"material-symbols text-2xl"},[e._v("arrow_back")])]),e._v(" "),t("h1",{staticClass:"text-xl mx-2"},[e._v(e._s(e.$strings.HeaderManageGenres))])],1),e._v(" "),e.genres.length||e.loading?e._e():t("p",{staticClass:"text-center py-8 text-lg"},[e._v(e._s(e.$strings.MessageNoGenres))]),e._v(" "),t("div",{staticClass:"border border-white/10"},[e._l(e.genres,(function(n,r){return[t("div",{key:n,staticClass:"w-full p-2 flex items-center text-gray-400 hover:text-white",class:{"bg-primary/20":r%2==0}},[e.editingGenre!==n?t("p",{staticClass:"text-sm md:text-base text-gray-100"},[e._v(e._s(n))]):t("ui-text-input",{model:{value:e.newGenreName,callback:function(t){e.newGenreName=t},expression:"newGenreName"}}),e._v(" "),t("div",{staticClass:"grow"}),e._v(" "),e.editingGenre!==n?[e.editingGenre!==n?t("ui-icon-btn",{staticClass:"mx-1",attrs:{icon:"edit",borderless:"",size:8,"icon-font-size":"1.1rem"},on:{click:function(t){return e.editClick(n)}}}):e._e(),e._v(" "),e.editingGenre!==n?t("ui-icon-btn",{attrs:{icon:"delete",borderless:"",size:8,"icon-font-size":"1.1rem"},on:{click:function(t){return e.removeClick(n)}}}):e._e()]:[t("ui-btn",{staticClass:"mx-2",attrs:{color:"bg-success",small:""},on:{click:function(t){return t.stopPropagation(),e.saveClick.apply(null,arguments)}}},[e._v(e._s(e.$strings.ButtonSave))]),e._v(" "),t("ui-btn",{attrs:{small:""},on:{click:function(t){return t.stopPropagation(),e.cancelEditClick.apply(null,arguments)}}},[e._v(e._s(e.$strings.ButtonCancel))])]],2)]}))],2),e._v(" "),e.loading?t("div",{staticClass:"absolute top-0 left-0 w-full h-full bg-black/25 rounded-md"},[t("div",{staticClass:"sticky top-0 left-0 w-full h-full flex items-center justify-center",staticStyle:{"max-height":"80vh"}},[t("ui-loading-indicator")],1)]):e._e()])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiTextInput:n(68).default,UiIconBtn:n(148).default,UiBtn:n(42).default,UiLoadingIndicator:n(348).default})}}]);