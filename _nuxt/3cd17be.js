(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{740:function(e,t,n){"use strict";n.r(t);n(17),n(38),n(8);var o={props:{value:Boolean,session:{type:Object,default:function(){}}},data:function(){return{processing:!1}},computed:{show:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},_session:function(){return this.session||{}},username:function(){var e;return(null===(e=this._session.user)||void 0===e?void 0:e.username)||this._session.userId||""},deviceInfo:function(){return this._session.deviceInfo||{}},hasDeviceInfo:function(){return Object.keys(this.deviceInfo).length},osDisplayName:function(){return this.deviceInfo.osName?"".concat(this.deviceInfo.osName," ").concat(this.deviceInfo.osVersion):null},deviceDisplayName:function(){return this.deviceInfo.manufacturer&&this.deviceInfo.model?"".concat(this.deviceInfo.manufacturer," ").concat(this.deviceInfo.model):null},clientDisplayName:function(){return this.deviceInfo.clientName?"".concat(this.deviceInfo.clientName," ").concat(this.deviceInfo.clientVersion||""):null},playMethodName:function(){var e=this._session.playMethod;return e===this.$constants.PlayMethod.DIRECTPLAY?"Direct Play":e===this.$constants.PlayMethod.TRANSCODE?"Transcode":e===this.$constants.PlayMethod.DIRECTSTREAM?"Direct Stream":e===this.$constants.PlayMethod.LOCAL?"Local":"Unknown"},dateFormat:function(){return this.$store.getters.getServerSetting("dateFormat")},timeFormat:function(){return this.$store.getters.getServerSetting("timeFormat")},isOpenSession:function(){return!!this._session.open},isMediaItemShareSession:function(){return"web-share"===this._session.mediaPlayer}},methods:{deleteSessionClick:function(){var e=this,t={message:this.$strings.MessageConfirmDeleteSession,callback:function(t){t&&e.deleteSession()},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",t)},deleteSession:function(){var e=this;this.processing=!0,this.$axios.$delete("/api/sessions/".concat(this._session.id)).then((function(){e.processing=!1,e.$toast.success(e.$strings.ToastSessionDeleteSuccess),e.$emit("removedSession"),e.show=!1})).catch((function(t){e.processing=!1,console.error("Failed to delete session",t);var n=t.response&&t.response.data||"";e.$toast.error(n||e.$strings.ToastSessionDeleteFailed)}))},closeSessionClick:function(){var e=this;this.processing=!0,this.$axios.$post("/api/session/".concat(this._session.id,"/close")).then((function(){e.show=!1,e.$emit("closedSession")})).catch((function(t){var n;console.error("Failed to close session",t);var o=(null===(n=t.response)||void 0===n?void 0:n.data)||"";e.$toast.error(o||e.$strings.ToastSessionCloseFailed)})).finally((function(){e.processing=!1}))}},mounted:function(){}},r=n(4),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("modals-modal",{attrs:{name:"listening-session-modal",processing:e.processing,width:700,height:"unset"},scopedSlots:e._u([{key:"outer",fn:function(){return[t("div",{staticClass:"absolute top-0 left-0 p-5 w-2/3 overflow-hidden"},[t("p",{staticClass:"text-lg md:text-2xl text-white truncate"},[e._v(e._s(e.$strings.HeaderSession)+" "+e._s(e._session.id))])])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v(" "),t("div",{ref:"container",staticClass:"w-full rounded-lg bg-bg box-shadow-md overflow-y-auto overflow-x-hidden p-6",staticStyle:{"max-height":"80vh"}},[t("div",{staticClass:"flex items-center"},[t("p",{staticClass:"text-base text-gray-200"},[e._v(e._s(e._session.displayTitle))]),e._v(" "),e._session.displayAuthor?t("p",{staticClass:"text-xs text-gray-400 px-4"},[e._v(e._s(e.$getString("LabelByAuthor",[e._session.displayAuthor])))]):e._e()]),e._v(" "),t("div",{staticClass:"w-full h-px bg-white/10 my-4"}),e._v(" "),t("div",{staticClass:"flex flex-wrap mb-4"},[t("div",{staticClass:"w-full md:w-2/3"},[t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mb-2"},[e._v(e._s(e.$strings.HeaderDetails))]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelStartedAt))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$formatDatetime(e._session.startedAt,e.dateFormat,e.timeFormat))+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelUpdatedAt))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$formatDatetime(e._session.updatedAt,e.dateFormat,e.timeFormat))+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelTimeListened))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$elapsedPrettyExtended(e._session.timeListening))+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelStartTime))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$secondsToTimestamp(e._session.startTime))+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelLastTime))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$secondsToTimestamp(e._session.currentTime))+"\n          ")])]),e._v(" "),t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mt-6 mb-2"},[e._v(e._s(e.$strings.LabelItem))]),e._v(" "),e._session.libraryId?t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelLibrary)+" Id")]),e._v(" "),t("div",{staticClass:"px-1 text-xs"},[e._v("\n            "+e._s(e._session.libraryId)+"\n          ")])]):e._e(),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelLibraryItem)+" Id")]),e._v(" "),t("div",{staticClass:"px-1 text-xs"},[e._v("\n            "+e._s(e._session.libraryItemId)+"\n          ")])]),e._v(" "),e._session.episodeId?t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelEpisode)+" Id")]),e._v(" "),t("div",{staticClass:"px-1 text-xs"},[e._v("\n            "+e._s(e._session.episodeId)+"\n          ")])]):e._e(),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelMediaType))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e._session.mediaType)+"\n          ")])]),e._v(" "),t("div",{staticClass:"flex items-center -mx-1 mb-1"},[t("div",{staticClass:"w-40 px-1 text-gray-200"},[e._v(e._s(e.$strings.LabelDuration))]),e._v(" "),t("div",{staticClass:"px-1"},[e._v("\n            "+e._s(e.$elapsedPretty(e._session.duration))+"\n          ")])])]),e._v(" "),t("div",{staticClass:"w-full md:w-1/3"},[e.isMediaItemShareSession?e._e():t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mb-2 mt-6 md:mt-0"},[e._v(e._s(e.$strings.LabelUser))]),e._v(" "),e.isMediaItemShareSession?e._e():t("p",{staticClass:"mb-1 text-xs"},[e._v(e._s(e.username))]),e._v(" "),t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mt-6 mb-2"},[e._v(e._s(e.$strings.LabelMediaPlayer))]),e._v(" "),t("p",{staticClass:"mb-1"},[e._v(e._s(e.playMethodName))]),e._v(" "),t("p",{staticClass:"mb-1"},[e._v(e._s(e._session.mediaPlayer))]),e._v(" "),e.hasDeviceInfo?t("p",{staticClass:"font-semibold uppercase text-xs text-gray-400 tracking-wide mt-6 mb-2"},[e._v(e._s(e.$strings.LabelDevice))]):e._e(),e._v(" "),e.clientDisplayName?t("p",{staticClass:"mb-1"},[e._v(e._s(e.clientDisplayName))]):e._e(),e._v(" "),e.deviceInfo.ipAddress?t("p",{staticClass:"mb-1"},[e._v(e._s(e.deviceInfo.ipAddress))]):e._e(),e._v(" "),e.osDisplayName?t("p",{staticClass:"mb-1"},[e._v(e._s(e.osDisplayName))]):e._e(),e._v(" "),e.deviceInfo.browserName?t("p",{staticClass:"mb-1"},[e._v(e._s(e.deviceInfo.browserName))]):e._e(),e._v(" "),e.deviceDisplayName?t("p",{staticClass:"mb-1"},[e._v(e._s(e.deviceDisplayName))]):e._e(),e._v(" "),e.deviceInfo.sdkVersion?t("p",{staticClass:"mb-1"},[e._v("SDK "+e._s(e.$strings.LabelVersion)+": "+e._s(e.deviceInfo.sdkVersion))]):e._e(),e._v(" "),e.deviceInfo.deviceType?t("p",{staticClass:"mb-1"},[e._v(e._s(e.$strings.LabelType)+": "+e._s(e.deviceInfo.deviceType))]):e._e()])]),e._v(" "),t("div",{staticClass:"flex items-center"},[e.isOpenSession||e.isMediaItemShareSession?e.isMediaItemShareSession?e._e():t("ui-btn",{attrs:{small:"",color:"bg-error"},on:{click:function(t){return t.stopPropagation(),e.closeSessionClick.apply(null,arguments)}}},[e._v(e._s(e.$strings.ButtonCloseSession))]):t("ui-btn",{attrs:{small:"",color:"bg-error"},on:{click:function(t){return t.stopPropagation(),e.deleteSessionClick.apply(null,arguments)}}},[e._v(e._s(e.$strings.ButtonDelete))])],1)])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiBtn:n(42).default,ModalsModal:n(39).default})}}]);