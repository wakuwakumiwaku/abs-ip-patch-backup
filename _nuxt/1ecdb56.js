(window.webpackJsonp=window.webpackJsonp||[]).push([[131,79,130],{708:function(t,e,r){"use strict";r.r(e);var n={props:{value:Boolean,title:String,items:{type:Array,default:function(){return[]}},selected:String},data:function(){return{}},computed:{show:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{clickedOption:function(t){this.$emit("action",{action:t})}},mounted:function(){}},o=r(4),component=Object(o.a)(n,(function(){var t=this,e=t._self._c;return e("modals-modal",{attrs:{width:300,height:"100%"},scopedSlots:t._u([{key:"outer",fn:function(){return[t.title?e("div",{staticClass:"absolute top-7 left-4 z-40",staticStyle:{"max-width":"80%"}},[e("p",{staticClass:"text-white text-lg truncate"},[t._v(t._s(t.title))])]):t._e()]},proxy:!0}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t._v(" "),e("div",{staticClass:"w-full h-full overflow-hidden absolute top-0 left-0 flex items-center justify-center",on:{click:function(e){t.show=!1}}},[e("div",{ref:"container",staticClass:"w-full overflow-x-hidden overflow-y-auto bg-primary rounded-lg border border-white/20",staticStyle:{"max-height":"75%"},on:{click:function(t){t.stopPropagation()}}},[e("ul",{staticClass:"h-full w-full",attrs:{role:"listbox","aria-labelledby":"listbox-label"}},[t._l(t.items,(function(r){return[e("li",{key:r.value,staticClass:"text-gray-50 select-none relative py-4 cursor-pointer hover:bg-black-400",class:t.selected===r.value?"bg-success/10":"",attrs:{role:"option"},on:{click:function(e){return t.clickedOption(r.value)}}},[e("div",{staticClass:"relative flex items-center px-3"},[e("p",{staticClass:"font-normal block truncate text-base text-white/80"},[t._v(t._s(r.text))])])])]}))],2)])])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{ModalsModal:r(39).default})},739:function(t,e,r){"use strict";r.r(e);r(15),r(8),r(35),r(361);var n={props:{library:{type:Object,default:function(){}},selected:Boolean,dragging:Boolean},data:function(){return{mouseover:!1,isDeleting:!1,showMobileMenu:!1}},computed:{isHovering:function(){return this.mouseover&&!this.dragging},isScanning:function(){return!!this.$store.getters["tasks/getRunningLibraryScanTask"](this.library.id)},mediaType:function(){return this.library.mediaType},isBookLibrary:function(){return"book"===this.mediaType},menuTitle:function(){return this.library.name},contextMenuItems:function(){var t=[{text:this.$strings.ButtonEdit,action:"edit",value:"edit"},{text:this.$strings.ButtonScan,action:"scan",value:"scan"}];return this.isBookLibrary&&t.push({text:this.$strings.ButtonMatchBooks,action:"match-books",value:"match-books"}),t.push({text:this.$strings.ButtonDelete,action:"delete",value:"delete"}),t}},methods:{scanBtnClick:function(){this.scan()},contextMenuAction:function(t){var e=t.action;this.showMobileMenu=!1,"edit"===e?this.editClick():"scan"===e?this.scan():"force-rescan"===e?this.scan(!0):"match-books"===e?this.matchAll():"delete"===e&&this.deleteClick()},showMenu:function(){this.showMobileMenu=!0},matchAll:function(){var t=this;this.$axios.$get("/api/libraries/".concat(this.library.id,"/matchall")).then((function(){console.log("Starting scan for matches")})).catch((function(e){console.error("Failed",e);var r=err.response?err.response.data:"";t.$toast.error(r||"Match all failed")}))},editClick:function(){this.$emit("edit",this.library)},scan:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$store.dispatch("libraries/requestLibraryScan",{libraryId:this.library.id,force:e}).then((function(){})).catch((function(e){console.error("Failed to start scan",e),t.$toast.error(t.$strings.ToastLibraryScanFailedToStart)}))},deleteClick:function(){var t=this,e={message:this.$getString("MessageConfirmDeleteLibrary",[this.library.name]),callback:function(e){e&&(t.isDeleting=!0,t.$axios.$delete("/api/libraries/".concat(t.library.id)).then((function(data){data.error?t.$toast.error(data.error):t.$toast.success(t.$strings.ToastLibraryDeleteSuccess)})).catch((function(e){console.error("Failed to delete library",e),t.$toast.error(t.$strings.ToastLibraryDeleteFailed)})).finally((function(){t.isDeleting=!1})))},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",e)}},mounted:function(){}},o=n,l=r(4),component=Object(l.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full pl-2 pr-4 md:px-4 h-12 border border-white/10 flex items-center relative -mt-px",class:t.selected?"bg-primary/50":"hover:bg-primary/25",on:{mouseover:function(e){t.mouseover=!0},mouseleave:function(e){t.mouseover=!1}}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"selected"}],staticClass:"absolute top-0 left-0 h-full w-0.5 bg-warning z-10"}),t._v(" "),t.isScanning?e("svg",{staticClass:"h-6 w-6 text-white/50 animate-spin",attrs:{viewBox:"0 0 24 24"}},[e("path",{attrs:{fill:"currentColor",d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"}})]):e("ui-library-icon",{class:t.isHovering?"text-white/90":"text-white/50",attrs:{icon:t.library.icon,size:6,"font-size":"text-lg md:text-xl"}}),t._v(" "),e("p",{staticClass:"text-base md:text-xl pl-2 md:pl-4 hover:underline cursor-pointer",on:{click:function(e){return e.stopPropagation(),t.$emit("click",t.library)}}},[t._v(t._s(t.library.name))]),t._v(" "),e("div",{staticClass:"grow"}),t._v(" "),t.isScanning||t.isDeleting?t._e():e("ui-btn",{staticClass:"hidden md:block mx-2 text-xs",attrs:{color:"bg-bg","padding-y":1,"padding-x":3},on:{click:function(e){return e.stopPropagation(),t.scanBtnClick.apply(null,arguments)}}},[t._v(t._s(this.$strings.ButtonScan))]),t._v(" "),t.isScanning||t.isDeleting?t._e():e("ui-context-menu-dropdown",{staticClass:"hidden! md:block!",attrs:{items:t.contextMenuItems,"icon-class":"text-1.5xl text-gray-".concat(t.isHovering?50:400)},on:{action:t.contextMenuAction}}),t._v(" "),t.isScanning||t.isDeleting?t._e():e("span",{staticClass:"block! md:hidden! material-symbols text-xl text-gray-300 ml-3 cursor-pointer",on:{click:function(e){return e.stopPropagation(),t.showMenu.apply(null,arguments)}}},[t._v("more_vert")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isDeleting,expression:"isDeleting"}],staticClass:"text-xl text-gray-300 ml-3 animate-spin"},[e("svg",{staticClass:"w-6 h-6",attrs:{viewBox:"0 0 24 24"}},[e("path",{attrs:{fill:"currentColor",d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"}})])]),t._v(" "),e("span",{staticClass:"material-symbols drag-handle text-xl text-gray-400 hover:text-gray-50 ml-2 md:ml-4"},[t._v("reorder")]),t._v(" "),e("modals-dialog",{attrs:{title:t.menuTitle,items:t.contextMenuItems},on:{action:t.contextMenuAction},model:{value:t.showMobileMenu,callback:function(e){t.showMobileMenu=e},expression:"showMobileMenu"}})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{UiLibraryIcon:r(358).default,UiBtn:r(42).default,UiContextMenuDropdown:r(349).default,ModalsDialog:r(708).default})},840:function(t,e,r){"use strict";r.r(e);r(8);var n=r(16),o=r(7),l=(r(29),r(22),r(26),r(56),r(27),r(44),r(45),r(38),r(28),r(40),r(690));function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var d={components:{draggable:r.n(l).a},data:function(){return{libraryCopies:[],currentOrder:[],drag:!1,dragOptions:{animation:200,group:"description",ghostClass:"ghost"},orderTimeout:null}},computed:{currentLibrary:function(){return this.$store.getters["libraries/getCurrentLibrary"]},currentLibraryId:function(){var t;return(null===(t=this.currentLibrary)||void 0===t?void 0:t.id)||null},libraries:function(){return this.$store.getters["libraries/getSortedLibraries"]()}},methods:{startDrag:function(){this.drag=!0,clearTimeout(this.orderTimeout)},endDrag:function(t){this.drag=!1,this.checkOrder()},checkOrder:function(){var t=this;clearTimeout(this.orderTimeout),this.orderTimeout=setTimeout((function(){t.saveOrder()}),500)},saveOrder:function(){var t=this,e=1,r=this.libraries.map((function(t){return t.id})).join(","),n=this.libraryCopies.map((function(t){return{newOrder:e++,oldOrder:t.displayOrder,id:t.id}}));r!==n.map((function(t){return t.id})).join(",")&&this.$axios.$post("/api/libraries/order",n).then((function(e){var r;null!==(r=e.libraries)&&void 0!==r&&r.length&&t.$store.commit("libraries/set",e.libraries)}))},setLibrary:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$store.dispatch("libraries/fetch",t.id);case 2:e.$router.push("/library/".concat(t.id));case 3:case"end":return r.stop()}}),r)})))()},clickAddLibrary:function(){this.$emit("showLibraryModal",null)},editLibrary:function(t){this.$emit("showLibraryModal",t)},init:function(){this.libraryCopies=this.libraries.map((function(t){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){Object(n.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t)}))},librariesUpdated:function(){this.init()}},mounted:function(){this.$store.commit("libraries/addListener",{id:"libraries-table",meth:this.librariesUpdated}),this.init()},beforeDestroy:function(){this.$store.commit("libraries/removeListener","libraries-table")}},h=d,f=r(4),component=Object(f.a)(h,(function(){var t=this,e=t._self._c;return e("div",[t.libraryCopies.length?e("draggable",t._b({staticClass:"list-group",attrs:{list:t.libraryCopies,handle:".drag-handle",draggable:".item",tag:"div"},on:{start:t.startDrag,end:t.endDrag}},"draggable",t.dragOptions,!1),[t._l(t.libraryCopies,(function(r){return[e("div",{key:r.id,staticClass:"item"},[e("tables-library-item",{attrs:{library:r,selected:t.currentLibraryId===r.id,dragging:t.drag},on:{edit:t.editLibrary,click:t.setLibrary}})],1)]}))],2):t._e(),t._v(" "),t.libraries.length?t._e():e("div",{staticClass:"pb-4"},[e("ui-btn",{on:{click:t.clickAddLibrary}},[t._v(t._s(t.$strings.ButtonAddYourFirstLibrary))])],1),t._v(" "),t.libraries.length&&t.libraries.some((function(li){return"book"===li.mediaType}))?e("p",{staticClass:"text-xs mt-4 text-gray-200"},[t._v("\n    **"),e("strong",[t._v(t._s(t.$strings.ButtonMatchBooks))]),t._v(" "+t._s(t.$strings.MessageMatchBooksDescription)+"\n  ")]):t._e()],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{TablesLibraryItem:r(739).default,UiBtn:r(42).default})}}]);