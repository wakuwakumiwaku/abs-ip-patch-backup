(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{751:function(t,e,r){"use strict";r.r(e);r(15),r(17),r(56),r(27),r(14),r(8);var n={props:{playlistId:String,item:{type:Object,default:function(){}},isDragging:Boolean,bookCoverAspectRatio:Number},data:function(){return{isProcessingReadUpdate:!1,processingRemove:!1,isHovering:!1}},watch:{isDragging:{handler:function(t){t&&(this.isHovering=!1)}}},computed:{translateDistance:function(){return this.userCanUpdate?"-translate-x-24":"-translate-x-12"},libraryItem:function(){return this.item.libraryItem||{}},episode:function(){return this.item.episode},episodeId:function(){return this.episode?this.episode.id:null},media:function(){return this.libraryItem.media||{}},mediaMetadata:function(){return this.media.metadata||{}},tracks:function(){return this.episode?[]:this.media.tracks||[]},itemTitle:function(){return this.episode?this.episode.title:this.mediaMetadata.title||""},bookAuthors:function(){return this.episode?[]:this.mediaMetadata.authors||[]},itemDuration:function(){return this.episode?this.$elapsedPretty(this.episode.duration):this.$elapsedPretty(this.media.duration)},isMissing:function(){return this.libraryItem.isMissing},isInvalid:function(){return this.libraryItem.isInvalid},isStreaming:function(){return this.$store.getters.getIsMediaStreaming(this.libraryItem.id,this.episodeId)},showPlayBtn:function(){return!this.isMissing&&!this.isInvalid&&!this.isStreaming&&(this.tracks.length||this.episode)},itemProgress:function(){return this.$store.getters["user/getUserMediaProgress"](this.libraryItem.id,this.episodeId)},userIsFinished:function(){return!!this.itemProgress&&!!this.itemProgress.isFinished},coverSize:function(){return this.$store.state.globals.isMobile?30:50},coverWidth:function(){return 1===this.bookCoverAspectRatio?1.6*this.coverSize:this.coverSize},userCanUpdate:function(){return this.$store.getters["user/getUserCanUpdate"]},userCanDelete:function(){return this.$store.getters["user/getUserCanDelete"]}},methods:{mouseover:function(){this.isDragging||(this.isHovering=!0)},mouseleave:function(){this.isHovering=!1},playClick:function(){var t=null;t=this.episode?{libraryItemId:this.libraryItem.id,libraryId:this.libraryItem.libraryId,episodeId:this.episodeId,title:this.itemTitle,subtitle:this.mediaMetadata.title,caption:"",duration:this.media.duration||null,coverPath:this.media.coverPath||null}:{libraryItemId:this.libraryItem.id,libraryId:this.libraryItem.libraryId,episodeId:null,title:this.itemTitle,subtitle:this.bookAuthors.map((function(t){return t.name})).join(", "),caption:"",duration:this.media.duration||null,coverPath:this.media.coverPath||null},this.$eventBus.$emit("play-item",{libraryItemId:this.libraryItem.id,episodeId:this.episodeId,queueItems:[t]})},clickEdit:function(){this.$emit("edit",this.item)},toggleFinished:function(){var t=this,e={isFinished:!this.userIsFinished};this.isProcessingReadUpdate=!0;var r="/api/me/progress/".concat(this.libraryItem.id);this.episodeId&&(r+="/".concat(this.episodeId)),this.$axios.$patch(r,e).then((function(){t.isProcessingReadUpdate=!1})).catch((function(r){console.error("Failed",r),t.isProcessingReadUpdate=!1,t.$toast.error(e.isFinished?t.$strings.ToastItemMarkedAsFinishedFailed:t.$strings.ToastItemMarkedAsNotFinishedFailed)}))},removeClick:function(){var t=this;this.processingRemove=!0;var e="/api/playlists/".concat(this.playlistId,"/item/").concat(this.libraryItem.id);this.episodeId&&(e+="/".concat(this.episodeId)),this.$axios.$delete(e).then((function(e){e.items.length?console.log("Item removed from playlist",e):(console.log("All items removed so playlist was removed",e),t.$toast.success(t.$strings.ToastPlaylistRemoveSuccess))})).catch((function(e){console.error("Failed to remove item from playlist",e),t.$toast.error(t.$strings.ToastFailedToUpdate)})).finally((function(){t.processingRemove=!1}))}},mounted:function(){}},o=r(4),component=Object(o.a)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full px-1 md:px-2 py-2 overflow-hidden relative",class:t.isHovering?"bg-white/5":"",on:{mouseover:t.mouseover,mouseleave:t.mouseleave}},[t.item?e("div",{staticClass:"flex h-16 md:h-20"},[t._m(0),t._v(" "),e("div",{staticClass:"h-full relative flex items-center",style:{width:t.coverWidth+"px",minWidth:t.coverWidth+"px",maxWidth:t.coverWidth+"px"}},[e("covers-book-cover",{attrs:{"library-item":t.libraryItem,width:t.coverWidth,"book-cover-aspect-ratio":t.bookCoverAspectRatio}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isHovering&&t.showPlayBtn,expression:"isHovering && showPlayBtn"}],staticClass:"absolute top-0 left-0 bg-black/50 flex items-center justify-center h-full w-full z-10"},[e("div",{staticClass:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/40 cursor-pointer",on:{click:t.playClick}},[e("span",{staticClass:"material-symbols fill text-2xl"},[t._v("play_arrow")])])])],1),t._v(" "),e("div",{staticClass:"grow overflow-hidden max-w-48 md:max-w-md h-full flex items-center px-2 md:px-3"},[e("div",[e("div",{staticClass:"truncate max-w-48 md:max-w-md"},[e("nuxt-link",{staticClass:"truncate hover:underline text-sm md:text-base",attrs:{to:"/item/".concat(t.libraryItem.id)}},[t._v(t._s(t.itemTitle))])],1),t._v(" "),e("div",{staticClass:"truncate max-w-48 md:max-w-md text-xs md:text-sm text-gray-300"},[t._l(t.bookAuthors,(function(r,n){return[e("nuxt-link",{key:r.id,staticClass:"truncate hover:underline",attrs:{to:"/author/".concat(r.id)}},[t._v(t._s(r.name))]),n<t.bookAuthors.length-1?e("span",{key:r.id+"-comma"},[t._v(",Â ")]):t._e()]})),t._v(" "),t.episode?e("nuxt-link",{staticClass:"truncate hover:underline",attrs:{to:"/item/".concat(t.libraryItem.id)}},[t._v(t._s(t.mediaMetadata.title))]):t._e()],2),t._v(" "),e("p",{staticClass:"text-xs md:text-sm text-gray-400"},[t._v(t._s(t.itemDuration))])])])]):t._e(),t._v(" "),e("div",{staticClass:"w-40 absolute top-0 -right-24 h-full transform transition-transform",class:t.isHovering?t.translateDistance:"translate-x-0"},[e("div",{staticClass:"flex h-full items-center"},[e("ui-tooltip",{attrs:{text:t.userIsFinished?t.$strings.MessageMarkAsNotFinished:t.$strings.MessageMarkAsFinished,direction:"top"}},[e("ui-read-icon-btn",{staticClass:"mx-1 mt-0.5",attrs:{disabled:t.isProcessingReadUpdate,"is-read":t.userIsFinished,borderless:""},on:{click:t.toggleFinished}})],1),t._v(" "),t.userCanUpdate?e("div",{staticClass:"mx-1",class:t.isHovering?"":"ml-6"},[e("ui-icon-btn",{attrs:{icon:"edit",borderless:""},on:{click:t.clickEdit}})],1):t._e(),t._v(" "),e("div",{staticClass:"mx-1",class:t.isHovering?"":"ml-6"},[e("ui-icon-btn",{attrs:{icon:"close",borderless:""},on:{click:t.removeClick}})],1)],1)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"w-10 min-w-10 md:w-16 md:max-w-16 h-full"},[t("div",{staticClass:"flex h-full items-center justify-center"},[t("span",{staticClass:"material-symbols drag-handle text-lg md:text-xl"},[this._v("menu")])])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{CoversBookCover:r(107).default,UiReadIconBtn:r(353).default,UiTooltip:r(76).default,UiIconBtn:r(148).default})}}]);