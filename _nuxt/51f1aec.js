(window.webpackJsonp=window.webpackJsonp||[]).push([[97,143,153],{1090:function(e,t,n){"use strict";n.r(t);var r={props:{library:{type:Object,default:function(){return null}},processing:Boolean},data:function(){return{cronExpression:null,enableAutoScan:!1}},computed:{},methods:{checkBlurExpressionInput:function(){return!!this.$refs.cronExpressionBuilder&&this.$refs.cronExpressionBuilder.checkBlurExpressionInput()},toggleEnableAutoScan:function(e){e?this.cronExpression||(this.cronExpression="0 0 * * 1",this.updatedCron(this.cronExpression)):this.updatedCron(null)},updatedCron:function(e){this.$emit("update",{settings:{autoScanCronExpression:e}})},init:function(){this.cronExpression=this.library.settings.autoScanCronExpression,this.enableAutoScan=!!this.cronExpression}},mounted:function(){this.init()}},l=n(4),component=Object(l.a)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-full h-full px-1 md:px-4 py-1 mb-4"},[t("div",{staticClass:"flex items-center justify-between mb-4"},[t("p",{staticClass:"text-base md:text-xl font-semibold"},[e._v(e._s(e.$strings.HeaderScheduleLibraryScans))]),e._v(" "),t("ui-checkbox",{attrs:{label:e.$strings.LabelEnable,medium:"","checkbox-bg":"bg","label-class":"pl-2 text-base md:text-lg"},on:{input:e.toggleEnableAutoScan},model:{value:e.enableAutoScan,callback:function(t){e.enableAutoScan=t},expression:"enableAutoScan"}})],1),e._v(" "),e.enableAutoScan?t("widgets-cron-expression-builder",{ref:"cronExpressionBuilder",on:{input:e.updatedCron},model:{value:e.cronExpression,callback:function(t){e.cronExpression=t},expression:"cronExpression"}}):t("div",[t("p",{staticClass:"text-yellow-400 text-base"},[e._v(e._s(e.$strings.MessageScheduleLibraryScanNote))])])],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiCheckbox:n(184).default,WidgetsCronExpressionBuilder:n(707).default})},676:function(e,t,n){"use strict";n.r(t);n(41),n(52),n(17),n(26),n(33),n(27),n(8);var r={props:{value:{type:Array,default:function(){return[]}},items:{type:Array,default:function(){return[]}},label:String},data:function(){return{showMenu:!1,menu:null,clickOutsideObj:{handler:this.closeMenu,events:["mousedown"],isActive:!0}}},computed:{selected:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},selectedItems:function(){var e=this;return(this.value||[]).map((function(t){return e.items.find((function(i){return i.value===t}))||{text:t,value:t}}))}},methods:{recalcMenuPos:function(){if(this.menu&&this.$refs.inputWrapper){var e=this.$refs.inputWrapper.getBoundingClientRect();this.menu.style.top=e.y+e.height-4+"px",this.menu.style.left=e.x+"px",this.menu.style.width=e.width+"px"}},unmountMountMenu:function(){if(this.$refs.menu&&this.$refs.inputWrapper){this.menu=this.$refs.menu;var e=this.$refs.inputWrapper.getBoundingClientRect();this.menu.remove(),document.body.appendChild(this.menu),this.menu.style.top=e.y+e.height-4+"px",this.menu.style.left=e.x+"px",this.menu.style.width=e.width+"px"}},clickedOption:function(e,t){var n=this;e&&(e.stopPropagation(),e.preventDefault());var r=null;r=this.selected.includes(t.value)?this.selected.filter((function(s){return s!==t.value})):this.selected.concat([t.value]),this.$emit("input",r),this.$nextTick((function(){n.recalcMenuPos()}))},closeMenu:function(){this.showMenu=!1,this.removeListener()},clickWrapper:function(){this.showMenu=!this.showMenu,this.showMenu?this.setListener():this.removeListener()},removeItem:function(e){var t=this,n=this.selected.filter((function(i){return i!==e}));this.$emit("input",n),this.$nextTick((function(){t.recalcMenuPos()}))},scroll:function(){this.recalcMenuPos()},setListener:function(){document.addEventListener("scroll",this.scroll,!0)},removeListener:function(){document.removeEventListener("scroll",this.scroll,!0)}},mounted:function(){},beforeDestroy:function(){this.menu&&this.menu.remove()}},l=n(4),component=Object(l.a)(r,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.clickOutsideObj,expression:"clickOutsideObj"}],staticClass:"w-full"},[t("p",{staticClass:"px-1 text-sm font-semibold"},[e._v(e._s(e.label))]),e._v(" "),t("div",{ref:"wrapper",staticClass:"relative"},[t("div",{ref:"inputWrapper",staticClass:"flex-wrap relative w-full shadow-xs flex items-center bg-primary border border-gray-600 rounded-md px-2 py-1 cursor-pointer",staticStyle:{"min-height":"40px"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.clickWrapper.apply(null,arguments)},mouseup:function(e){e.stopPropagation(),e.preventDefault()},mousedown:function(e){e.preventDefault()}}},e._l(e.selectedItems,(function(n){return t("div",{key:n.value,staticClass:"rounded-full px-2 py-1 ma-0.5 text-xs bg-bg flex flex-nowrap whitespace-nowrap items-center relative"},[t("div",{staticClass:"w-full h-full rounded-full absolute top-0 left-0 opacity-0 hover:opacity-100 px-1 bg-bg/75 flex items-center justify-end cursor-pointer"},[t("span",{staticClass:"material-symbols text-white hover:text-error",staticStyle:{"font-size":"1.1rem"},on:{click:function(t){return t.stopPropagation(),e.removeItem(n.value)}}},[e._v("close")])]),e._v("\n        "+e._s(n.text)+"\n      ")])})),0),e._v(" "),t("transition",{attrs:{name:"menu"}},[t("ul",{directives:[{name:"show",rawName:"v-show",value:e.showMenu,expression:"showMenu"}],ref:"menu",staticClass:"absolute z-60 -mt-px w-full bg-primary border border-black-200 shadow-lg max-h-56 rounded-md py-1 text-base ring-1 ring-black/5 overflow-auto focus:outline-hidden sm:text-sm",attrs:{role:"listbox","aria-labelledby":"listbox-label"}},[e._l(e.items,(function(n){return[t("li",{key:n.value,staticClass:"text-gray-50 select-none relative py-2 pr-9 cursor-pointer hover:bg-black-400",attrs:{role:"option"},on:{click:function(t){return e.clickedOption(t,n)},mouseup:function(e){e.stopPropagation(),e.preventDefault()},mousedown:function(e){e.preventDefault()}}},[t("p",{staticClass:"font-normal ml-3 block truncate"},[e._v(e._s(n.text))]),e._v(" "),e.selected.includes(n.value)?t("div",{staticClass:"text-yellow-400 absolute inset-y-0 right-0 my-auto w-5 h-5 mr-3 overflow-hidden"},[t("span",{staticClass:"material-symbols text-xl"},[e._v("check")])]):e._e()])]})),e._v(" "),e.items.length?e._e():t("li",{staticClass:"text-gray-50 select-none relative py-2 pr-9",attrs:{role:"option"}},[t("div",{staticClass:"flex items-center justify-center"},[t("span",{staticClass:"font-normal"},[e._v(e._s(e.$strings.MessageNoItems))])])])],2)])],1)])}),[],!1,null,null,null);t.default=component.exports},707:function(e,t,n){"use strict";n.r(t);n(22),n(43);var r=n(7),l=(n(29),n(17),n(33),n(56),n(27),n(150),n(14),n(8),n(59),n(357),{props:{value:{type:String,default:null}},data:function(){return{selectedInterval:"custom",showAdvancedView:!1,selectedHour:0,selectedMinute:0,selectedWeekdays:[],cronExpression:"0 0 * * *",customCronExpression:"0 0 * * *",customCronError:"",isValidating:!1,validatedCron:null,isValid:!0}},watch:{value:{immediate:!0,handler:function(e){this.init()}}},computed:{minuteIsValid:function(){return!(isNaN(this.selectedMinute)||""===this.selectedMinute||this.selectedMinute<0||this.selectedMinute>59)},hourIsValid:function(){return!(isNaN(this.selectedHour)||""===this.selectedHour||this.selectedHour<0||this.selectedHour>23)},nextRun:function(){if(!this.cronExpression)return"";var e=this.$getNextScheduledDate(this.cronExpression);return this.$formatJsDatetime(e,this.$store.getters.getServerSetting("dateFormat"),this.$store.getters.getServerSetting("timeFormat"))||""},description:function(){var e=this;if(("custom"!==this.selectedInterval||!this.selectedWeekdays.length)&&"daily"!==this.selectedInterval)return"";if(!this.hourIsValid)return'<span class="text-error">Invalid hour must be 0-23 | '.concat(this.selectedHour<0||this.selectedHour>23,"</span>");if(!this.minuteIsValid)return'<span class="text-error">Invalid minute must be 0-59</span>';var t="Run every ",n="";n=7===this.selectedWeekdays.length||"daily"===this.selectedInterval?"day":this.selectedWeekdays.map((function(t){return e.weekdays.find((function(e){return e.value===t})).text})).join(", "),t+='<span class="font-bold text-white">'.concat(n,"</span>");var r=this.selectedHour.toString(),l=this.selectedMinute.toString().padStart(2,"0");return t+=' at <span class="font-bold text-white">'.concat(r,":").concat(l,"</span>"),t},intervalOptions:function(){return[{text:this.$strings.LabelIntervalCustomDailyWeekly,value:"custom"},{text:this.$strings.LabelIntervalEveryDay,value:"daily"},{text:this.$strings.LabelIntervalEvery12Hours,value:"0 */12 * * *"},{text:this.$strings.LabelIntervalEvery6Hours,value:"0 */6 * * *"},{text:this.$strings.LabelIntervalEvery2Hours,value:"0 */2 * * *"},{text:this.$strings.LabelIntervalEveryHour,value:"0 * * * *"},{text:this.$strings.LabelIntervalEvery30Minutes,value:"*/30 * * * *"},{text:this.$strings.LabelIntervalEvery15Minutes,value:"*/15 * * * *"}]},weekdays:function(){return[{text:this.$formatJsDate(new Date(2023,0,1),"EEEE"),value:0},{text:this.$formatJsDate(new Date(2023,0,2),"EEEE"),value:1},{text:this.$formatJsDate(new Date(2023,0,3),"EEEE"),value:2},{text:this.$formatJsDate(new Date(2023,0,4),"EEEE"),value:3},{text:this.$formatJsDate(new Date(2023,0,5),"EEEE"),value:4},{text:this.$formatJsDate(new Date(2023,0,6),"EEEE"),value:5},{text:this.$formatJsDate(new Date(2023,0,7),"EEEE"),value:6}]}},methods:{checkBlurExpressionInput:function(){return!(!this.showAdvancedView||!this.$refs.customExpressionInput)&&(!!this.$refs.customExpressionInput.isFocused&&(this.$refs.customExpressionInput.blur(),!0))},updateCron:function(){if("custom"===this.selectedInterval){if(!this.minuteIsValid||!this.hourIsValid||!this.selectedWeekdays.length)return void(this.cronExpression=null);this.selectedWeekdays.sort();var e=7===this.selectedWeekdays.length?"*":this.selectedWeekdays.join(",");this.cronExpression="".concat(this.selectedMinute," ").concat(this.selectedHour," * * ").concat(e)}else if("daily"===this.selectedInterval){if(!this.minuteIsValid||!this.hourIsValid)return void(this.cronExpression=null);this.cronExpression="".concat(this.selectedMinute," ").concat(this.selectedHour," * * *")}else this.cronExpression=this.selectedInterval;this.customCronExpression=this.cronExpression,this.validatedCron=this.cronExpression,this.isValid=!0,this.customCronError="",this.$emit("input",this.cronExpression)},minuteBlur:function(){var e=this.selectedMinute;""===e||null===e||isNaN(e)||e<0?this.selectedMinute=0:this.selectedMinute=e>59?59:Number(e),this.updateCron()},hourBlur:function(){var e=this.selectedHour;""===e||null===e||isNaN(e)||e<0?this.selectedHour=0:this.selectedHour=e>23?23:Number(e),this.updateCron()},cronExpressionBlur:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.customCronError="",e.customCronExpression&&5===e.customCronExpression.split(" ").length){t.next=5;break}return e.customCronError="Invalid cron expression",e.isValid=!1,t.abrupt("return");case 5:if(e.customCronExpression!==e.cronExpression&&(e.selectedWeekdays=[],e.selectedHour=0,e.selectedMinute=0,e.cronExpression=e.customCronExpression),e.validatedCron&&e.validatedCron===e.cronExpression){t.next=13;break}return t.next=9,e.validateCron();case 9:n=t.sent,e.isValid=n.isValid,e.validatedCron=e.cronExpression,e.customCronError=n.error||"";case 13:e.isValid&&e.$emit("input",e.cronExpression);case 14:case"end":return t.stop()}}),t)})))()},validateCron:function(){var e=this;return this.isValidating=!0,this.$axios.$post("/api/validate-cron",{expression:this.customCronExpression}).then((function(){return e.isValidating=!1,{isValid:!0}})).catch((function(t){console.error("Invalid cron",t);var n=t.response&&t.response.data||"";return e.isValidating=!1,{isValid:!1,error:n||"Invalid cron expression"}}))},init:function(){var e=this;if(this.selectedInterval="custom",this.selectedHour=0,this.selectedMinute=0,this.selectedWeekdays=[],this.value){var t=this.value.split(" ");if(5===t.length){if(this.intervalOptions.find((function(t){return t.value===e.value})))this.selectedInterval=this.value;else{var n=!1;(isNaN(t[0])||isNaN(t[1])||"*"!==t[2]||"*"!==t[3]||"*"!==t[4]&&t[4].split(",").some((function(e){return isNaN(e)})))&&(n=!0),n?this.showAdvancedView=!0:("*"===t[4]&&(this.selectedInterval="daily"),this.selectedWeekdays="*"===t[4]?[0,1,2,3,4,5,6]:t[4].split(",").map((function(e){return Number(e)})),this.selectedHour=t[1],this.selectedMinute=t[0])}this.cronExpression=this.value,this.customCronExpression=this.value}else console.error("Invalid cron expression input",this.value)}}},mounted:function(){this.init()}}),o=n(4),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-full py-2"},[t("div",{staticClass:"flex -mb-px"},[t("div",{staticClass:"w-1/2 h-8 rounded-tl-md relative border border-black-200 flex items-center justify-center cursor-pointer",class:e.showAdvancedView?"text-gray-400 hover:text-gray-300 bg-primary/70 hover:bg-primary/60":"text-white bg-bg hover:bg-bg/60 border-b-bg",on:{click:function(t){e.showAdvancedView=!1}}},[t("p",{staticClass:"text-sm"},[e._v(e._s(e.$strings.HeaderSchedule))])]),e._v(" "),t("div",{staticClass:"w-1/2 h-8 rounded-tr-md relative border border-black-200 flex items-center justify-center -ml-px cursor-pointer",class:e.showAdvancedView?"text-white bg-bg hover:bg-bg/60 border-b-bg":"text-gray-400 hover:text-gray-300 bg-primary/70 hover:bg-primary/60",on:{click:function(t){e.showAdvancedView=!0}}},[t("p",{staticClass:"text-sm"},[e._v(e._s(e.$strings.HeaderAdvanced))])])]),e._v(" "),t("div",{staticClass:"px-2 py-4 md:p-4 border border-black-200 rounded-b-md mr-px",staticStyle:{"min-height":"280px"}},[e.showAdvancedView?[t("p",{staticClass:"px-1 text-sm font-semibold"},[e._v(e._s(e.$strings.LabelCronExpression))]),e._v(" "),t("ui-text-input",{ref:"customExpressionInput",staticClass:"w-full text-2xl md:text-4xl -tracking-widest mb-4 font-mono",attrs:{"padding-y":2,"text-center":""},on:{blur:e.cronExpressionBlur},model:{value:e.customCronExpression,callback:function(t){e.customCronExpression=t},expression:"customCronExpression"}}),e._v(" "),t("div",{staticClass:"flex items-center justify-center"},[e.isValidating?t("widgets-loading-spinner",{staticClass:"mr-2"}):t("span",{staticClass:"material-symbols mr-2 text-xl",class:e.isValid?"text-success":"text-error"},[e._v(e._s(e.isValid?"check_circle_outline":"error_outline"))]),e._v(" "),e.isValidating?t("p",{staticClass:"text-gray-300 text-base md:text-lg text-center"},[e._v(e._s(e.$strings.MessageCheckingCron))]):e.customCronError?t("p",{staticClass:"text-error text-base md:text-lg text-center"},[e._v(e._s(e.customCronError))]):t("p",{staticClass:"text-success text-base md:text-lg text-center"},[e._v(e._s(e.$strings.MessageValidCronExpression))])],1)]:[t("ui-dropdown",{staticClass:"mb-2",attrs:{label:e.$strings.LabelInterval,items:e.intervalOptions},on:{input:e.updateCron},model:{value:e.selectedInterval,callback:function(t){e.selectedInterval=t},expression:"selectedInterval"}}),e._v(" "),"custom"===e.selectedInterval?t("ui-multi-select-dropdown",{attrs:{label:e.$strings.LabelWeekdaysToRun,items:e.weekdays},on:{input:e.updateCron},model:{value:e.selectedWeekdays,callback:function(t){e.selectedWeekdays=t},expression:"selectedWeekdays"}}):e._e(),e._v(" "),e.selectedWeekdays.length&&"custom"===e.selectedInterval||"daily"===e.selectedInterval?t("div",{staticClass:"flex items-center py-2"},[t("ui-text-input-with-label",{staticClass:"max-w-20",attrs:{type:"number",label:e.$strings.LabelHour},on:{input:e.updateCron,blur:e.hourBlur},model:{value:e.selectedHour,callback:function(t){e.selectedHour=t},expression:"selectedHour"}}),e._v(" "),t("p",{staticClass:"text-xl px-2 mt-4"},[e._v(":")]),e._v(" "),t("ui-text-input-with-label",{staticClass:"max-w-20",attrs:{type:"number",label:e.$strings.LabelMinute},on:{input:e.updateCron,blur:e.minuteBlur},model:{value:e.selectedMinute,callback:function(t){e.selectedMinute=t},expression:"selectedMinute"}})],1):e._e(),e._v(" "),e.description?t("div",{staticClass:"w-full bg-primary/75 rounded-xl p-2 md:p-4 text-center mt-2"},[t("p",{staticClass:"text-base md:text-lg text-gray-200",domProps:{innerHTML:e._s(e.description)}})]):e._e()],e._v(" "),e.cronExpression&&e.isValid?t("div",{staticClass:"flex items-center justify-center text-yellow-400 mt-2"},[t("span",{staticClass:"material-symbols mr-2 text-xl"},[e._v("event")]),e._v(" "),t("p",[e._v(e._s(e.$strings.LabelNextScheduledRun)+": "+e._s(e.nextRun))])]):e._e()],2)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiDropdown:n(236).default,UiMultiSelectDropdown:n(676).default,UiTextInputWithLabel:n(121).default,UiTextInput:n(68).default,WidgetsLoadingSpinner:n(151).default})}}]);