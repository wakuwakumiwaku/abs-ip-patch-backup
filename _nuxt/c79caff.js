(window.webpackJsonp=window.webpackJsonp||[]).push([[124,123],{717:function(t,e,o){var content=o(768);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(19).default)("5c6e4bfa",content,!0,{sourceMap:!1})},742:function(t,e,o){"use strict";o.r(e);o(17),o(15);var n=o(16);o(56),o(22),o(26),o(27),o(44),o(45),o(38),o(8),o(28),o(14);function r(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?r(Object(o),!0).forEach((function(e){Object(n.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var l={props:{collectionId:String,book:{type:Object,default:function(){}},isDragging:Boolean,bookCoverAspectRatio:Number},data:function(){return{isProcessingReadUpdate:!1,processingRemove:!1,isHovering:!1}},watch:{isDragging:{handler:function(t){t&&(this.isHovering=!1)}}},computed:{translateDistance:function(){return this.userCanUpdate||this.userCanDelete?this.userCanUpdate&&this.userCanDelete?"-translate-x-24":"-translate-x-12":"translate-x-0"},media:function(){return this.book.media||{}},mediaMetadata:function(){return this.media.metadata||{}},tracks:function(){return this.media.tracks||[]},bookTitle:function(){return this.mediaMetadata.title||""},bookAuthors:function(){return this.mediaMetadata.authors||[]},bookDuration:function(){return this.$elapsedPretty(this.media.duration)},series:function(){return this.mediaMetadata.series||[]},seriesList:function(){return this.series.map((function(t){var text=t.name;return t.sequence&&(text+=" #".concat(t.sequence)),c(c({},t),{},{text:text})}))},isMissing:function(){return this.book.isMissing},isInvalid:function(){return this.book.isInvalid},isStreaming:function(){return this.$store.getters.getLibraryItemIdStreaming===this.book.id},showPlayBtn:function(){return!this.isMissing&&!this.isInvalid&&!this.isStreaming&&this.tracks.length},itemProgress:function(){return this.$store.getters["user/getUserMediaProgress"](this.book.id)},userIsFinished:function(){return!!this.itemProgress&&!!this.itemProgress.isFinished},coverSize:function(){return this.$store.state.globals.isMobile?30:50},coverHeight:function(){return 1.6*this.coverSize},coverWidth:function(){return 1===this.bookCoverAspectRatio?1.6*this.coverSize:this.coverSize},userCanUpdate:function(){return this.$store.getters["user/getUserCanUpdate"]},userCanDelete:function(){return this.$store.getters["user/getUserCanDelete"]}},methods:{mouseover:function(){this.isDragging||(this.isHovering=!0)},mouseleave:function(){this.isHovering=!1},playClick:function(){var t=[{libraryItemId:this.book.id,libraryId:this.book.libraryId,episodeId:null,title:this.bookTitle,subtitle:this.bookAuthors.map((function(t){return t.name})).join(", "),caption:"",duration:this.media.duration||null,coverPath:this.media.coverPath||null}];this.$eventBus.$emit("play-item",{libraryItemId:this.book.id,queueItems:t})},clickEdit:function(){this.$emit("edit",this.book)},toggleFinished:function(){var t=this,e={isFinished:!this.userIsFinished};this.isProcessingReadUpdate=!0,this.$axios.$patch("/api/me/progress/".concat(this.book.id),e).then((function(){t.isProcessingReadUpdate=!1})).catch((function(o){console.error("Failed",o),t.isProcessingReadUpdate=!1,t.$toast.error(e.isFinished?t.$strings.ToastItemMarkedAsFinishedFailed:t.$strings.ToastItemMarkedAsNotFinishedFailed)}))},removeClick:function(){var t=this;this.processingRemove=!0,this.$axios.$delete("/api/collections/".concat(this.collectionId,"/book/").concat(this.book.id)).then((function(e){console.log("Book removed from collection",e),t.$toast.success(t.$strings.ToastRemoveItemFromCollectionSuccess),t.processingRemove=!1})).catch((function(e){console.error("Failed to remove book from collection",e),t.$toast.error(t.$strings.ToastRemoveItemFromCollectionFailed),t.processingRemove=!1}))}},mounted:function(){}},d=o(4),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full px-1 md:px-2 py-2 overflow-hidden relative",class:t.isHovering?"bg-white/5":"",on:{mouseover:t.mouseover,mouseleave:t.mouseleave}},[t.book?e("div",{staticClass:"flex h-18 md:h-[5.5rem]"},[t._m(0),t._v(" "),e("div",{staticClass:"h-full flex items-center",style:{width:t.coverWidth+"px",minWidth:t.coverWidth+"px",maxWidth:t.coverWidth+"px"}},[e("div",{staticClass:"relative",style:{height:t.coverHeight+"px",minHeight:t.coverHeight+"px",maxHeight:t.coverHeight+"px"}},[e("covers-book-cover",{attrs:{"library-item":t.book,width:t.coverWidth,"book-cover-aspect-ratio":t.bookCoverAspectRatio}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isHovering&&t.showPlayBtn,expression:"isHovering && showPlayBtn"}],staticClass:"absolute top-0 left-0 flex items-center justify-center bg-black/50 h-full w-full z-10"},[e("div",{staticClass:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/40 cursor-pointer",on:{click:t.playClick}},[e("span",{staticClass:"material-symbols fill text-2xl"},[t._v("play_arrow")])])])],1)]),t._v(" "),e("div",{staticClass:"grow overflow-hidden max-w-48 md:max-w-md h-full flex items-center px-2 md:px-3"},[e("div",[e("div",{staticClass:"truncate max-w-48 md:max-w-md"},[e("nuxt-link",{staticClass:"truncate hover:underline text-sm md:text-base",attrs:{to:"/item/".concat(t.book.id)}},[t._v(t._s(t.bookTitle))])],1),t._v(" "),e("div",{staticClass:"truncate max-w-48 md:max-w-md text-xs md:text-sm text-gray-300"},t._l(t.seriesList,(function(o){return e("nuxt-link",{key:o.id,staticClass:"hover:underline font-sans text-gray-300",attrs:{to:"/library/".concat(t.book.libraryId,"/series/").concat(o.id)}},[t._v(" "+t._s(o.text))])})),1),t._v(" "),e("div",{staticClass:"truncate max-w-48 md:max-w-md text-xs md:text-sm text-gray-300"},[t._l(t.bookAuthors,(function(o,n){return[e("nuxt-link",{key:o.id,staticClass:"truncate hover:underline",attrs:{to:"/author/".concat(o.id)}},[t._v(t._s(o.name))]),n<t.bookAuthors.length-1?e("span",{key:o.id+"-comma"},[t._v(",Â ")]):t._e()]}))],2),t._v(" "),t.media.duration?e("p",{staticClass:"text-xs md:text-sm text-gray-400"},[t._v(t._s(t.bookDuration))]):t._e()])])]):t._e(),t._v(" "),e("div",{staticClass:"w-40 absolute top-0 -right-24 h-full transform transition-transform",class:t.isHovering?t.translateDistance:"translate-x-0"},[e("div",{staticClass:"flex h-full items-center"},[e("ui-tooltip",{attrs:{text:t.userIsFinished?t.$strings.MessageMarkAsNotFinished:t.$strings.MessageMarkAsFinished,direction:"top"}},[e("ui-read-icon-btn",{staticClass:"mx-1 mt-0.5",attrs:{disabled:t.isProcessingReadUpdate,"is-read":t.userIsFinished,borderless:""},on:{click:t.toggleFinished}})],1),t._v(" "),t.userCanUpdate?e("div",{staticClass:"mx-1",class:t.isHovering?"":"ml-6"},[e("ui-icon-btn",{attrs:{icon:"edit",borderless:""},on:{click:t.clickEdit}})],1):t._e(),t._v(" "),t.userCanDelete?e("div",{staticClass:"mx-1"},[e("ui-icon-btn",{attrs:{icon:"close",borderless:""},on:{click:t.removeClick}})],1):t._e()],1)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"w-10 min-w-10 md:w-16 md:max-w-16 h-full"},[t("div",{staticClass:"flex h-full items-center justify-center"},[t("span",{staticClass:"material-symbols drag-handle text-lg md:text-xl"},[this._v("menu")])])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{CoversBookCover:o(107).default,UiReadIconBtn:o(353).default,UiTooltip:o(76).default,UiIconBtn:o(148).default})},767:function(t,e,o){"use strict";o(717)},768:function(t,e,o){var n=o(18)((function(i){return i[1]}));n.push([t.i,"\n.collection-book-item {\n  transition: all 0.4s ease;\n}\n.collection-book-enter-from,\n.collection-book-leave-to {\n  opacity: 0;\n  transform: translateX(30px);\n}\n.collection-book-leave-active {\n  position: absolute;\n}\n",""]),n.locals={},t.exports=n},854:function(t,e,o){"use strict";o.r(e);var n=o(16),r=(o(22),o(26),o(27),o(8),o(44),o(45),o(38),o(28),o(690));function c(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}var l={components:{draggable:o.n(r).a},props:{collectionId:String,books:{type:Array,default:function(){return[]}}},data:function(){return{drag:!1,dragOptions:{animation:200,group:"description",ghostClass:"ghost"},booksCopy:[]}},watch:{books:{handler:function(t){this.init()}}},computed:{bookCoverAspectRatio:function(){return this.$store.getters["libraries/getBookCoverAspectRatio"]},totalDuration:function(){var t=0;return this.books.forEach((function(e){t+=e.media.duration})),t},totalDurationPretty:function(){return this.$elapsedPrettyExtended(this.totalDuration)}},methods:{draggableUpdate:function(){var t=this,e={books:this.booksCopy.map((function(b){return b.id}))};this.$axios.$patch("/api/collections/".concat(this.collectionId),e).then((function(t){console.log("Collection updated",t)})).catch((function(e){console.error("Failed to update collection",e),t.$toast.error(t.$strings.ToastFailedToUpdate)}))},editBook:function(t){var e=this.books.map((function(b){return b.id}));this.$store.commit("setBookshelfBookIds",e),this.$store.commit("showEditModal",t)},init:function(){this.booksCopy=this.books.map((function(b){return function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?c(Object(o),!0).forEach((function(e){Object(n.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({},b)}))}},mounted:function(){this.init()}},d=l,h=(o(767),o(4)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full bg-primary/40"},[e("div",{staticClass:"w-full h-14 flex items-center px-4 md:px-6 py-2 bg-primary"},[e("p",{staticClass:"pr-4"},[t._v(t._s(t.$strings.HeaderCollectionItems))]),t._v(" "),e("div",{staticClass:"w-6 h-6 md:w-7 md:h-7 bg-white/10 rounded-full flex items-center justify-center"},[e("span",{staticClass:"text-xs md:text-sm font-mono leading-none"},[t._v(t._s(t.books.length))])]),t._v(" "),e("div",{staticClass:"grow"}),t._v(" "),t.totalDuration?e("p",{staticClass:"text-sm text-gray-200"},[t._v(t._s(t.totalDurationPretty))]):t._e()]),t._v(" "),e("draggable",t._b({staticClass:"list-group",attrs:{handle:".drag-handle",draggable:".item",tag:"div"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},update:t.draggableUpdate},model:{value:t.booksCopy,callback:function(e){t.booksCopy=e},expression:"booksCopy"}},"draggable",t.dragOptions,!1),[e("transition-group",{attrs:{type:"transition",name:t.drag?null:"collection-book"}},[t._l(t.booksCopy,(function(o){return[e("tables-collection-book-table-row",{key:o.id,staticClass:"item",class:t.drag?"":"collection-book-item",attrs:{"is-dragging":t.drag,book:o,"collection-id":t.collectionId,"book-cover-aspect-ratio":t.bookCoverAspectRatio},on:{edit:t.editBook}})]}))],2)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{TablesCollectionBookTableRow:o(742).default})}}]);