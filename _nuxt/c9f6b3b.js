(window.webpackJsonp=window.webpackJsonp||[]).push([[2,156],{866:function(e,t,r){"use strict";r.r(t);r(17);var o=r(7),n=r(16),l=(r(29),r(22),r(33),r(85),r(26),r(56),r(27),r(57),r(150),r(15),r(14),r(44),r(45),r(38),r(8),r(35),r(63),r(28),r(5)),d=r(867);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m={props:{index:Number,width:Number,height:{type:Number,default:192},bookshelfView:Number,bookMount:{type:Object,default:function(){return null}},orderBy:String,filterBy:String,sortingIgnorePrefix:Boolean,continueListeningShelf:Boolean},data:function(){return{isHovering:!1,isMoreMenuOpen:!1,processing:!1,libraryItem:null,imageReady:!1,selected:!1,isSelectionMode:!1,displayTitleTruncated:!1,displaySubtitleTruncated:!1,showCoverBg:!1}},watch:{bookMount:{handler:function(e){e&&(this.libraryItem=e)}}},computed:{bookCoverAspectRatio:function(){return this.store.getters["libraries/getBookCoverAspectRatio"]},coverWidth:function(){return this.width||this.coverHeight/this.bookCoverAspectRatio},coverHeight:function(){return this.height*this.sizeMultiplier},cardWidth:function(){return this.coverWidth},sizeMultiplier:function(){return this.store.getters["user/getSizeMultiplier"]},dateFormat:function(){return this.store.getters.getServerSetting("dateFormat")},timeFormat:function(){return this.store.getters.getServerSetting("timeFormat")},_libraryItem:function(){return this.libraryItem||{}},isFile:function(){return this._libraryItem.isFile},media:function(){return this._libraryItem.media||{}},mediaMetadata:function(){return this.media.metadata||{}},mediaType:function(){return this._libraryItem.mediaType},isPodcast:function(){return"podcast"===this.mediaType||"podcast"===this.store.getters["libraries/getCurrentLibraryMediaType"]},isExplicit:function(){return this.mediaMetadata.explicit||!1},placeholderUrl:function(){return this.store.getters["globals/getPlaceholderCoverSrc"]},bookCoverSrc:function(){return this.store.getters["globals/getLibraryItemCoverSrc"](this._libraryItem,this.placeholderUrl)},libraryItemId:function(){return this._libraryItem.id},series:function(){return this.mediaMetadata.series},seriesName:function(){var e,t;return null!==(e=this.collapsedSeries)&&void 0!==e&&e.name?this.collapsedSeries.name:(null===(t=this.series)||void 0===t?void 0:t.name)||null},seriesSequence:function(){var e;return(null===(e=this.series)||void 0===e?void 0:e.sequence)||null},libraryId:function(){return this._libraryItem.libraryId},ebookFormat:function(){return this.media.ebookFormat},numTracks:function(){return this.media.tracks?this.media.tracks.length:this.media.numTracks||0},numEpisodes:function(){return this.media.numEpisodes||0},numEpisodesIncomplete:function(){return this._libraryItem.numEpisodesIncomplete||0},processingBatch:function(){return this.store.state.processingBatch},recentEpisode:function(){return this._libraryItem.recentEpisode},recentEpisodeNumber:function(){return this.recentEpisode?this.recentEpisode.episode?this.recentEpisode.episode.replace(/^#/,""):"":null},collapsedSeries:function(){return this._libraryItem.collapsedSeries},booksInSeries:function(){var e;return(null===(e=this.collapsedSeries)||void 0===e?void 0:e.numBooks)||0},seriesSequenceList:function(){var e;return(null===(e=this.collapsedSeries)||void 0===e?void 0:e.seriesSequenceList)||null},libraryItemIdsInSeries:function(){var e;return(null===(e=this.collapsedSeries)||void 0===e?void 0:e.libraryItemIds)||[]},hasCover:function(){return!!this.media.coverPath},squareAspectRatio:function(){return 1===this.bookCoverAspectRatio},title:function(){return this.mediaMetadata.title||""},playIconFontSize:function(){return Math.max(2,3*this.sizeMultiplier)},author:function(){return this.isPodcast?this.mediaMetadata.author:this.mediaMetadata.authorName},authorLF:function(){return this.mediaMetadata.authorNameLF},artist:function(){return(this.mediaMetadata.artists||[]).join(", ")},displayTitle:function(){if(this.recentEpisode)return this.recentEpisode.title;var e="media.metadata.title"===this.orderBy&&this.sortingIgnorePrefix;return this.collapsedSeries?e?this.collapsedSeries.nameIgnorePrefix:this.collapsedSeries.name:e?this.mediaMetadata.titleIgnorePrefix||" ":this.title||" "},displaySubtitle:function(){return this.libraryItem?this.collapsedSeries?"".concat(this.collapsedSeries.numBooks," ").concat(this.$strings.LabelBooks):this.mediaMetadata.subtitle?this.mediaMetadata.subtitle:this.mediaMetadata.seriesName?this.mediaMetadata.seriesName:"":" "},displayLineTwo:function(){return this.recentEpisode?this.title:this.isPodcast?this.author:this.collapsedSeries?"":this.isAuthorBookshelfView?this.mediaMetadata.publishedYear||"":"media.metadata.authorNameLF"===this.orderBy?this.authorLF:this.author},displaySortLine:function(){return this.collapsedSeries?null:"mtimeMs"===this.orderBy?this.$getString("LabelFileModifiedDate",[this.$formatDate(this._libraryItem.mtimeMs,this.dateFormat)]):"birthtimeMs"===this.orderBy?this.$getString("LabelFileBornDate",[this.$formatDate(this._libraryItem.birthtimeMs,this.dateFormat)]):"addedAt"===this.orderBy?this.$getString("LabelAddedDate",[this.$formatDate(this._libraryItem.addedAt,this.dateFormat)]):"media.duration"===this.orderBy?this.$strings.LabelDuration+": "+this.$elapsedPrettyExtended(this.media.duration,!1):"size"===this.orderBy?this.$strings.LabelSize+": "+this.$bytesPretty(this._libraryItem.size):"media.numTracks"===this.orderBy?"".concat(this.numEpisodes," ")+this.$strings.LabelEpisodes:"media.metadata.publishedYear"===this.orderBy?this.mediaMetadata.publishedYear?this.$getString("LabelPublishedDate",[this.mediaMetadata.publishedYear]):" ":"progress"===this.orderBy?this.userProgressLastUpdated?this.$getString("LabelLastProgressDate",[this.$formatDatetime(this.userProgressLastUpdated,this.dateFormat,this.timeFormat)]):" ":"progress.createdAt"===this.orderBy?this.userProgressStartedDate?this.$getString("LabelStartedDate",[this.$formatDatetime(this.userProgressStartedDate,this.dateFormat,this.timeFormat)]):" ":"progress.finishedAt"===this.orderBy?this.userProgressFinishedDate?this.$getString("LabelFinishedDate",[this.$formatDatetime(this.userProgressFinishedDate,this.dateFormat,this.timeFormat)]):" ":null},episodeProgress:function(){return this.recentEpisode?this.store.getters["user/getUserMediaProgress"](this.libraryItemId,this.recentEpisode.id):null},userProgress:function(){return this.episodeProgress?this.episodeProgress:this.store.getters["user/getUserMediaProgress"](this.libraryItemId)},isEBookOnly:function(){return!this.numTracks&&this.ebookFormat},useEBookProgress:function(){return!(!this.userProgress||this.userProgress.progress)&&this.userProgress.ebookProgress>0},seriesProgressPercent:function(){var e=this;if(!this.libraryItemIdsInSeries.length)return 0;var t=0,r=this.useEBookProgress;return this.libraryItemIdsInSeries.forEach((function(o){var progress=e.store.getters["user/getUserMediaProgress"](o);progress&&(t+=progress.isFinished?1:r?progress.ebookProgress||0:progress.progress||0)})),t/this.libraryItemIdsInSeries.length},userProgressPercent:function(){var e,t,r=this.itemIsFinished?1:this.booksInSeries?this.seriesProgressPercent:this.useEBookProgress?(null===(e=this.userProgress)||void 0===e?void 0:e.ebookProgress)||0:(null===(t=this.userProgress)||void 0===t?void 0:t.progress)||0;return Math.max(Math.min(1,r),0)},userProgressLastUpdated:function(){return this.userProgress?this.userProgress.lastUpdate:null},userProgressStartedDate:function(){return this.userProgress?this.userProgress.startedAt:null},userProgressFinishedDate:function(){return this.userProgress?this.userProgress.finishedAt:null},itemIsFinished:function(){return this.booksInSeries?this.seriesIsFinished:!!this.userProgress&&!!this.userProgress.isFinished},seriesIsFinished:function(){var e=this;return!this.libraryItemIdsInSeries.some((function(t){var progress=e.store.getters["user/getUserMediaProgress"](t);return!progress||!progress.isFinished}))},showError:function(){return!this.recentEpisode&&(this.isMissing||this.isInvalid)},libraryItemIdStreaming:function(){return this.store.getters.getLibraryItemIdStreaming},isStreaming:function(){return this.libraryItemIdStreaming===this.libraryItemId},isQueued:function(){var e=this.recentEpisode?this.recentEpisode.id:null;return this.store.getters.getIsMediaQueued(this.libraryItemId,e)},isStreamingFromDifferentLibrary:function(){return this.store.getters.getIsStreamingFromDifferentLibrary},showReadButton:function(){return!this.isSelectionMode&&!this.showPlayButton&&this.ebookFormat},showPlayButton:function(){return!this.isSelectionMode&&!this.isMissing&&!this.isInvalid&&!this.isStreaming&&(this.numTracks||this.recentEpisode)},showSmallEBookIcon:function(){return!this.isSelectionMode&&this.ebookFormat},isMissing:function(){return this._libraryItem.isMissing},isInvalid:function(){return this._libraryItem.isInvalid},errorText:function(){return this.isMissing?"Item directory is missing!":this.isInvalid?this.isPodcast?"Podcast has no episodes":"Item has no audio tracks & ebook":"Unknown Error"},overlayWrapperClasslist:function(){var e=[];return this.isSelectionMode?e.push("bg-black/60"):e.push("bg-black/40"),this.selected&&e.push("border-2 border-yellow-400"),e},store:function(){return this.$store||this.$nuxt.$store},userCanUpdate:function(){return this.store.getters["user/getUserCanUpdate"]},userCanDelete:function(){return this.store.getters["user/getUserCanDelete"]},userCanDownload:function(){return this.store.getters["user/getUserCanDownload"]},userIsAdminOrUp:function(){return this.store.getters["user/getIsAdminOrUp"]},moreMenuItems:function(){if(this.recentEpisode){var e=[{func:"editPodcast",text:this.$strings.ButtonEditPodcast},{func:"toggleFinished",text:this.itemIsFinished?this.$strings.MessageMarkAsNotFinished:this.$strings.MessageMarkAsFinished},{func:"openPlaylists",text:this.$strings.LabelAddToPlaylist}];return this.continueListeningShelf&&e.push({func:"removeFromContinueListening",text:this.$strings.ButtonRemoveFromContinueListening}),this.libraryItemIdStreaming&&!this.isStreamingFromDifferentLibrary&&(this.isQueued?this.isStreaming||e.push({func:"removeFromQueue",text:this.$strings.ButtonQueueRemoveItem}):e.push({func:"addToQueue",text:this.$strings.ButtonQueueAddItem})),e}var t,r=[];this.isPodcast||(r=[{func:"toggleFinished",text:this.itemIsFinished?this.$strings.MessageMarkAsNotFinished:this.$strings.MessageMarkAsFinished}],this.userCanUpdate&&r.push({func:"openCollections",text:this.$strings.LabelAddToCollection}),this.numTracks&&(r.push({func:"openPlaylists",text:this.$strings.LabelAddToPlaylist}),this.userIsAdminOrUp&&r.push({func:"openShare",text:this.$strings.LabelShare})),this.ebookFormat&&null!==(t=this.store.state.libraries.ereaderDevices)&&void 0!==t&&t.length&&r.push({text:this.$strings.LabelSendEbookToDevice,subitems:this.store.state.libraries.ereaderDevices.map((function(e){return{text:e.name,func:"sendToDevice",data:e.name}}))}));return this.userCanUpdate&&(r.push({func:"showEditModalFiles",text:this.$strings.HeaderFiles}),r.push({func:"showEditModalMatch",text:this.$strings.HeaderMatch})),this.userIsAdminOrUp&&!this.isFile&&r.push({func:"rescan",text:this.$strings.ButtonReScan}),this.series&&this.bookMount&&r.push({func:"removeSeriesFromContinueListening",text:this.$strings.ButtonRemoveSeriesFromContinueSeries}),this.continueListeningShelf&&r.push({func:"removeFromContinueListening",text:this.isEBookOnly?this.$strings.ButtonRemoveFromContinueReading:this.$strings.ButtonRemoveFromContinueListening}),this.isPodcast||this.libraryItemIdStreaming&&!this.isStreamingFromDifferentLibrary&&(this.isQueued?this.isStreaming||r.push({func:"removeFromQueue",text:this.$strings.ButtonQueueRemoveItem}):r.push({func:"addToQueue",text:this.$strings.ButtonQueueAddItem})),this.userCanDelete&&r.push({func:"deleteLibraryItem",text:this.$strings.ButtonDelete}),r},_socket:function(){return this.$root.socket||this.$nuxt.$root.socket},titleFontSize:function(){return.75},authorFontSize:function(){return.6},placeholderCoverPadding:function(){return.8},authorBottom:function(){return.75},titleCleaned:function(){return this.title?this.title.length>60?this.title.slice(0,57)+"...":this.title:""},authorCleaned:function(){return this.author?this.author.length>30?this.author.slice(0,27)+"...":this.author:""},isAlternativeBookshelfView:function(){var e=this.$constants||this.$nuxt.$constants;return this.bookshelfView===e.BookshelfView.DETAIL},isAuthorBookshelfView:function(){var e=this.$constants||this.$nuxt.$constants;return this.bookshelfView===e.BookshelfView.AUTHOR},rssFeed:function(){return this.booksInSeries?null:this._libraryItem.rssFeed||null},mediaItemShare:function(){return this._libraryItem.mediaItemShare||null},showSubtitles:function(){return!this.isPodcast&&this.store.getters["user/getUserSetting"]("showSubtitles")}},methods:{setSelectionMode:function(e){this.isSelectionMode=e,e||(this.selected=!1)},setEntity:function(e){var t=this,r=e;if(this.series){var o=(r=h(h({},e),{},{media:h(h({},e.media),{},{metadata:h({},e.media.metadata)})})).media.metadata;if(o.series&&Array.isArray(o.series)){var n=o.series.find((function(e){return e.id===t.series.id}));if(n)return r.media.metadata.series=n,void(this.libraryItem=r)}}this.libraryItem=r,this.$nextTick((function(){t.$refs.displayTitle&&(t.displayTitleTruncated=t.$refs.displayTitle.scrollWidth>t.$refs.displayTitle.clientWidth),t.$refs.displaySubtitle&&(t.displaySubtitleTruncated=t.$refs.displaySubtitle.scrollWidth>t.$refs.displaySubtitle.clientWidth)}))},clickCard:function(e){if(!this.processing)if(this.isSelectionMode)e.stopPropagation(),e.preventDefault(),this.selectBtnClick(e);else{var t=this.$router||this.$nuxt.$router;t&&(this.collapsedSeries?t.push("/library/".concat(this.libraryId,"/series/").concat(this.collapsedSeries.id)):t.push("/item/".concat(this.libraryItemId)))}},editClick:function(){if(this.recentEpisode)return this.$emit("edit",{libraryItem:this.libraryItem,episode:this.recentEpisode});this.$emit("edit",this.libraryItem)},toggleFinished:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.itemIsFinished&&this.userProgressPercent>0&&!t){var r={message:this.$getString("MessageConfirmMarkItemFinished",[this.displayTitle]),callback:function(t){t&&e.toggleFinished(!0)},type:"yesNo"};this.store.commit("globals/setConfirmPrompt",r)}else{var o={isFinished:!this.itemIsFinished};this.processing=!0;var n="/api/me/progress/".concat(this.libraryItemId);this.recentEpisode&&(n+="/".concat(this.recentEpisode.id));var l=this.$toast||this.$nuxt.$toast;(this.$axios||this.$nuxt.$axios).$patch(n,o).then((function(){e.processing=!1})).catch((function(t){console.error("Failed",t),e.processing=!1,l.error(o.isFinished?e.$strings.ToastItemMarkedAsFinishedFailed:e.$strings.ToastItemMarkedAsNotFinishedFailed)}))}},editPodcast:function(){this.$emit("editPodcast",this.libraryItem)},rescan:function(){var e=this;if(!this.processing){var t=this.$axios||this.$nuxt.$axios;this.processing=!0,t.$post("/api/items/".concat(this.libraryItemId,"/scan")).then((function(data){var t=data.result;t?"UPDATED"===t?e.$toast.success(e.$strings.ToastRescanUpdated):"UPTODATE"===t?e.$toast.success(e.$strings.ToastRescanUpToDate):"REMOVED"===t&&e.$toast.error(e.$strings.ToastRescanRemoved):e.$toast.error(e.$getString("ToastRescanFailed",[e.displayTitle]))})).catch((function(t){console.error("Failed to scan library item",t),e.$toast.error(e.$strings.ToastScanFailed)})).finally((function(){e.processing=!1}))}},showEditModalFiles:function(){this.$emit("edit",this.libraryItem,"files")},showEditModalMatch:function(){this.$emit("edit",this.libraryItem,"match")},sendToDevice:function(e){var t=this,r={message:this.$getString("MessageConfirmSendEbookToDevice",[this.ebookFormat,this.title,e]),callback:function(r){if(r){var o={libraryItemId:t.libraryItemId,deviceName:e};t.processing=!0,(t.$axios||t.$nuxt.$axios).$post("/api/emails/send-ebook-to-device",o).then((function(){t.$toast.success(t.$getString("ToastSendEbookToDeviceSuccess",[e]))})).catch((function(e){console.error("Failed to send ebook to device",e),t.$toast.error(t.$strings.ToastSendEbookToDeviceFailed)})).finally((function(){t.processing=!1}))}},type:"yesNo"};this.store.commit("globals/setConfirmPrompt",r)},removeSeriesFromContinueListening:function(){var e=this;if(this.series){var t=this.$axios||this.$nuxt.$axios;this.processing=!0,t.$get("/api/me/series/".concat(this.series.id,"/remove-from-continue-listening")).then((function(data){console.log("User updated",data)})).catch((function(t){console.error("Failed to remove series from home",t),e.$toast.error(e.$strings.ToastFailedToUpdate)})).finally((function(){e.processing=!1}))}},removeFromContinueListening:function(){var e=this;if(this.userProgress){var t=this.$axios||this.$nuxt.$axios;this.processing=!0,t.$get("/api/me/progress/".concat(this.userProgress.id,"/remove-from-continue-listening")).then((function(data){console.log("User updated",data)})).catch((function(t){console.error("Failed to hide item from home",t),e.$toast.error(e.$strings.ToastFailedToUpdate)})).finally((function(){e.processing=!1}))}},addToQueue:function(){var e={};e=this.recentEpisode?{libraryItemId:this.libraryItemId,libraryId:this.libraryId,episodeId:this.recentEpisode.id,title:this.recentEpisode.title,subtitle:this.mediaMetadata.title,caption:this.recentEpisode.publishedAt?this.$getString("LabelPublishedDate",[this.$formatDate(this.recentEpisode.publishedAt,this.dateFormat)]):this.$strings.LabelUnknownPublishDate,duration:this.recentEpisode.audioFile.duration||null,coverPath:this.media.coverPath||null}:{libraryItemId:this.libraryItemId,libraryId:this.libraryId,episodeId:null,title:this.title,subtitle:this.author,caption:"",duration:this.media.duration||null,coverPath:this.media.coverPath||null},this.store.commit("addItemToQueue",e)},removeFromQueue:function(){var e=this.recentEpisode?this.recentEpisode.id:null;this.store.commit("removeItemFromQueue",{libraryItemId:this.libraryItemId,episodeId:e})},openCollections:function(){this.store.commit("setSelectedLibraryItem",this.libraryItem),this.store.commit("globals/setShowCollectionsModal",!0)},openPlaylists:function(){this.store.commit("globals/setSelectedPlaylistItems",[{libraryItem:this.libraryItem,episode:this.recentEpisode}]),this.store.commit("globals/setShowPlaylistsModal",!0)},openShare:function(){this.store.commit("setSelectedLibraryItem",this.libraryItem),this.store.commit("globals/setShareModal",this.mediaItemShare)},deleteLibraryItem:function(){var e=this,t={message:this.$strings.MessageConfirmDeleteLibraryItem,checkboxLabel:this.$strings.LabelDeleteFromFileSystemCheckbox,yesButtonText:this.$strings.ButtonDelete,yesButtonColor:"error",checkboxDefaultValue:!Number(localStorage.getItem("softDeleteDefault")||0),callback:function(t,r){t&&(localStorage.setItem("softDeleteDefault",r?0:1),e.processing=!0,(e.$axios||e.$nuxt.$axios).$delete("/api/items/".concat(e.libraryItemId,"?hard=").concat(r?1:0)).then((function(){e.$toast.success(e.$strings.ToastItemDeletedSuccess)})).catch((function(t){console.error("Failed to delete item",t),e.$toast.error(e.$strings.ToastItemDeletedFailed)})).finally((function(){e.processing=!1})))},type:"yesNo"};this.store.commit("globals/setConfirmPrompt",t)},createMoreMenu:function(){if(this.$refs.moreIcon){var e=l.a.extend(d.default),t=this,r=new e({propsData:{items:this.moreMenuItems},created:function(){this.$on("action",(function(e){e.func&&t[e.func]&&t[e.func](e.data)})),this.$on("close",(function(){t.isMoreMenuOpen=!1}))}});r.$mount();var o=this.$refs.moreIcon.getBoundingClientRect(),n=r.$el,c=28*this.moreMenuItems.length+10,h=o.top+o.height,m=o.left+o.width,f=h,v=m;h+c>window.innerHeight-100&&(f=o.top-c,v=o.left),m+130>window.innerWidth-100&&(v=m-130),n.style.top=f+"px",n.style.left=v+"px",this.isMoreMenuOpen=!0,document.body.appendChild(n)}},clickShowMore:function(){this.createMoreMenu()},clickReadEBook:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$axios||e.$nuxt.$axios,t.next=3,r.$get("/api/items/".concat(e.libraryItemId,"?expanded=1")).catch((function(t){return console.error("Failed to get lirbary item",e.libraryItemId),null}));case 3:if(o=t.sent){t.next=6;break}return t.abrupt("return");case 6:e.store.commit("showEReader",{libraryItem:o,keepProgress:!0});case 7:case"end":return t.stop()}}),t)})))()},selectBtnClick:function(e){this.processingBatch||(this.selected=!this.selected,this.$emit("select",{entity:this.libraryItem,shiftKey:e.shiftKey}))},play:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,n,l,d,c,i,h,m,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.$eventBus||e.$nuxt.$eventBus,o=[],!e.recentEpisode){t.next=12;break}return n=e.$axios||e.$nuxt.$axios,e.processing=!0,t.next=7,n.$get("/api/items/".concat(e.libraryItemId)).catch((function(e){return console.error("Failed to fetch library item",e),null}));case 7:if(l=t.sent,e.processing=!1,l&&l.media.episodes&&((d=l.media.episodes||[]).sort((function(a,b){return String(a.publishedAt).localeCompare(String(b.publishedAt),void 0,{numeric:!0,sensitivity:"base"})})),(c=d.findIndex((function(t){return t.id===e.recentEpisode.id})))>=0))for(i=c;i<d.length;i++)h=d[i],(m=e.store.getters["user/getUserMediaProgress"](e.libraryItemId,h.id))&&m.isFinished||o.push({libraryItemId:e.libraryItemId,libraryId:e.libraryId,episodeId:h.id,title:h.title,subtitle:e.mediaMetadata.title,caption:h.publishedAt?e.$getString("LabelPublishedDate",[e.$formatDate(h.publishedAt,e.dateFormat)]):e.$strings.LabelUnknownPublishDate,duration:h.audioFile.duration||null,coverPath:e.media.coverPath||null});t.next=14;break;case 12:f={libraryItemId:e.libraryItemId,libraryId:e.libraryId,episodeId:null,title:e.title,subtitle:e.author,caption:"",duration:e.media.duration||null,coverPath:e.media.coverPath||null},o.push(f);case 14:r.$emit("play-item",{libraryItemId:e.libraryItemId,episodeId:e.recentEpisode?e.recentEpisode.id:null,queueItems:o});case 15:case"end":return t.stop()}}),t)})))()},mouseover:function(){this.isHovering=!0},mouseleave:function(){this.isHovering=!1},destroy:function(){this.$destroy(),this.$el&&this.$el.parentNode?this.$el.parentNode.removeChild(this.$el):this.$el&&this.$el.remove&&this.$el.remove()},setCoverBg:function(){this.$refs.coverBg&&(this.$refs.coverBg.style.backgroundImage='url("'.concat(this.bookCoverSrc,'")'))},imageLoaded:function(){if(this.imageReady=!0,this.$refs.cover&&this.bookCoverSrc!==this.placeholderUrl){var e=this.$refs.cover,t=e.naturalWidth,r=e.naturalHeight/t;Math.abs(r-this.bookCoverAspectRatio)>.15?(this.showCoverBg=!0,this.$nextTick(this.setCoverBg)):this.showCoverBg=!1}}},mounted:function(){this.bookMount&&this.setEntity(this.bookMount)}},f=m,v=r(4),component=Object(v.a)(f,(function(){var e=this,t=e._self._c;return t("div",{ref:"card",staticClass:"absolute rounded-xs z-10 cursor-pointer",style:{minWidth:e.coverWidth+"px",maxWidth:e.coverWidth+"px"},attrs:{id:"book-card-".concat(e.index),tabindex:"0"},on:{mousedown:function(e){e.preventDefault()},mouseup:function(e){e.preventDefault()},mousemove:function(e){e.preventDefault()},mouseover:e.mouseover,mouseleave:e.mouseleave,click:e.clickCard}},[t("div",{staticClass:"relative w-full top-0 left-0 rounded-sm overflow-hidden z-10 bg-primary box-shadow-book",style:{height:e.coverHeight+"px "},attrs:{id:"cover-area-".concat(e.index)}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showCoverBg,expression:"showCoverBg"}],staticClass:"absolute top-0 left-0 w-full h-full overflow-hidden rounded-xs bg-primary",attrs:{"cy-id":"coverBg"}},[t("div",{ref:"coverBg",staticClass:"absolute cover-bg"})]),e._v(" "),e.seriesSequenceList?t("div",{staticClass:"absolute rounded-lg bg-black/90 box-shadow-md z-20 text-right",staticStyle:{"background-color":"#78350f"},style:{top:"0.375em",right:"0.375em",padding:"0.1em 0.25em"},attrs:{"cy-id":"seriesSequenceList"}},[t("p",{style:{fontSize:"0.8em"}},[e._v("#"+e._s(e.seriesSequenceList))])]):e.booksInSeries?t("div",{staticClass:"absolute rounded-lg bg-black/90 box-shadow-md z-20",staticStyle:{"background-color":"#cd9d49dd"},style:{top:"0.375em",right:"0.375em",padding:"0.1em 0.25em"},attrs:{"cy-id":"booksInSeries"}},[t("p",{style:{fontSize:"0.8em"}},[e._v(e._s(e.booksInSeries))])]):e._e(),e._v(" "),t("div",{staticClass:"w-full h-full absolute top-0 left-0 rounded-sm overflow-hidden z-10"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.libraryItem&&!e.imageReady,expression:"libraryItem && !imageReady"}],staticClass:"absolute top-0 left-0 w-full h-full flex items-center justify-center",style:{padding:"0.5em"},attrs:{"cy-id":"titleImageNotReady","aria-hidden":"true"}},[t("p",{staticClass:"text-gray-300 text-center",style:{fontSize:"0.8em"}},[e._v(e._s(e.title))])]),e._v(" "),e.libraryItem?t("img",{ref:"cover",staticClass:"relative w-full h-full transition-opacity duration-300",class:e.showCoverBg?"object-contain":"object-fill",style:{opacity:e.imageReady?1:0},attrs:{"cy-id":"coverImage",alt:"".concat(e.displayTitle,", ").concat(e.$strings.LabelCover),"aria-hidden":"true",src:e.bookCoverSrc},on:{load:e.imageLoaded}}):e._e(),e._v(" "),e.hasCover?e._e():t("div",{staticClass:"absolute top-0 left-0 right-0 bottom-0 w-full h-full flex items-center justify-center",style:{padding:e.placeholderCoverPadding+"em"},attrs:{"cy-id":"placeholderTitle"}},[t("div",[t("p",{staticClass:"text-center",staticStyle:{color:"rgb(247 223 187)"},style:{fontSize:e.titleFontSize+"em"},attrs:{"cy-id":"placeholderTitleText","aria-hidden":"true"}},[e._v(e._s(e.titleCleaned))])])]),e._v(" "),e.hasCover?e._e():t("div",{staticClass:"absolute left-0 right-0 w-full flex items-center justify-center",style:{padding:e.placeholderCoverPadding+"em",bottom:e.authorBottom+"em"},attrs:{"cy-id":"placeholderAuthor"}},[t("p",{staticClass:"text-center",staticStyle:{color:"rgb(247 223 187)",opacity:"0.75"},style:{fontSize:e.authorFontSize+"em"},attrs:{"cy-id":"placeholderAuthorText","aria-hidden":"true"}},[e._v(e._s(e.authorCleaned))])]),e._v(" "),!e.isPodcast||e.episodeProgress?t("div",{staticClass:"absolute bottom-0 left-0 h-1e max-w-full z-20 rounded-b box-shadow-progressbar",class:e.itemIsFinished?"bg-success":"bg-yellow-400",style:{width:e.coverWidth*e.userProgressPercent+"px"},attrs:{"cy-id":"progressBar"}}):e._e(),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.booksInSeries&&e.libraryItem&&(e.isHovering||e.isSelectionMode||e.isMoreMenuOpen)&&!e.processing,expression:"!booksInSeries && libraryItem && (isHovering || isSelectionMode || isMoreMenuOpen) && !processing"}],staticClass:"w-full h-full absolute top-0 left-0 z-10 bg-black rounded-sm md:block",class:e.overlayWrapperClasslist,attrs:{"cy-id":"overlay"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showPlayButton,expression:"showPlayButton"}],staticClass:"h-full flex items-center justify-center pointer-events-none",attrs:{"cy-id":"playButton"}},[t("div",{staticClass:"hover:text-white text-gray-200 hover:scale-110 transform duration-200 pointer-events-auto",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.play.apply(null,arguments)}}},[t("span",{staticClass:"material-symbols fill",style:{fontSize:e.playIconFontSize+"em"}},[e._v("play_arrow")])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showReadButton,expression:"showReadButton"}],staticClass:"h-full flex items-center justify-center pointer-events-none",attrs:{"cy-id":"readButton"}},[t("div",{staticClass:"hover:text-white text-gray-200 hover:scale-110 transform duration-200 pointer-events-auto",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.clickReadEBook.apply(null,arguments)}}},[t("span",{staticClass:"material-symbols",style:{fontSize:e.playIconFontSize+"em"}},[e._v("auto_stories")])])]),e._v(" "),e.userCanUpdate?t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isSelectionMode,expression:"!isSelectionMode"}],staticClass:"absolute cursor-pointer hover:text-yellow-300 hover:scale-125 transform duration-150 top-0 right-0",style:{padding:"0.375em"},attrs:{"cy-id":"editButton"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.editClick.apply(null,arguments)}}},[t("span",{staticClass:"material-symbols",style:{fontSize:"1em"}},[e._v("edit")])]):e._e(),e._v(" "),e.isAuthorBookshelfView?e._e():t("div",{staticClass:"absolute cursor-pointer hover:text-yellow-300 hover:scale-125 transform duration-100",style:{top:"0.375em",left:"0.375em"},attrs:{"cy-id":"selectedRadioButton"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.selectBtnClick.apply(null,arguments)}}},[t("span",{staticClass:"material-symbols",class:e.selected?"text-yellow-400":"",style:{fontSize:"1.25em"}},[e._v(e._s(e.selected?"radio_button_checked":"radio_button_unchecked"))])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isSelectionMode&&e.moreMenuItems.length,expression:"!isSelectionMode && moreMenuItems.length"}],ref:"moreIcon",staticClass:"md:block absolute cursor-pointer hover:text-yellow-300 300 hover:scale-125 transform duration-150",style:{bottom:"0.375em",right:"0.375em"},attrs:{"cy-id":"moreButton"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.clickShowMore.apply(null,arguments)}}},[t("span",{staticClass:"material-symbols",style:{fontSize:"1.2em"}},[e._v("more_vert")])]),e._v(" "),e.ebookFormat?t("div",{staticClass:"absolute",style:{bottom:"0.375em",left:"0.375em"},attrs:{"cy-id":"ebookFormat"}},[t("span",{staticClass:"text-white/80",style:{fontSize:"0.8em"}},[e._v(e._s(e.ebookFormat))])]):e._e()]),e._v(" "),e.processing?t("div",{staticClass:"w-full h-full absolute top-0 left-0 z-10 bg-black/40 rounded-sm flex items-center justify-center",attrs:{"cy-id":"loadingSpinner"}},[t("widgets-loading-spinner",{attrs:{size:"la-lg"}})],1):e._e(),e._v(" "),e.booksInSeries&&e.libraryItem&&e.isHovering?t("div",{staticClass:"w-full h-full absolute top-0 left-0 z-10 bg-black/60 rounded-sm flex items-center justify-center",style:{padding:"1em"},attrs:{"cy-id":"seriesNameOverlay"}},[e.seriesName?t("p",{staticClass:"text-gray-200 text-center",style:{fontSize:"1.1em"}},[e._v(e._s(e.seriesName))]):e._e()]):e._e(),e._v(" "),e.showError?t("ui-tooltip",{staticClass:"absolute bottom-4e left-0 z-10",attrs:{"cy-id":"ErrorTooltip",text:e.errorText,plaintext:""}},[t("div",{staticClass:"bg-error rounded-r-full shadow-md flex items-center justify-end border-r border-b border-red-300",style:{height:"1.5em",width:"2.5em"}},[t("span",{staticClass:"material-symbols text-red-100 pr-1e",style:{fontSize:"0.875em"}},[e._v("priority_high")])])]):e._e(),e._v(" "),!e.rssFeed||e.isSelectionMode||e.isHovering?e._e():t("div",{staticClass:"absolute text-success top-0 left-0 z-10",style:{padding:"0.375em"},attrs:{"cy-id":"rssFeed"}},[t("span",{staticClass:"material-symbols",style:{fontSize:"1.5em"},attrs:{"aria-hidden":"true"}},[e._v("rss_feed")])]),e._v(" "),!e.mediaItemShare||e.isSelectionMode||e.isHovering?e._e():t("div",{staticClass:"absolute text-success left-0 z-10",style:{padding:"0.375em",top:e.rssFeed?"2em":"0px"},attrs:{"cy-id":"mediaItemShare"}},[t("span",{staticClass:"material-symbols",style:{fontSize:"1.5em"},attrs:{"aria-hidden":"true"}},[e._v("public")])]),e._v(" "),!e.seriesSequence||e.isHovering||e.isSelectionMode?e._e():t("div",{staticClass:"absolute rounded-lg bg-black/90 box-shadow-md z-10",style:{top:"0.375em",right:"0.375em",padding:"".concat(.1,"em ",.25,"em")},attrs:{"cy-id":"seriesSequence"}},[t("p",{style:{fontSize:"0.8em"}},[e._v("#"+e._s(e.seriesSequence))])]),e._v(" "),null===e.recentEpisodeNumber||e.isHovering||e.isSelectionMode||e.processing?e.numEpisodesIncomplete||!e.numEpisodes||e.isHovering||e.isSelectionMode?!e.numEpisodesIncomplete||e.isHovering||e.isSelectionMode?e._e():t("div",{staticClass:"absolute rounded-full bg-yellow-400 text-black font-semibold box-shadow-md z-10 flex items-center justify-center",style:{top:"0.375em",right:"0.375em",width:"1.25em",height:"1.25em"},attrs:{"cy-id":"numEpisodesIncomplete"}},[t("p",{style:{fontSize:"0.8em"}},[e._v(e._s(e.numEpisodesIncomplete))])]):t("div",{staticClass:"absolute rounded-full bg-black/90 box-shadow-md z-10 flex items-center justify-center",style:{top:"0.375em",right:"0.375em",width:"1.25em",height:"1.25em"},attrs:{"cy-id":"numEpisodes"}},[t("p",{style:{fontSize:"0.8em"},attrs:{role:"status","aria-label":e.$strings.LabelNumberOfEpisodes}},[e._v(e._s(e.numEpisodes))])]):t("div",{staticClass:"absolute rounded-lg bg-black/90 box-shadow-md z-10",style:{top:"0.375em",right:"0.375em",padding:"".concat(.1,"em ",.25,"em")},attrs:{"cy-id":"podcastEpisodeNumber"}},[t("p",{style:{fontSize:"0.8em"}},[e._v("\n          Episode\n          "),e.recentEpisodeNumber?t("span",[e._v("#"+e._s(e.recentEpisodeNumber))]):e._e()])])],1)]),e._v(" "),e.isAlternativeBookshelfView||e.isAuthorBookshelfView?t("div",{staticClass:"relative mt-2e mb-2e left-0 z-50 w-full",attrs:{"cy-id":"detailBottom",id:"description-area-".concat(e.index),dir:"auto"}},[t("div",{style:{fontSize:"0.9em"}},[e.displayTitle?t("ui-tooltip",{staticClass:"flex items-center",attrs:{text:e.displayTitle,plaintext:"",disabled:!e.displayTitleTruncated,direction:"bottom",delayOnShow:500}},[t("p",{ref:"displayTitle",staticClass:"truncate",attrs:{"cy-id":"title"}},[e._v(e._s(e.displayTitle))]),e._v(" "),e.isExplicit?t("widgets-explicit-indicator",{attrs:{"cy-id":"explicitIndicator"}}):e._e()],1):e._e()],1),e._v(" "),e.showSubtitles?t("ui-tooltip",{staticClass:"flex items-center",attrs:{text:e.displaySubtitle,plaintext:"",disabled:!e.displaySubtitleTruncated,direction:"bottom",delayOnShow:500}},[t("p",{ref:"displaySubtitle",staticClass:"truncate",style:{fontSize:"0.6em"},attrs:{"cy-id":"subtitle"}},[e._v(e._s(e.displaySubtitle))])]):e._e(),e._v(" "),t("p",{staticClass:"truncate text-gray-400",style:{fontSize:"0.8em"},attrs:{"cy-id":"line2"}},[e._v(e._s(e.displayLineTwo||" "))]),e._v(" "),e.displaySortLine?t("p",{staticClass:"truncate text-gray-400",style:{fontSize:"0.8em"},attrs:{"cy-id":"line3"}},[e._v(e._s(e.displaySortLine))]):e._e()],1):e._e()])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{WidgetsLoadingSpinner:r(151).default,UiTooltip:r(76).default,WidgetsExplicitIndicator:r(354).default})},867:function(e,t,r){"use strict";r.r(t);r(40);var o={props:{items:{type:Array,default:function(){return[]}}},data:function(){return{clickOutsideObj:{handler:this.clickedOutside,events:["mousedown"],isActive:!0},submenuWidth:144,menuWidth:144,mouseoverItemIndex:null,isOverSubItemMenu:!1,openSubMenuLeft:!1}},computed:{submenuLeftPos:function(){return this.openSubMenuLeft?-this.submenuWidth:this.menuWidth-1.5}},methods:{mouseoverSubItemMenu:function(e){this.isOverSubItemMenu=!0},mouseleaveSubItemMenu:function(e){var t=this;setTimeout((function(){t.isOverSubItemMenu&&t.mouseoverItemIndex===e&&(t.mouseoverItemIndex=null)}),1)},mouseoverItem:function(e){this.isOverSubItemMenu=!1,this.mouseoverItemIndex=e},mouseleaveItem:function(e){var t=this;setTimeout((function(){t.isOverSubItemMenu||t.mouseoverItemIndex===e&&(t.mouseoverItemIndex=null)}),1)},clickAction:function(e,data){this.$emit("action",{func:e,data:data}),this.close()},clickedOutside:function(e){this.close()},close:function(){this.$emit("close"),this.$destroy(),this.$el.parentNode.removeChild(this.$el)}},mounted:function(){var e=this;this.$nextTick((function(){var t,r=null===(t=e.$refs.wrapper)||void 0===t?void 0:t.getBoundingClientRect();r&&(e.openSubMenuLeft=window.innerWidth-r.x<e.menuWidth+e.submenuWidth+5)}))},beforeDestroy:function(){}},n=r(4),component=Object(n.a)(o,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.clickOutsideObj,expression:"clickOutsideObj"}],ref:"wrapper",staticClass:"absolute bg-bg rounded-md py-1 border border-black-200 shadow-lg z-50",style:{width:e.menuWidth+"px"}},[e._l(e.items,(function(r,o){return[r.subitems?[t("div",{key:o,staticClass:"flex items-center px-2 py-1.5 hover:bg-white/5 text-white text-xs cursor-default",class:{"bg-white/5":e.mouseoverItemIndex==o},on:{mouseover:function(t){return e.mouseoverItem(o)},mouseleave:function(t){return e.mouseleaveItem(o)},click:function(e){e.stopPropagation()}}},[t("p",[e._v(e._s(r.text))])]),e._v(" "),e.mouseoverItemIndex===o?t("div",{key:"subitems-".concat(o),staticClass:"absolute bg-bg rounded-b-md border border-black-200 py-1 shadow-lg z-50",class:e.openSubMenuLeft?"rounded-l-md":"rounded-r-md",style:{left:e.submenuLeftPos+"px",top:28*o+"px",width:e.submenuWidth+"px"},on:{mouseover:function(t){return e.mouseoverSubItemMenu(o)},mouseleave:function(t){return e.mouseleaveSubItemMenu(o)}}},e._l(r.subitems,(function(r,o){return t("div",{key:"subitem-".concat(o),staticClass:"flex items-center px-2 py-1.5 hover:bg-white/5 text-white text-xs cursor-pointer",on:{click:function(t){return t.stopPropagation(),e.clickAction(r.func,r.data)}}},[t("p",[e._v(e._s(r.text))])])})),0):e._e()]:t("div",{key:o,staticClass:"flex items-center px-2 py-1.5 hover:bg-white/5 text-white text-xs cursor-pointer",on:{mouseover:function(t){return e.mouseoverItem(o)},mouseleave:function(t){return e.mouseleaveItem(o)},click:function(t){return t.stopPropagation(),e.clickAction(r.func)}}},[t("p",[e._v(e._s(r.text))])])]}))],2)}),[],!1,null,null,null);t.default=component.exports}}]);