(window.webpackJsonp=window.webpackJsonp||[]).push([[184,157],{1060:function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(150),n(29),{asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,r=t.redirect,o=t.app,e.next=3,o.$axios.$get("/api/users/".concat(n.id)).catch((function(t){return console.error("Failed to get user",t),null}));case 3:if(l=e.sent){e.next=6;break}return e.abrupt("return",r("/config/users"));case 6:return e.abrupt("return",{user:l});case 7:case"end":return e.stop()}}),e)})))()},data:function(){return{listeningSessions:{},listeningStats:{}}},computed:{legacyToken:function(){return this.user.token},userToken:function(){return this.user.accessToken},bookCoverAspectRatio:function(){return this.$store.getters["libraries/getBookCoverAspectRatio"]},username:function(){return this.user.username},userOnline:function(){return this.$store.getters["users/getIsUserOnline"](this.user.id)},mediaProgress:function(){return this.user.mediaProgress.sort((function(a,b){return b.lastUpdate-a.lastUpdate}))},totalListeningTime:function(){return this.listeningStats.totalTime||0},listeningTimePretty:function(){return this.$elapsedPrettyExtended(this.totalListeningTime)},timeListenedToday:function(){return this.listeningStats.today||0},latestSession:function(){return this.listeningSessions.sessions&&this.listeningSessions.sessions.length?this.listeningSessions.sessions[0]:null},dateFormat:function(){return this.$store.getters.getServerSetting("dateFormat")},timeFormat:function(){return this.$store.getters.getServerSetting("timeFormat")}},methods:{init:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$get("/api/users/".concat(t.user.id,"/listening-sessions?page=0&itemsPerPage=10")).then((function(data){return data||{}})).catch((function(t){return console.error("Failed to load listening sesions",t),{}}));case 2:return t.listeningSessions=e.sent,e.next=5,t.$axios.$get("/api/users/".concat(t.user.id,"/listening-stats")).catch((function(t){return console.error("Failed to load listening sesions",t),[]}));case 5:t.listeningStats=e.sent,console.log("Loaded user listening data",t.listeningSessions,t.listeningStats);case 7:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.init()}}),l=(n(907),n(4)),component=Object(l.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full h-full"},[e("div",{staticClass:"bg-bg rounded-md shadow-lg border border-white/5 p-0 sm:p-4 mb-8"},[e("nuxt-link",{staticClass:"text-white/70 hover:text-white/100 hover:bg-white/5 cursor-pointer rounded-full px-2 sm:px-0",attrs:{to:"/config/users"}},[e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"h-10 w-10 flex items-center justify-center"},[e("span",{staticClass:"material-symbols text-2xl"},[t._v("arrow_back")])]),t._v(" "),e("p",{staticClass:"pl-1"},[t._v(t._s(t.$strings.LabelAllUsers))])])]),t._v(" "),e("div",{staticClass:"flex items-center mb-2 mt-4 px-2 sm:px-0"},[e("widgets-online-indicator",{attrs:{value:!!t.userOnline}}),t._v(" "),e("h1",{staticClass:"text-xl pl-2"},[t._v(t._s(t.username))])],1),t._v(" "),t.legacyToken?e("div",{staticClass:"text-xs space-y-2 mt-4"},[e("ui-text-input-with-label",{attrs:{label:"Legacy API Token",value:t.legacyToken,readonly:"","show-copy":""}}),t._v(" "),e("p",{staticClass:"text-warning",domProps:{innerHTML:t._s(t.$strings.MessageAuthenticationLegacyTokenWarning)}})],1):t._e(),t._v(" "),e("div",{staticClass:"w-full h-px bg-white/10 my-2"}),t._v(" "),e("div",{staticClass:"py-2"},[e("h1",{staticClass:"text-lg mb-2 text-white/90 px-2 sm:px-0"},[t._v(t._s(t.$strings.HeaderListeningStats))]),t._v(" "),e("div",{staticClass:"flex items-center"},[e("p",{staticClass:"text-sm text-gray-300"},[t._v(t._s(t.listeningSessions.total)+" "+t._s(t.$strings.HeaderListeningSessions))]),t._v(" "),e("ui-btn",{staticClass:"text-xs mx-2",attrs:{to:"/config/users/".concat(t.user.id,"/sessions"),"padding-x":1.5,"padding-y":1}},[t._v(t._s(t.$strings.ButtonViewAll))])],1),t._v(" "),e("p",{staticClass:"text-sm text-gray-300"},[t._v("\n        "+t._s(t.$strings.LabelTotalTimeListened)+": \n        "),e("span",{staticClass:"font-mono text-base"},[t._v(t._s(t.listeningTimePretty))])]),t._v(" "),t.timeListenedToday?e("p",{staticClass:"text-sm text-gray-300"},[t._v("\n        "+t._s(t.$strings.LabelTimeListenedToday)+": \n        "),e("span",{staticClass:"font-mono text-base"},[t._v(t._s(t.$elapsedPrettyExtended(t.timeListenedToday)))])]):t._e(),t._v(" "),t.latestSession?e("div",{staticClass:"mt-4"},[e("h1",{staticClass:"text-lg mb-2 text-white/90 px-2 sm:px-0"},[t._v(t._s(t.$strings.HeaderLastListeningSession))]),t._v(" "),e("p",{staticClass:"text-sm text-gray-300"},[e("strong",[t._v(t._s(t.latestSession.displayTitle))]),t._v(" "+t._s(t.$dateDistanceFromNow(t.latestSession.updatedAt))+" for "),e("span",{staticClass:"font-mono text-base"},[t._v(t._s(t.$elapsedPrettyExtended(this.latestSession.timeListening)))])])]):t._e()]),t._v(" "),e("div",{staticClass:"w-full h-px bg-white/10 my-2"}),t._v(" "),e("div",{staticClass:"py-2"},[e("h1",{staticClass:"text-lg mb-2 text-white/90 px-2 sm:px-0"},[t._v(t._s(t.$strings.HeaderSavedMediaProgress))]),t._v(" "),t.mediaProgress.length?e("table",{staticClass:"userAudiobooksTable"},[e("tr",{staticClass:"bg-primary/40"},[e("th",{staticClass:"w-16 text-left"},[t._v(t._s(t.$strings.LabelItem))]),t._v(" "),e("th",{staticClass:"text-left"}),t._v(" "),e("th",{staticClass:"w-32"},[t._v(t._s(t.$strings.LabelProgress))]),t._v(" "),e("th",{staticClass:"w-40 hidden sm:table-cell"},[t._v(t._s(t.$strings.LabelStartedAt))]),t._v(" "),e("th",{staticClass:"w-40 hidden sm:table-cell"},[t._v(t._s(t.$strings.LabelLastUpdate))])]),t._v(" "),t._l(t.mediaProgress,(function(n){return e("tr",{key:n.id,class:n.isFinished?"isFinished":""},[e("td",[n.coverPath?e("covers-preview-cover",{attrs:{width:50,src:t.$store.getters["globals/getLibraryItemCoverSrcById"](n.libraryItemId,n.mediaUpdatedAt),"book-cover-aspect-ratio":t.bookCoverAspectRatio,"show-resolution":!1}}):e("div",{staticClass:"bg-primary flex items-center justify-center text-center text-xs text-gray-400 p-1",style:{width:"50px",height:50*t.bookCoverAspectRatio+"px"}},[t._v("No Cover")])],1),t._v(" "),e("td",[e("p",[t._v(t._s(n.displayTitle||"Unknown"))]),t._v(" "),n.displaySubtitle?e("p",{staticClass:"text-white/50 text-sm font-sans"},[t._v(t._s(n.displaySubtitle))]):t._e()]),t._v(" "),e("td",{staticClass:"text-center"},[e("p",{staticClass:"text-sm"},[t._v(t._s(Math.floor(100*n.progress))+"%")])]),t._v(" "),e("td",{staticClass:"text-center hidden sm:table-cell"},[n.startedAt?e("ui-tooltip",{attrs:{direction:"top",text:t.$formatDatetime(n.startedAt,t.dateFormat,t.timeFormat)}},[e("p",{staticClass:"text-sm"},[t._v(t._s(t.$dateDistanceFromNow(n.startedAt)))])]):t._e()],1),t._v(" "),e("td",{staticClass:"text-center hidden sm:table-cell"},[n.lastUpdate?e("ui-tooltip",{attrs:{direction:"top",text:t.$formatDatetime(n.lastUpdate,t.dateFormat,t.timeFormat)}},[e("p",{staticClass:"text-sm"},[t._v(t._s(t.$dateDistanceFromNow(n.lastUpdate)))])]):t._e()],1)])}))],2):e("p",{staticClass:"text-white/50"},[t._v(t._s(t.$strings.MessageNoMediaProgress))])])],1)])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{WidgetsOnlineIndicator:n(691).default,UiTextInputWithLabel:n(121).default,UiBtn:n(42).default,CoversPreviewCover:n(356).default,UiTooltip:n(76).default})},691:function(t,e,n){"use strict";n.r(e);var r={props:{value:Boolean},data:function(){return{}},computed:{},methods:{},mounted:function(){}},o=n(4),component=Object(o.a)(r,(function(){var t=this._self._c;return t("div",{staticClass:"w-3 h-3"},[this.value?t("div",{staticClass:"w-full h-full text-sm mr-2 text-success animate-pulse"},[t("svg",{attrs:{viewBox:"0 0 24 24"}},[t("path",{attrs:{fill:"currentColor",d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}})])]):t("svg",{staticClass:"w-full h-full mr-2 text-white/20",attrs:{viewBox:"0 0 24 24"}},[t("path",{attrs:{fill:"currentColor",d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}})])])}),[],!1,null,null,null);e.default=component.exports},800:function(t,e,n){var content=n(908);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(19).default)("56d2cbaa",content,!0,{sourceMap:!1})},907:function(t,e,n){"use strict";n(800)},908:function(t,e,n){var r=n(18)((function(i){return i[1]}));r.push([t.i,"\n.userAudiobooksTable {\n  border-collapse: collapse;\n  width: 100%;\n  border: 1px solid #474747;\n}\n.userAudiobooksTable tr:nth-child(even) {\n  background-color: #2e2e2e;\n}\n.userAudiobooksTable tr:not(:first-child) {\n  background-color: #373838;\n}\n.userAudiobooksTable tr:hover:not(:first-child) {\n  background-color: #474747;\n}\n.userAudiobooksTable tr.isFinished {\n  background-color: rgba(76, 175, 80, 0.1);\n}\n.userAudiobooksTable td {\n  padding: 4px 8px;\n}\n.userAudiobooksTable th {\n  padding: 4px 8px;\n  font-size: 0.75rem;\n}\n",""]),r.locals={},t.exports=r}}]);