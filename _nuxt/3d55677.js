(window.webpackJsonp=window.webpackJsonp||[]).push([[133,132],{721:function(t,e,r){var content=r(776);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("5cb622e1",content,!0,{sourceMap:!1})},751:function(t,e,r){"use strict";r.r(e);r(15),r(17),r(56),r(27),r(14),r(8);var o={props:{playlistId:String,item:{type:Object,default:function(){}},isDragging:Boolean,bookCoverAspectRatio:Number},data:function(){return{isProcessingReadUpdate:!1,processingRemove:!1,isHovering:!1}},watch:{isDragging:{handler:function(t){t&&(this.isHovering=!1)}}},computed:{translateDistance:function(){return this.userCanUpdate?"-translate-x-24":"-translate-x-12"},libraryItem:function(){return this.item.libraryItem||{}},episode:function(){return this.item.episode},episodeId:function(){return this.episode?this.episode.id:null},media:function(){return this.libraryItem.media||{}},mediaMetadata:function(){return this.media.metadata||{}},tracks:function(){return this.episode?[]:this.media.tracks||[]},itemTitle:function(){return this.episode?this.episode.title:this.mediaMetadata.title||""},bookAuthors:function(){return this.episode?[]:this.mediaMetadata.authors||[]},itemDuration:function(){return this.episode?this.$elapsedPretty(this.episode.duration):this.$elapsedPretty(this.media.duration)},isMissing:function(){return this.libraryItem.isMissing},isInvalid:function(){return this.libraryItem.isInvalid},isStreaming:function(){return this.$store.getters.getIsMediaStreaming(this.libraryItem.id,this.episodeId)},showPlayBtn:function(){return!this.isMissing&&!this.isInvalid&&!this.isStreaming&&(this.tracks.length||this.episode)},itemProgress:function(){return this.$store.getters["user/getUserMediaProgress"](this.libraryItem.id,this.episodeId)},userIsFinished:function(){return!!this.itemProgress&&!!this.itemProgress.isFinished},coverSize:function(){return this.$store.state.globals.isMobile?30:50},coverWidth:function(){return 1===this.bookCoverAspectRatio?1.6*this.coverSize:this.coverSize},userCanUpdate:function(){return this.$store.getters["user/getUserCanUpdate"]},userCanDelete:function(){return this.$store.getters["user/getUserCanDelete"]}},methods:{mouseover:function(){this.isDragging||(this.isHovering=!0)},mouseleave:function(){this.isHovering=!1},playClick:function(){var t=null;t=this.episode?{libraryItemId:this.libraryItem.id,libraryId:this.libraryItem.libraryId,episodeId:this.episodeId,title:this.itemTitle,subtitle:this.mediaMetadata.title,caption:"",duration:this.media.duration||null,coverPath:this.media.coverPath||null}:{libraryItemId:this.libraryItem.id,libraryId:this.libraryItem.libraryId,episodeId:null,title:this.itemTitle,subtitle:this.bookAuthors.map((function(t){return t.name})).join(", "),caption:"",duration:this.media.duration||null,coverPath:this.media.coverPath||null},this.$eventBus.$emit("play-item",{libraryItemId:this.libraryItem.id,episodeId:this.episodeId,queueItems:[t]})},clickEdit:function(){this.$emit("edit",this.item)},toggleFinished:function(){var t=this,e={isFinished:!this.userIsFinished};this.isProcessingReadUpdate=!0;var r="/api/me/progress/".concat(this.libraryItem.id);this.episodeId&&(r+="/".concat(this.episodeId)),this.$axios.$patch(r,e).then((function(){t.isProcessingReadUpdate=!1})).catch((function(r){console.error("Failed",r),t.isProcessingReadUpdate=!1,t.$toast.error(e.isFinished?t.$strings.ToastItemMarkedAsFinishedFailed:t.$strings.ToastItemMarkedAsNotFinishedFailed)}))},removeClick:function(){var t=this;this.processingRemove=!0;var e="/api/playlists/".concat(this.playlistId,"/item/").concat(this.libraryItem.id);this.episodeId&&(e+="/".concat(this.episodeId)),this.$axios.$delete(e).then((function(e){e.items.length?console.log("Item removed from playlist",e):(console.log("All items removed so playlist was removed",e),t.$toast.success(t.$strings.ToastPlaylistRemoveSuccess))})).catch((function(e){console.error("Failed to remove item from playlist",e),t.$toast.error(t.$strings.ToastFailedToUpdate)})).finally((function(){t.processingRemove=!1}))}},mounted:function(){}},n=r(4),component=Object(n.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full px-1 md:px-2 py-2 overflow-hidden relative",class:t.isHovering?"bg-white/5":"",on:{mouseover:t.mouseover,mouseleave:t.mouseleave}},[t.item?e("div",{staticClass:"flex h-16 md:h-20"},[t._m(0),t._v(" "),e("div",{staticClass:"h-full relative flex items-center",style:{width:t.coverWidth+"px",minWidth:t.coverWidth+"px",maxWidth:t.coverWidth+"px"}},[e("covers-book-cover",{attrs:{"library-item":t.libraryItem,width:t.coverWidth,"book-cover-aspect-ratio":t.bookCoverAspectRatio}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isHovering&&t.showPlayBtn,expression:"isHovering && showPlayBtn"}],staticClass:"absolute top-0 left-0 bg-black/50 flex items-center justify-center h-full w-full z-10"},[e("div",{staticClass:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/40 cursor-pointer",on:{click:t.playClick}},[e("span",{staticClass:"material-symbols fill text-2xl"},[t._v("play_arrow")])])])],1),t._v(" "),e("div",{staticClass:"grow overflow-hidden max-w-48 md:max-w-md h-full flex items-center px-2 md:px-3"},[e("div",[e("div",{staticClass:"truncate max-w-48 md:max-w-md"},[e("nuxt-link",{staticClass:"truncate hover:underline text-sm md:text-base",attrs:{to:"/item/".concat(t.libraryItem.id)}},[t._v(t._s(t.itemTitle))])],1),t._v(" "),e("div",{staticClass:"truncate max-w-48 md:max-w-md text-xs md:text-sm text-gray-300"},[t._l(t.bookAuthors,(function(r,o){return[e("nuxt-link",{key:r.id,staticClass:"truncate hover:underline",attrs:{to:"/author/".concat(r.id)}},[t._v(t._s(r.name))]),o<t.bookAuthors.length-1?e("span",{key:r.id+"-comma"},[t._v(",Â ")]):t._e()]})),t._v(" "),t.episode?e("nuxt-link",{staticClass:"truncate hover:underline",attrs:{to:"/item/".concat(t.libraryItem.id)}},[t._v(t._s(t.mediaMetadata.title))]):t._e()],2),t._v(" "),e("p",{staticClass:"text-xs md:text-sm text-gray-400"},[t._v(t._s(t.itemDuration))])])])]):t._e(),t._v(" "),e("div",{staticClass:"w-40 absolute top-0 -right-24 h-full transform transition-transform",class:t.isHovering?t.translateDistance:"translate-x-0"},[e("div",{staticClass:"flex h-full items-center"},[e("ui-tooltip",{attrs:{text:t.userIsFinished?t.$strings.MessageMarkAsNotFinished:t.$strings.MessageMarkAsFinished,direction:"top"}},[e("ui-read-icon-btn",{staticClass:"mx-1 mt-0.5",attrs:{disabled:t.isProcessingReadUpdate,"is-read":t.userIsFinished,borderless:""},on:{click:t.toggleFinished}})],1),t._v(" "),t.userCanUpdate?e("div",{staticClass:"mx-1",class:t.isHovering?"":"ml-6"},[e("ui-icon-btn",{attrs:{icon:"edit",borderless:""},on:{click:t.clickEdit}})],1):t._e(),t._v(" "),e("div",{staticClass:"mx-1",class:t.isHovering?"":"ml-6"},[e("ui-icon-btn",{attrs:{icon:"close",borderless:""},on:{click:t.removeClick}})],1)],1)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"w-10 min-w-10 md:w-16 md:max-w-16 h-full"},[t("div",{staticClass:"flex h-full items-center justify-center"},[t("span",{staticClass:"material-symbols drag-handle text-lg md:text-xl"},[this._v("menu")])])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{CoversBookCover:r(107).default,UiReadIconBtn:r(353).default,UiTooltip:r(76).default,UiIconBtn:r(148).default})},775:function(t,e,r){"use strict";r(721)},776:function(t,e,r){var o=r(18)((function(i){return i[1]}));o.push([t.i,"\n.playlist-item-item {\n  transition: all 0.4s ease;\n}\n.playlist-item-enter-from,\n.playlist-item-leave-to {\n  opacity: 0;\n  transform: translateX(30px);\n}\n.playlist-item-leave-active {\n  position: absolute;\n}\n",""]),o.locals={},t.exports=o},870:function(t,e,r){"use strict";r.r(e);var o=r(16),n=(r(22),r(26),r(27),r(8),r(44),r(45),r(38),r(28),r(690));function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}var d={components:{draggable:r.n(n).a},props:{playlistId:String,items:{type:Array,default:function(){return[]}}},data:function(){return{drag:!1,dragOptions:{animation:200,group:"description",ghostClass:"ghost"},itemsCopy:[]}},watch:{items:{handler:function(t){this.init()}}},computed:{bookCoverAspectRatio:function(){return this.$store.getters["libraries/getBookCoverAspectRatio"]},totalDuration:function(){var t=0;return this.items.forEach((function(e){e.episode?t+=e.episode.duration:t+=e.libraryItem.media.duration})),t},totalDurationPretty:function(){return this.$elapsedPrettyExtended(this.totalDuration)}},methods:{editItem:function(t){if(t.episode){var e=this.items.map((function(t){return t.episodeId}));this.$store.commit("setEpisodeTableEpisodeIds",e),this.$store.commit("setSelectedLibraryItem",t.libraryItem),this.$store.commit("globals/setSelectedEpisode",t.episode),this.$store.commit("globals/setShowEditPodcastEpisodeModal",!0)}else{var r=this.items.map((function(i){return i.libraryItemId}));this.$store.commit("setBookshelfBookIds",r),this.$store.commit("showEditModal",t.libraryItem)}},draggableUpdate:function(){var t=this,e={items:this.itemsCopy.map((function(i){return{libraryItemId:i.libraryItemId,episodeId:i.episodeId}}))};this.$axios.$patch("/api/playlists/".concat(this.playlistId),e).then((function(t){console.log("Playlist updated",t)})).catch((function(e){console.error("Failed to update playlist",e),t.$toast.error(t.$strings.ToastFailedToUpdate)}))},init:function(){this.itemsCopy=this.items.map((function(i){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},i)}))}},mounted:function(){this.init()}},c=d,m=(r(775),r(4)),component=Object(m.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full bg-primary/40"},[e("div",{staticClass:"w-full h-14 flex items-center px-4 md:px-6 py-2 bg-primary"},[e("p",{staticClass:"pr-4"},[t._v(t._s(t.$strings.HeaderPlaylistItems))]),t._v(" "),e("div",{staticClass:"w-6 h-6 md:w-7 md:h-7 bg-white/10 rounded-full flex items-center justify-center"},[e("span",{staticClass:"text-xs md:text-sm font-mono leading-none"},[t._v(t._s(t.items.length))])]),t._v(" "),e("div",{staticClass:"grow"}),t._v(" "),t.totalDuration?e("p",{staticClass:"text-sm text-gray-200"},[t._v(t._s(t.totalDurationPretty))]):t._e()]),t._v(" "),e("draggable",t._b({staticClass:"list-group",attrs:{handle:".drag-handle",draggable:".item",tag:"div"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},update:t.draggableUpdate},model:{value:t.itemsCopy,callback:function(e){t.itemsCopy=e},expression:"itemsCopy"}},"draggable",t.dragOptions,!1),[e("transition-group",{attrs:{type:"transition",name:t.drag?null:"playlist-item"}},[t._l(t.itemsCopy,(function(r,o){return[e("tables-playlist-item-table-row",{key:o,staticClass:"item",class:t.drag?"":"playlist-item-item",attrs:{"is-dragging":t.drag,item:r,"playlist-id":t.playlistId,"book-cover-aspect-ratio":t.bookCoverAspectRatio},on:{edit:t.editItem}})]}))],2)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{TablesPlaylistItemTableRow:r(751).default})}}]);