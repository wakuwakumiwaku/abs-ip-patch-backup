(window.webpackJsonp=window.webpackJsonp||[]).push([[91,93,139,142],{1023:function(e,t,r){"use strict";r(827)},1024:function(e,t,r){var n=r(18)((function(i){return i[1]}));n.push([e.i,"\n.folders-container {\n  max-height: calc(80vh - 192px);\n}\n@media (max-device-width: 768px) {\n.folders-container {\n    max-height: calc(80vh - 292px);\n}\n}\n",""]),n.locals={},e.exports=n},1086:function(e,t,r){"use strict";r.r(t);r(15);var n=r(16);r(22),r(26),r(27),r(44),r(45),r(38),r(8),r(28);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var l={props:{isNew:Boolean,library:{type:Object,default:function(){return null}},processing:Boolean},data:function(){return{name:"",provider:"google",icon:"",folders:[],showDirectoryPicker:!1,newFolderPath:"",mediaType:null}},computed:{mediaTypes:function(){return[{value:"book",text:this.$strings.LabelBooks},{value:"podcast",text:this.$strings.LabelPodcasts}]},folderPaths:function(){return this.folders.map((function(e){return e.fullPath}))},providers:function(){return"podcast"===this.mediaType?this.$store.state.scanners.podcastProviders:this.$store.state.scanners.bookProviders}},methods:{checkBlurExpressionInput:function(){this.$refs.nameInput&&this.$refs.nameInput.blur(),this.$refs.folderInput&&this.$refs.folderInput.length&&this.$refs.folderInput.forEach((function(input){input.blur&&input.blur()})),this.$refs.newFolderInput&&this.$refs.newFolderInput.blur()},browseForFolder:function(){this.showDirectoryPicker=!0},getLibraryData:function(){return{name:this.name,provider:this.provider,folders:this.folders,icon:this.icon,mediaType:this.mediaType}},formUpdated:function(){this.$emit("update",this.getLibraryData())},existingFolderInputBlurred:function(e){e.fullPath||this.removeFolder(e)},newFolderInputBlurred:function(){this.newFolderPath&&(this.folders.push({fullPath:this.newFolderPath}),this.newFolderPath="",this.formUpdated())},iconChanged:function(){this.formUpdated()},nameBlurred:function(){this.name!==this.library.name&&this.formUpdated()},changedMediaType:function(){this.provider=this.providers[0].value,this.formUpdated()},selectFolder:function(e){this.folders.push({fullPath:e}),this.showDirectoryPicker=!1,this.formUpdated()},removeFolder:function(e){this.folders=this.folders.filter((function(t){return t.fullPath!==e.fullPath})),this.formUpdated()},backArrowPress:function(){this.showDirectoryPicker&&(this.showDirectoryPicker=!1)},init:function(){this.name=this.library?this.library.name:"",this.provider=this.library?this.library.provider:"google",this.folders=this.library?this.library.folders.map((function(p){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},p)})):[],this.icon=this.library?this.library.icon:"default",this.mediaType=this.library?this.library.mediaType:"book",this.showDirectoryPicker=!1}},mounted:function(){this.init(),this.$store.dispatch("scanners/fetchProviders")}},c=l,d=(r(1023),r(4)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-full h-full md:px-4 py-2 mb-4"},[e.showDirectoryPicker?t("modals-libraries-lazy-folder-chooser",{attrs:{paths:e.folderPaths},on:{back:function(t){e.showDirectoryPicker=!1},select:e.selectFolder}}):t("div",{staticClass:"w-full h-full md:py-4"},[t("div",{staticClass:"flex flex-wrap md:flex-nowrap -mx-1 mb-2"},[t("div",{staticClass:"w-2/5 md:w-72 px-1 py-1 md:py-0"},[t("ui-dropdown",{attrs:{items:e.mediaTypes,label:e.$strings.LabelMediaType,disabled:!e.isNew,small:""},on:{input:e.changedMediaType},model:{value:e.mediaType,callback:function(t){e.mediaType=t},expression:"mediaType"}})],1),e._v(" "),t("div",{staticClass:"w-full md:grow px-1 py-1 md:py-0"},[t("ui-text-input-with-label",{ref:"nameInput",attrs:{label:e.$strings.LabelLibraryName},on:{blur:e.nameBlurred},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),t("div",{staticClass:"w-1/5 md:w-18 px-1 py-1 md:py-0"},[t("ui-media-icon-picker",{attrs:{label:e.$strings.LabelIcon},on:{input:e.iconChanged},model:{value:e.icon,callback:function(t){e.icon=t},expression:"icon"}})],1),e._v(" "),t("div",{staticClass:"w-2/5 md:w-72 px-1 py-1 md:py-0"},[t("ui-dropdown",{attrs:{items:e.providers,label:e.$strings.LabelMetadataProvider,small:""},on:{input:e.formUpdated},model:{value:e.provider,callback:function(t){e.provider=t},expression:"provider"}})],1)]),e._v(" "),t("div",{staticClass:"folders-container overflow-y-auto w-full py-2 mb-2"},[t("p",{staticClass:"px-1 text-sm font-semibold"},[e._v(e._s(e.$strings.LabelFolders))]),e._v(" "),e._l(e.folders,(function(r,n){return t("div",{key:n,staticClass:"w-full flex items-center py-1 px-2"},[t("span",{staticClass:"material-symbols fill mr-2 text-yellow-200",staticStyle:{"font-size":"1.2rem"}},[e._v("folder")]),e._v(" "),t("ui-editable-text",{ref:"folderInput",refInFor:!0,staticClass:"w-full",attrs:{readonly:!!r.id,type:"text"},on:{blur:function(t){return e.existingFolderInputBlurred(r)}},model:{value:r.fullPath,callback:function(t){e.$set(r,"fullPath",t)},expression:"folder.fullPath"}}),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:e.folders.length>1,expression:"folders.length > 1"}],staticClass:"material-symbols text-2xl ml-2 cursor-pointer hover:text-error",on:{click:function(t){return e.removeFolder(r)}}},[e._v("close")])],1)})),e._v(" "),t("div",{staticClass:"flex py-1 px-2 items-center w-full"},[t("span",{staticClass:"material-symbols fill mr-2 text-yellow-200",staticStyle:{"font-size":"1.2rem"}},[e._v("folder")]),e._v(" "),t("ui-editable-text",{ref:"newFolderInput",staticClass:"w-full",attrs:{placeholder:e.$strings.PlaceholderNewFolderPath,type:"text"},on:{blur:e.newFolderInputBlurred},model:{value:e.newFolderPath,callback:function(t){e.newFolderPath=t},expression:"newFolderPath"}})],1),e._v(" "),t("ui-btn",{staticClass:"w-full mt-2",attrs:{color:"bg-primary"},on:{click:e.browseForFolder}},[e._v(e._s(e.$strings.ButtonBrowseForFolder))])],2)])],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiDropdown:r(236).default,UiTextInputWithLabel:r(121).default,UiMediaIconPicker:r(882).default,UiEditableText:r(881).default,UiBtn:r(42).default,ModalsLibrariesLazyFolderChooser:r(883).default})},725:function(e,t,r){var content=r(788);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(19).default)("63059417",content,!0,{sourceMap:!1})},726:function(e,t,r){var content=r(790);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(19).default)("f89cc9c4",content,!0,{sourceMap:!1})},787:function(e,t,r){"use strict";r(725)},788:function(e,t,r){var n=r(18)((function(i){return i[1]}));n.push([e.i,"\ninput[data-v-7d797f58] {\n  border-style: inherit !important;\n}\ninput[data-v-7d797f58]:read-only {\n  background-color: #444;\n}\n",""]),n.locals={},e.exports=n},789:function(e,t,r){"use strict";r(726)},790:function(e,t,r){var n=r(18)((function(i){return i[1]}));n.push([e.i,"\n.dir-item.dir-selected {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n.dir-item.dir-used {\n  background-color: rgba(255, 25, 0, 0.1);\n}\n.folder-container {\n  max-height: calc(100% - 130px);\n  height: calc(100% - 130px);\n  min-height: calc(100% - 130px);\n}\n",""]),n.locals={},e.exports=n},827:function(e,t,r){var content=r(1024);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(19).default)("7a4bf4f0",content,!0,{sourceMap:!1})},881:function(e,t,r){"use strict";r.r(t);r(17),r(57),r(14);var n={props:{value:[String,Number],placeholder:String,readonly:Boolean,type:{type:String,default:"text"},disabled:Boolean},data:function(){return{}},computed:{inputValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{focused:function(){this.$emit("focus")},blurred:function(){this.$emit("blur")},change:function(e){this.$emit("change",e.target.value)},keyup:function(e){this.$emit("keyup",e)},blur:function(){this.$refs.input&&this.$refs.input.blur()}},mounted:function(){}},o=(r(787),r(4)),component=Object(o.a)(n,(function(){var e=this,t=e._self._c;return"checkbox"===e.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],ref:"input",staticClass:"py-2 px-1 bg-transparent border-b/0 border-gray-400 focus:border-opacity-100 focus:outline-hidden",attrs:{readonly:e.readonly,disabled:e.disabled,placeholder:e.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(e.inputValue)?e._i(e.inputValue,null)>-1:e.inputValue},on:{keyup:e.keyup,change:[function(t){var r=e.inputValue,n=t.target,o=!!n.checked;if(Array.isArray(r)){var l=e._i(r,null);n.checked?l<0&&(e.inputValue=r.concat([null])):l>-1&&(e.inputValue=r.slice(0,l).concat(r.slice(l+1)))}else e.inputValue=o},e.change],focus:e.focused,blur:e.blurred}}):"radio"===e.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],ref:"input",staticClass:"py-2 px-1 bg-transparent border-b/0 border-gray-400 focus:border-opacity-100 focus:outline-hidden",attrs:{readonly:e.readonly,disabled:e.disabled,placeholder:e.placeholder,type:"radio"},domProps:{checked:e._q(e.inputValue,null)},on:{keyup:e.keyup,change:[function(t){e.inputValue=null},e.change],focus:e.focused,blur:e.blurred}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],ref:"input",staticClass:"py-2 px-1 bg-transparent border-b/0 border-gray-400 focus:border-opacity-100 focus:outline-hidden",attrs:{readonly:e.readonly,disabled:e.disabled,placeholder:e.placeholder,type:e.type},domProps:{value:e.inputValue},on:{keyup:e.keyup,change:e.change,focus:e.focused,blur:e.blurred,input:function(t){t.target.composing||(e.inputValue=t.target.value)}}})}),[],!1,null,"7d797f58",null);t.default=component.exports},882:function(e,t,r){"use strict";r.r(t);r(33),r(8);var n={props:{value:String,disabled:Boolean,label:{type:String,default:"Icon"}},data:function(){return{clickOutsideObj:{handler:this.clickedOutside,events:["mousedown"],isActive:!0},showMenu:!1}},computed:{selected:{get:function(){return this.value||"database"},set:function(e){this.$emit("input",e)}},icons:function(){return this.$store.state.globals.libraryIcons},selectedItem:function(){var e=this;return this.icons.find((function(i){return i===e.selected}))||"audiobookshelf"}},methods:{clickShowMenu:function(){this.disabled||(this.showMenu=!this.showMenu)},clickedOutside:function(){this.showMenu=!1},select:function(e){this.disabled||(this.selected=e,this.showMenu=!1)}},mounted:function(){}},o=r(4),component=Object(o.a)(n,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.clickOutsideObj,expression:"clickOutsideObj"}],staticClass:"relative w-full h-9"},[t("p",{staticClass:"text-sm font-semibold"},[e._v(e._s(e.label))]),e._v(" "),t("button",{staticClass:"relative h-full w-full border border-gray-600 rounded-sm shadow-xs pl-3 pr-3 text-left focus:outline-hidden cursor-pointer bg-primary text-gray-100 hover:text-gray-200",attrs:{type:"button",disabled:e.disabled,"aria-haspopup":"listbox","aria-expanded":"true"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.clickShowMenu.apply(null,arguments)}}},[t("ui-library-icon",{attrs:{icon:e.selectedItem}})],1),e._v(" "),t("transition",{attrs:{name:"menu"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu,expression:"showMenu"}],staticClass:"absolute -left-[4.5rem] z-10 -mt-px bg-primary border border-black-200 shadow-lg max-h-56 w-48 rounded-md py-1 overflow-auto focus:outline-hidden sm:text-sm"},[t("div",{staticClass:"flex justify-center items-center flex-wrap"},[e._l(e.icons,(function(r){return[t("div",{key:r,staticClass:"p-2"},[t("span",{staticClass:"abs-icons text-xl text-white/80 hover:text-white/100 cursor-pointer",class:"icon-".concat(r),on:{click:function(t){return e.select(r)}}})])]}))],2)])])],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiLibraryIcon:r(358).default})},883:function(e,t,r){"use strict";r.r(t);var n=r(7),o=r(16);r(29),r(17),r(22),r(26),r(33),r(56),r(27),r(57),r(44),r(45),r(38),r(8),r(35),r(352),r(28),r(63),r(77);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={props:{paths:{type:Array,default:function(){return[]}}},data:function(){return{initialLoad:!1,loadingDirs:!1,isPosix:!0,rootDirs:[],directories:[],selectedPath:"",subdirs:[],level:0,currentDir:null,previousDir:null}},computed:{_directories:function(){var e=this;return this.directories.map((function(t){var r=!!e.paths.find((function(path){return path.endsWith(t.path)})),n=t.path===e.selectedPath,o=[];return n&&o.push("dir-selected"),r&&o.push("dir-used"),c({isUsed:r,isSelected:n,className:o.join(" ")},t)}))},_subdirs:function(){var e=this;return this.subdirs.map((function(t){var r=!!e.paths.find((function(path){return path.endsWith(t.path)})),n=[];return r&&n.push("dir-used"),c({isUsed:r,className:n.join(" ")},t)}))}},methods:{goBack:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.selectedPath.replace(/^\//,""),n=r.split("/"),o="",l="",n.length>2&&(l=n.slice(0,-2).join("/")),o=n.slice(0,-1).join("/"),e.isPosix?(o&&(o="/"+o),l&&(l="/"+l)):(!e.isPosix&&l.endsWith(":")&&(l+="/"),!e.isPosix&&o.endsWith(":")&&(o+="/")),e.level--,e.subdirs=e.directories,e.selectedPath=o,t.next=12,e.fetchDirs(l,e.level);case 12:e.directories=t.sent;case 13:case"end":return t.stop()}}),t)})))()},selectDir:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.isUsed){r.next=2;break}return r.abrupt("return");case 2:return t.selectedPath=e.path,t.level=e.level,r.next=6,t.fetchDirs(e.path,e.level+1);case 6:t.subdirs=r.sent;case 7:case"end":return r.stop()}}),r)})))()},selectSubDir:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.isUsed){r.next=2;break}return r.abrupt("return");case 2:return t.selectedPath=e.path,t.level=e.level,t.directories=t.subdirs,r.next=7,t.fetchDirs(e.path,e.level+1);case 7:t.subdirs=r.sent;case 8:case"end":return r.stop()}}),r)})))()},selectFolder:function(){var e=this;this.selectedPath?this.paths.find((function(p){return p.startsWith(e.selectedPath)}))?this.$toast.error("Oops, you cannot add a parent directory of a folder already added"):(this.$emit("select",this.selectedPath),this.selectedPath=""):console.error("No Selected path")},fetchDirs:function(path,e){var t=this;return this.loadingDirs=!0,this.$axios.$get("/api/filesystem?path=".concat(path,"&level=").concat(e)).then((function(data){return console.log("Fetched directories",data.directories),t.isPosix=!!data.posix,data.directories})).catch((function(e){return console.error("Failed to get filesystem paths",e),t.$toast.error(t.$strings.ToastFailedToLoadData),[]})).finally((function(){t.loadingDirs=!1}))},init:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.initialLoad=!0,t.next=3,e.fetchDirs("",0);case 3:e.rootDirs=t.sent,e.initialLoad=!1,e.directories=e.rootDirs,e.subdirs=[],e.selectedPath="";case 8:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.init()}},f=(r(789),r(4)),component=Object(f.a)(d,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-full h-full bg-bg absolute top-0 left-0 px-4 py-4 z-10"},[t("div",{staticClass:"flex items-center py-1 mb-2"},[t("span",{staticClass:"material-symbols text-3xl cursor-pointer hover:text-gray-300",on:{click:function(t){return e.$emit("back")}}},[e._v("arrow_back")]),e._v(" "),t("p",{staticClass:"px-4 text-xl"},[e._v(e._s(e.$strings.HeaderChooseAFolder))])]),e._v(" "),e.rootDirs.length?t("div",{staticClass:"w-full bg-primary/70 py-1 px-4 mb-2"},[t("p",{staticClass:"font-mono truncate"},[e._v(e._s(e.selectedPath||"/"))])]):e._e(),e._v(" "),e.rootDirs.length?t("div",{staticClass:"relative flex bg-primary/50 p-4 folder-container"},[t("div",{staticClass:"w-1/2 border-r border-bg h-full overflow-y-auto"},[e.level>0?t("div",{staticClass:"w-full p-1 cursor-pointer flex items-center hover:bg-white/10",on:{click:e.goBack}},[t("span",{staticClass:"material-symbols fill text-yellow-200",staticStyle:{"font-size":"1.2rem"}},[e._v("folder")]),e._v(" "),t("p",{staticClass:"text-base font-mono px-2"},[e._v("..")])]):e._e(),e._v(" "),e._l(e._directories,(function(r){return t("div",{key:r.path,staticClass:"dir-item w-full p-1 cursor-pointer flex items-center hover:text-white text-gray-200 hover:bg-white/10",class:r.className,on:{click:function(t){return e.selectDir(r)}}},[t("span",{staticClass:"material-symbols fill text-yellow-200",staticStyle:{"font-size":"1.2rem"}},[e._v("folder")]),e._v(" "),t("p",{staticClass:"text-base font-mono px-2 truncate"},[e._v(e._s(r.dirname))]),e._v(" "),r.path===e.selectedPath?t("span",{staticClass:"material-symbols",staticStyle:{"font-size":"1.1rem"}},[e._v("arrow_right")]):e._e()])}))],2),e._v(" "),t("div",{staticClass:"w-1/2 h-full overflow-y-auto"},e._l(e._subdirs,(function(r){return t("div",{key:r.path,staticClass:"dir-item w-full p-1 cursor-pointer flex items-center hover:text-white text-gray-200 hover:bg-white/10",class:r.className,on:{click:function(t){return e.selectSubDir(r)}}},[t("span",{staticClass:"material-symbols fill text-yellow-200",staticStyle:{"font-size":"1.2rem"}},[e._v("folder")]),e._v(" "),t("p",{staticClass:"text-base font-mono px-2 truncate"},[e._v(e._s(r.dirname))])])})),0),e._v(" "),e.loadingDirs?t("div",{staticClass:"absolute inset-0 w-full h-full flex items-center justify-center bg-black/10"},[t("ui-loading-indicator")],1):e._e()]):e.initialLoad?t("div",{staticClass:"py-12 text-center"},[t("p",[e._v(e._s(e.$strings.MessageLoadingFolders))])]):t("div",{staticClass:"py-12 text-center max-w-sm mx-auto"},[t("p",{staticClass:"text-lg mb-2"},[e._v(e._s(e.$strings.MessageNoFoldersAvailable))]),e._v(" "),t("p",{staticClass:"text-gray-300 mb-2"},[e._v(e._s(e.$strings.NoteFolderPicker))])]),e._v(" "),t("div",{staticClass:"w-full py-2"},[t("ui-btn",{staticClass:"w-full mt-2",attrs:{disabled:!e.selectedPath,color:"bg-primary"},on:{click:e.selectFolder}},[e._v(e._s(e.$strings.ButtonSelectFolderPath))])],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{UiLoadingIndicator:r(348).default,UiBtn:r(42).default})}}]);