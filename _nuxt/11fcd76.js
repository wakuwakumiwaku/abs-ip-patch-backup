(window.webpackJsonp=window.webpackJsonp||[]).push([[191,57],{1073:function(t,r,e){"use strict";e.r(r);e(17),e(15);var n=e(7),o=(e(147),e(29),{asyncData:function(t){return Object(n.a)(regeneratorRuntime.mark((function r(){var e,n,o,c,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=t.store,n=t.params,o=t.redirect,t.query,t.app,c=n.library,r.next=4,e.dispatch("libraries/fetch",c);case 4:if(l=r.sent){r.next=7;break}return r.abrupt("return",o("/oops?message=Library not found"));case 7:if("podcast"!==l.library.mediaType){r.next=10;break}return r.abrupt("return",o("/library/".concat(c)));case 10:return r.abrupt("return",{libraryId:c});case 11:case"end":return r.stop()}}),r)})))()},data:function(){return{loading:!0,narrators:[],selectedNarrator:null,newNarratorName:null}},computed:{streamLibraryItem:function(){return this.$store.state.streamLibraryItem},currentLibraryId:function(){return this.$store.state.libraries.currentLibraryId},userCanUpdate:function(){return this.$store.getters["user/getUserCanUpdate"]}},methods:{removeClick:function(t){var r=this,e={message:this.$getString("MessageConfirmRemoveNarrator",[t.name]),callback:function(e){e&&r.removeNarrator(t.id)},type:"yesNo"};this.$store.commit("globals/setConfirmPrompt",e)},editClick:function(t){this.selectedNarrator=t,this.newNarratorName=t.name},cancelEditClick:function(){this.selectedNarrator=null,this.newNarratorName=null},saveClick:function(){var t,r=this;this.selectedNarrator&&(this.newNarratorName=(null===(t=this.newNarratorName)||void 0===t?void 0:t.trim())||"",this.newNarratorName&&this.newNarratorName!==this.selectedNarrator.name?(this.loading=!0,this.$axios.$patch("/api/libraries/".concat(this.currentLibraryId,"/narrators/").concat(this.selectedNarrator.id),{name:this.newNarratorName}).then((function(data){data.updated?r.$toast.success(r.$getString("MessageItemsUpdated",[data.updated])):r.$toast.info(r.$strings.MessageNoUpdatesWereNecessary),r.cancelEditClick(),r.init()})).catch((function(t){console.error("Failed to updated narrator",t),r.$toast.error(r.$strings.ToastFailedToUpdate),r.loading=!1}))):this.cancelEditClick())},removeNarrator:function(t){var r=this;this.loading=!0,this.$axios.$delete("/api/libraries/".concat(this.currentLibraryId,"/narrators/").concat(t)).then((function(data){data.updated?r.$toast.success(r.$getString("MessageItemsUpdated",[data.updated])):r.$toast.info(r.$strings.MessageNoUpdatesWereNecessary),r.init()})).catch((function(t){console.error("Failed to remove narrator",t),r.$toast.error(r.$strings.ToastRemoveFailed),r.loading=!1}))},init:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$axios.$get("/api/libraries/".concat(t.currentLibraryId,"/narrators")).then((function(t){return t.narrators})).catch((function(t){return console.error("Failed to load narrators",t),[]}));case 2:t.narrators=r.sent,t.loading=!1;case 4:case"end":return r.stop()}}),r)})))()}},mounted:function(){this.init()},beforeDestroy:function(){}}),c=e(4),component=Object(c.a)(o,(function(){var t=this,r=t._self._c;return r("div",{staticClass:"page relative",class:t.streamLibraryItem?"streaming":""},[r("app-book-shelf-toolbar",{attrs:{page:"narrators","is-home":""}}),t._v(" "),r("div",{staticClass:"w-full h-full px-1 py-4 md:p-8 relative overflow-y-auto",attrs:{id:"bookshelf"}},[r("table",{staticClass:"tracksTable max-w-2xl mx-auto"},[r("tr",[r("th",{staticClass:"text-left"},[t._v(t._s(t.$strings.LabelName))]),t._v(" "),r("th",{staticClass:"text-center w-24"},[t._v(t._s(t.$strings.LabelBooks))]),t._v(" "),t.userCanUpdate?r("th",{staticClass:"w-40"}):t._e()]),t._v(" "),t._l(t.narrators,(function(e){var n,o;return r("tr",{key:e.id},[r("td",[(null===(n=t.selectedNarrator)||void 0===n?void 0:n.id)!==e.id?r("nuxt-link",{staticClass:"text-sm md:text-base text-gray-100 hover:underline",attrs:{to:"/library/".concat(t.currentLibraryId,"/bookshelf?filter=narrators.").concat(e.id)}},[t._v(t._s(e.name))]):r("form",{on:{submit:function(r){return r.preventDefault(),t.saveClick.apply(null,arguments)}}},[r("ui-text-input",{model:{value:t.newNarratorName,callback:function(r){t.newNarratorName=r},expression:"newNarratorName"}})],1)],1),t._v(" "),r("td",{staticClass:"text-center w-24"},[r("nuxt-link",{staticClass:"hover:underline",attrs:{to:"/library/".concat(t.currentLibraryId,"/bookshelf?filter=narrators.").concat(e.id)}},[t._v(t._s(e.numBooks))])],1),t._v(" "),t.userCanUpdate?r("td",{staticClass:"w-40"},[r("div",{staticClass:"flex justify-end items-center h-10"},[(null===(o=t.selectedNarrator)||void 0===o?void 0:o.id)!==e.id?[r("ui-icon-btn",{staticClass:"mx-1",attrs:{icon:"edit",borderless:"",size:8,"icon-font-size":"1.1rem"},on:{click:function(r){return t.editClick(e)}}}),t._v(" "),r("ui-icon-btn",{attrs:{icon:"delete",borderless:"",size:8,"icon-font-size":"1.1rem"},on:{click:function(r){return t.removeClick(e)}}})]:[r("ui-btn",{staticClass:"mr-2",attrs:{color:"bg-success",small:""},on:{click:function(r){return r.stopPropagation(),t.saveClick.apply(null,arguments)}}},[t._v(t._s(t.$strings.ButtonSave))]),t._v(" "),r("ui-btn",{attrs:{small:""},on:{click:function(r){return r.stopPropagation(),t.cancelEditClick.apply(null,arguments)}}},[t._v(t._s(t.$strings.ButtonCancel))])]],2)]):t._e()])}))],2)]),t._v(" "),t.loading?r("div",{staticClass:"absolute top-0 left-0 w-full h-[calc(100%-40px)] mt-10 flex items-center justify-center bg-black/25"},[r("ui-loading-indicator")],1):t._e()],1)}),[],!1,null,null,null);r.default=component.exports;installComponents(component,{AppBookShelfToolbar:e(689).default,UiTextInput:e(68).default,UiIconBtn:e(148).default,UiBtn:e(42).default,UiLoadingIndicator:e(348).default})},642:function(t,r,e){"use strict";e.d(r,"a",(function(){return l}));var n=e(183);var o=e(237),c=e(149);function l(t){return function(t){if(Array.isArray(t))return Object(n.a)(t)}(t)||Object(o.a)(t)||Object(c.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);